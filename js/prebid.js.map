{"version":3,"sources":["webpack:///webpack/bootstrap 8a242c693c0fb2a53bb4","webpack:///./src/prebid.js","webpack:///./src/prebidGlobal.js","webpack:///./src/utils.js","webpack:///./src/constants.json","webpack:///./src/video.js","webpack:///./src/adaptermanager.js","webpack:///./src/sizeMapping.js","webpack:///./src/adapters/baseAdapter.js","webpack:///./src/events.js","webpack:///./src/adapters/aardvark.js","webpack:///./src/bidfactory.js","webpack:///./src/bidmanager.js","webpack:///./src/cpmBucketManager.js","webpack:///./src/adloader.js","webpack:///./src/adapters/adapter.js","webpack:///./src/adapters/adblade.js","webpack:///./src/adapters/adbund.js","webpack:///./src/adapters/adbutler.js","webpack:///./src/adapters/adequant.js","webpack:///./src/adapters/adform.js","webpack:///./src/adapters/adkernel.js","webpack:///./src/ajax.js","webpack:///./src/url.js","webpack:///./src/adapters/admedia.js","webpack:///./src/adapters/bidfluence.js","webpack:///./src/adapters/vertamedia.js","webpack:///./src/adapters/aol.js","webpack:///./src/adapters/appnexus.js","webpack:///./src/adapters/appnexusAst.js","webpack:///./src/Renderer.js","webpack:///./src/adapters/beachfront.js","webpack:///./src/adapters/audienceNetwork.js","webpack:///./src/adapters/conversant.js","webpack:///./src/adapters/districtmDMX.js","webpack:///./src/adapters/fidelity.js","webpack:///./src/adapters/gumgum.js","webpack:///./src/adapters/hiromedia.js","webpack:///./src/adapters/indexExchange.js","webpack:///./src/adapters/innity.js","webpack:///./src/adapters/kruxlink.js","webpack:///./src/adapters/getintent.js","webpack:///./src/adapters/inneractive.js","webpack:///./src/adapters/komoona.js","webpack:///./src/adapters/lifestreet.js","webpack:///./src/adapters/mantis.js","webpack:///./src/adapters/openx.js","webpack:///./src/adapters/piximedia.js","webpack:///./src/adapters/pubmatic.js","webpack:///./src/adapters/pubgears.js","webpack:///./src/adapters/pulsepoint.js","webpack:///./src/adapters/pulsepointLite.js","webpack:///./src/adapters/quantcast.js","webpack:///./src/adapters/rhythmone.js","webpack:///./src/adapters/rubicon.js","webpack:///./src/adapters/smartyads.js","webpack:///./src/adapters/huddledmasses.js","webpack:///./src/adapters/smartadserver.js","webpack:///./src/adapters/sekindoUM.js","webpack:///./src/adapters/serverbid.js","webpack:///./src/adapters/sonobi.js","webpack:///./src/adapters/sovrn.js","webpack:///./src/adapters/springserve.js","webpack:///./src/adapters/thoughtleadr.js","webpack:///./src/adapters/stickyadstv.js","webpack:///./src/adapters/triplelift.js","webpack:///./src/adapters/twenga.js","webpack:///./src/adapters/yieldbot.js","webpack:///./src/adapters/nginad.js","webpack:///./src/adapters/brightcom.js","webpack:///./src/adapters/wideorbit.js","webpack:///./src/adapters/jcm.js","webpack:///./src/adapters/underdogmedia.js","webpack:///./src/adapters/memeglobal.js","webpack:///./src/adapters/criteo.js","webpack:///./src/adapters/centro.js","webpack:///./src/adapters/xhb.js","webpack:///./src/adapters/sharethrough.js","webpack:///./src/adapters/roxot.js","webpack:///./src/adapters/vertoz.js","webpack:///./src/adapters/widespace.js","webpack:///./src/adapters/admixer.js","webpack:///./src/adapters/atomx.js","webpack:///./src/adapters/tapsense.js","webpack:///./src/adapters/trion.js","webpack:///./src/adapters/prebidServer.js","webpack:///./src/cookie.js","webpack:///./src/adapters/adsupply.js","webpack:///./src/polyfill.js","webpack:///./~/core-js/fn/array/find.js","webpack:///./~/core-js/modules/es6.array.find.js","webpack:///./~/core-js/modules/_export.js","webpack:///./~/core-js/modules/_global.js","webpack:///./~/core-js/modules/_core.js","webpack:///./~/core-js/modules/_hide.js","webpack:///./~/core-js/modules/_object-dp.js","webpack:///./~/core-js/modules/_an-object.js","webpack:///./~/core-js/modules/_is-object.js","webpack:///./~/core-js/modules/_ie8-dom-define.js","webpack:///./~/core-js/modules/_descriptors.js","webpack:///./~/core-js/modules/_fails.js","webpack:///./~/core-js/modules/_dom-create.js","webpack:///./~/core-js/modules/_to-primitive.js","webpack:///./~/core-js/modules/_property-desc.js","webpack:///./~/core-js/modules/_redefine.js","webpack:///./~/core-js/modules/_has.js","webpack:///./~/core-js/modules/_uid.js","webpack:///./~/core-js/modules/_ctx.js","webpack:///./~/core-js/modules/_a-function.js","webpack:///./~/core-js/modules/_array-methods.js","webpack:///./~/core-js/modules/_iobject.js","webpack:///./~/core-js/modules/_cof.js","webpack:///./~/core-js/modules/_to-object.js","webpack:///./~/core-js/modules/_defined.js","webpack:///./~/core-js/modules/_to-length.js","webpack:///./~/core-js/modules/_to-integer.js","webpack:///./~/core-js/modules/_array-species-create.js","webpack:///./~/core-js/modules/_array-species-constructor.js","webpack:///./~/core-js/modules/_is-array.js","webpack:///./~/core-js/modules/_wks.js","webpack:///./~/core-js/modules/_shared.js","webpack:///./~/core-js/modules/_add-to-unscopables.js","webpack:///./~/core-js/fn/array/includes.js","webpack:///./~/core-js/modules/es7.array.includes.js","webpack:///./~/core-js/modules/_array-includes.js","webpack:///./~/core-js/modules/_to-iobject.js","webpack:///./~/core-js/modules/_to-index.js","webpack:///./~/core-js/fn/object/assign.js","webpack:///./~/core-js/modules/es6.object.assign.js","webpack:///./~/core-js/modules/_object-assign.js","webpack:///./~/core-js/modules/_object-keys.js","webpack:///./~/core-js/modules/_object-keys-internal.js","webpack:///./~/core-js/modules/_shared-key.js","webpack:///./~/core-js/modules/_enum-bug-keys.js","webpack:///./~/core-js/modules/_object-gops.js","webpack:///./~/core-js/modules/_object-pie.js","webpack:///./src/secure-creatives.js","webpack:///./src/adserver.js","webpack:///./src/targeting.js"],"names":["pbjs","CONSTANTS","require","utils","bidmanager","adaptermanager","bidfactory","events","adserver","targeting","objectType_function","objectType_undefined","objectType_object","BID_WON","EVENTS","SET_TARGETING","auctionRunning","bidRequestQueue","eventValidators","bidWon","checkDefinedPlacement","_bidsRequested","_bidsReceived","_adUnitCodes","_winningBids","_adsReceived","_sendAllBids","bidderSettings","bidderTimeout","cbTimeout","timeoutBuffer","logging","publisherDomain","window","location","origin","libLoaded","version","logInfo","adUnits","cookieSyncDelay","que","push","cmd","call","e","logError","message","processQue","i","length","called","id","placementCodes","map","bidSet","bids","bid","placementCode","reduce","filter","contains","clearPlacements","includes","adUnitCode","setRenderSize","doc","width","height","defaultView","frameElement","getAdserverTargetingForAdUnitCodeStr","adunitCode","arguments","res","getAdserverTargetingForAdUnitCode","transformAdServerTargetingObj","logMessage","getAdserverTargeting","getAllTargeting","Object","keys","target","join","p","c","accumulator","key","getBidResponses","responses","bind","currentRequestId","requestId","a","b","getBidResponsesForAdUnitCode","setTargetingForGPTAsync","resetPresetTargeting","setTargeting","emit","setTargetingForAst","isApntagDefined","allBidsAvailable","bidsBackAll","renderAd","find","adId","ad","replaceAuctionPrice","cpm","url","mediaType","adUrl","renderer","render","document","inIframe","write","close","removeAdUnit","code","splice","clearAuction","shift","requestBids","bidsBackHandler","timeout","adUnitCodes","unit","invalidVideoAdUnits","forEach","adUnit","externalCallbackReset","addOneTimeCallback","executeCallback","timedOut","timeoutCallback","timer","setTimeout","callBids","addAdUnits","adUnitArr","isArray","transactionId","generateUUID","apply","onEvent","event","handler","isFn","on","offEvent","off","addCallback","eventStr","func","getUniqueIdentifierStr","removeCallback","registerBidAdapter","bidderAdaptor","bidderCode","registerAnalyticsAdapter","options","bidsAvailableForAdapter","bidderRequest","createBid","statusCode","addBidResponse","loadScript","tagSrc","callback","useCache","enableAnalytics","config","isEmpty","aliasBidder","alias","aliasBidAdapter","setPriceGranularity","granularity","setCustomPriceBucket","GRANULARITY_OPTIONS","CUSTOM","enableSendAllBids","getAllWinningBids","buildMasterVideoTagFromAdserverTag","adserverTag","urlComponents","masterTag","toLowerCase","dfpAdserverObj","dfpAdserver","verifyAdserverTag","appendQueryParams","setBidderSequence","order","ORDER","RANDOM","getHighestCpmBids","getWinningBids","setS2SConfig","enabled","endpoint","S2S","DEFAULT_ENDPOINT","maxBids","adapter","getGlobal","uniques","flatten","getBidRequest","getKeys","getValue","getBidderCodes","isGptPubadsDefined","getHighestCpm","shuffle","adUnitsFilter","isSrcdocSupported","cloneJson","isSafariBrowser","getBidderRequest","objectType_string","objectType_number","_loggingChecked","t_Arr","t_Str","t_Fn","t_Numb","toString","prototype","infoLogger","console","info","exports","replaceTokenInString","str","token","_each","value","undefined","keyString","toUpperCase","re","RegExp","replace","getIncrementalInteger","count","_getUniqueIdentifierStr","Math","random","substr","placeholder","getBidIdParameter","paramsObj","tryAppendQueryString","existingUrl","encodeURIComponent","parseQueryStringParameters","queryObj","result","k","hasOwnProperty","getOwnPropertyNames","parseSizesInput","sizeObj","parsedSizes","sizes","split","sizeRegex","curSizePos","hasOwn","match","sizeArrayLength","parseGPTSingleSizeArray","singleSize","isNaN","getTopWindowLocation","top","getTopWindowUrl","href","logWarn","msg","debugTurnedOn","warn","args","hasConsoleLogger","log","errLogFn","hasLogger","error","getParameterByName","DEBUG_MODE","exception","errCode","createInvisibleIframe","_createInvisibleIframe","f","createElement","border","hspace","vspace","marginWidth","marginHeight","style","scrolling","frameBorder","src","display","name","regexS","regex","results","exec","search","decodeURIComponent","hasValidBidRequest","paramObj","requiredParamsArr","found","findParam","addEventHandler","element","addEventListener","attachEvent","isA","object","_t","isStr","isNumber","isEmptyStr","fn","l","obj","indexOf","Array","_map","output","objectToCheck","propertyToCheckFor","constructor","insertElement","elm","elToAppend","getElementsByTagName","insertBefore","firstChild","insertPixel","img","Image","onload","parentNode","removeChild","insertCookieSyncIframe","encodeUri","iframeHtml","createTrackPixelIframeHtml","div","innerHTML","iframe","createTrackPixelHtml","escapedUrl","encodeURI","getIframeDocument","contentWindow","contentDocument","getValueString","param","val","defaultValue","index","arry","concat","bidId","bidder","googletag","pubads","getSlots","previous","current","timeToRespond","array","counter","floor","temp","test","navigator","userAgent","JSON","parse","stringify","self","request","start","videoAdUnit","nonVideoBidder","hasNonVideoBidder","_bidderRegistry","bidderRegistry","_s2sConfig","_analyticsRegistry","_bidderSequence","getBids","bidderRequestId","sizeMapping","bid_id","auctionStart","Date","now","auctionInit","timestamp","AUCTION_INIT","bidderCodes","adaptersServerSide","bidders","adUnitsCopy","transformHeightWidth","tid","getTime","s2sBidRequest","s2sAdapter","setConfig","BID_REQUESTED","sizesObj","heightWidth","size","parseInt","bidAdaptor","existingAlias","newAdapter","createNew","setBidderCode","adapterConfig","provider","AardvarkAdapter","AdbladeAdapter","AdbundAdapter","AdbutlerAdapter","AdequantAdapter","AdformAdapter","AdkernelAdapter","AdmediaAdapter","BidfluenceAdapter","VertamediaAdapter","AolAdapter","AppnexusAdapter","AppnexusAstAdapter","BeachfrontAdapter","AudienceNetworkAdapter","ConversantAdapter","DistrictmDMXAdapter","FidelityAdapter","GumgumAdapter","HiromediaAdapter","IndexExchangeAdapter","InnityAdapter","KruxlinkAdapter","GetintentAdapter","InneractiveAdapter","KomoonaAdapter","LifestreetAdapter","MantisAdapter","OpenxAdapter","PiximediaAdapter","PubmaticAdapter","PubgearsAdapter","PulsepointAdapter","PulsepointLiteAdapter","QuantcastAdapter","RhythmoneAdapter","RubiconAdapter","SmartyadsAdapter","HuddledmassesAdapter","SmartadserverAdapter","SekindoUMAdapter","ServerbidAdapter","SonobiAdapter","SovrnAdapter","SpringserveAdapter","ThoughtleadrAdapter","StickyadstvAdapter","TripleliftAdapter","TwengaAdapter","YieldbotAdapter","NginadAdapter","BrightcomAdapter","WideorbitAdapter","JcmAdapter","UnderdogmediaAdapter","MemeglobalAdapter","CriteoAdapter","CentroAdapter","XhbAdapter","SharethroughAdapter","RoxotAdapter","VertozAdapter","WidespaceAdapter","AdmixerAdapter","AtomxAdapter","TapsenseAdapter","TrionAdapter","PrebidServerAdapter","AdsupplyAdapter","videoAdapters","_win","mapSizes","isSizeMappingValid","getScreenWidth","mapping","prev","curr","minWidth","win","w","d","innerWidth","body","clientWidth","documentElement","setWindow","BaseAdapter","slice","allEvents","v","idPaths","EVENT_ID_PATHS","eventsFired","module","_handlers","_public","_dispatch","eventString","eventPayload","idPath","eventKeys","callbacks","eventType","_checkAvailableEvent","_handler","get","getEvents","arrayCopy","newProp","adloader","constants","AARDVARK_CALLBACK_NAME","AARDVARK_REQUESTS_MAP","AARDVARK_BIDDER_CODE","DEFAULT_REFERRER","callbackName","bidReqs","ref","ai","scs","bidIds","host","_ai","_sc","_endpoint","params","registerBidResponse","rawBidResponse","cid","bidObj","sc","bidResponse","STATUS","GOOD","adm","nurl","responded","registerAardvarkCallback","rtkResponseObj","bidRequestId","bidRequest","NO_BID","baseAdapter","getBidderCode","Bid","_bidId","_statusCode","statusMessage","_getStatus","getStatusCode","getSize","AUCTION_END","externalCallbacks","byAdUnit","all","oneTime","_granularity","MEDIUM","_customPriceBucket","defaultBidderSettingsMap","customConfig","getTimedOutBidders","getBidders","bidsBackAdUnit","requested","add","received","responseTimestamp","requestTimestamp","parseFloat","BID_ADJUSTMENT","BID_RESPONSE","priceStringsObj","pbLg","low","pbMg","med","pbHg","high","pbAg","auto","pbDg","dense","pbCg","custom","keyValues","dealId","getKeyValueTargetingPairs","adserverTargeting","triggerAdUnitCallbacks","custBidObj","bidder_settings","standardSettings","getStandardBidderSettings","setKeys","JSON_MAPPING","ADSERVER_TARGETING","alwaysUseBid","sendStandardTargeting","kvPair","suppressEmptyKeys","granularityOptions","option","registerDefaultBidderSetting","defaultSetting","clearTimeout","processCallbacks","timedOutBidders","BID_TIMEOUT","singleAdUnitCode","callbackQueue","groupByPlacement","bidsByPlacement","cbEvent","CB","TYPE","ALL_BIDS_BACK","AD_UNIT_BIDS_BACK","adjustBids","bidPriceAdjusted","bidCpmAdjustment","BD_SETTING_STANDARD","AUTO","DENSE","LOW","HIGH","getStandardBidderAdServerTargeting","_defaultPrecision","_lgPriceConfig","_mgPriceConfig","_hgPriceConfig","_densePriceConfig","_autoPriceConfig","getPriceBucketString","cpmFloat","getCpmStringValue","cpmStr","isValidePriceConfig","cap","buckets","max","bucket","precision","toFixed","min","getCpmTarget","increment","isValid","bucketSize","_requestCache","cacheRequest","loaded","requestResource","jptScript","type","async","readyState","onreadystatechange","Adapter","BIDDER_CODE","BASE_URI","DEFAULT_BID_FLOOR","_callBids","referrer","loc","domain","hostname","partnerId","bidRequests","imp","bidFloor","protocol","adbladeResponse","response","auctionIdRe","auctionPriceRe","clickUrlRe","seatbid","bidsRequested","seatbidBid","impid","price","h","adBundAdapter","timezone","getTimezoneOffset","bidAPIs","bidAPI","_stringify","_createCallback","data","_requestBids","ua","adbundResponse","AdButlerAdapter","callbackData","zoneCount","pageID","zoneID","callbackID","adRequest","buildRequest","adbutlerCB","aBResponseObject","zone_id","place","isCorrectSize","isCorrectCPM","CPM","minCPM","maxCPM","status","ad_code","addTrackingPixels","tracking_pixels","adIndex","accountID","keyword","requestURI","trackingPixels","trackingPixelMarkup","pixelURL","trackingPixel","req_url_base","req_url","publisher_id","cats","replies","placements","bid_request","br_params","bidfloor","br_sizes","j","process_bids","placement_code","adequant_creatives","bid_response","STATUSCODES","_value","_key","globalParams","formRequestUrl","unshift","handleCallback","reqData","encode64","handleResponse","adItems","bidObject","adItem","verifySize","win_bid","cur","win_cur","banner","deal_id","validSizes","input","out","chr1","chr2","chr3","enc1","enc2","enc3","enc4","_keyStr","utf8_encode","charCodeAt","charAt","string","utftext","n","String","fromCharCode","AdKernelAdapter","AJAX_REQ_PARAMS","contentType","withCredentials","method","EMPTY_BID_RESPONSE","RtbRequestDispatcher","originalBids","site","createSite","syncedHostZones","addImp","zone","zoneId","secure","insertUserSync","appendChild","dispatch","zones","impressions","dispatchRtbRequest","buildEndpointUrl","rtbRequest","buildRtbRequest","buildRequestParams","bidResp","bidFound","imps","rtbReq","processBids","dispatcher","validateBidParams","createEmptyBidObject","adUnitId","createBidObject","resp","formatAdMarkup","ajax","XHR_DONE","x","useXDomainRequest","success","XMLHttpRequest","responseType","XDomainRequest","responseText","onerror","ontimeout","onprogress","statusText","urlInfo","open","customHeaders","header","setRequestHeader","preflight","send","parseQS","formatQS","format","query","acc","criteria","parsed","port","pathname","hash","bidderUrl","request_obj","aid","page_url","test_ad","parsedSizesLength","promo_sizes","siteDomain","sitePage","siteRef","topUrl","callbackId","admediaHandler","callback_id","scriptUrl","bfPbjsCB","bfr","cbID","bfbids","adunitId","publisherId","reservePrice","pbjsBfobj","cb","FORGE","init","ENDPOINT","RTBDataParams","prepareAndSaveRTBRequestParams","requestSizes","parsedSize","tag","creative_id","cmpId","descriptionUrl","vastUrl","showCpmAdjustmentWarning","pubapiTemplate","template","nexageBaseApiTemplate","nexageGetApiTemplate","MP_SERVER_MAP","us","eu","as","NEXAGE_SERVER","SYNC_TYPES","domReady","readyEventFired","idempotentFn","dropSyncCookies","pixels","pixelElements","parsePixelItems","renderPixelElements","itemsRegExp","tagNameRegExp","srcRegExp","pixelsItems","matchedItems","tagNameMatches","item","sourcesPathMatches","tagName","pixelsElements","renderPixelImage","renderPixelIframe","pixelsItem","image","strings","values","dict","Number","isInteger","_buildMarketplaceUrl","serverParam","server","regionParam","region","network","placement","pageid","pageId","sizeid","sizeId","misc","_buildNexageApiUrl","dcn","pos","nexageApi","ext","_addErrorBidResponse","reason","nbr","raw","_addBidResponse","bidData","encp","userSyncOn","creativeId","crid","pubapiId","currencyCode","dealid","_isNexageRequestPost","tagid","video","mimes","minduration","maxduration","apiUrl","isNexageRequestPost","aol","AppNexusAdapter","usersync","anArr","buildJPTCall","placementId","memberId","member","inventoryCode","altReferrer","jptCall","sizeQueryString","targetingParams","paramsCopy","invCode","alt_referrer","queryParams","lastIndexOf","substring","startTime","handleAnCB","jptResponseObj","bidCode","callback_uid","responseCPM","VIDEO_TARGETING","USER_PARAMS","userObj","tags","valid","getSizes","primary_size","uuid","allow_smaller_sizes","allowSmallerSizes","prebid","disable_psa","reserve","position","trafficSourceCode","traffic_source_code","privateSizes","private_sizes","supplyType","supply_type","pubClick","pubclick","extInvCode","ext_inv_code","externalImpId","external_imp_id","keywords","getKeywords","require_asset_url","user","payloadJson","member_id","payload","errorMessage","getRtbBid","ad_type","arrs","ads","rtb","outstreamRender","ANOutstreamVideo","tagId","adResponse","tag_id","targetId","rendererOptions","getConfig","handleOutstreamRendererEvents","onOutstreamRendererLoaded","eventName","handleVideoEvent","player_width","player_height","asset_url","renderer_url","install","renderer_id","adText","setRender","err","logWarning","setEventHandlers","impression","ended","querySelector","content","trackers","impression_urls","tracker","Renderer","handlers","BID_URL","appId","fetchDeviceType","global","bidRequestObject","isPrebid","page","device","devicetype","bidPrice","newBid","validateBidRequest","flattenBidRequestSizes","flattenSize","isValidSize","isTestmode","Boolean","parseJson","jsonAsString","isNative","createAdHtml","nativeStyle","nativeContainer","createSuccessBidResponse","cpmCents","hb_bidder","fb_bidid","fb_format","fb_placementid","createFailureBidResponse","placementids","adformats","testmode","sdk","errors","noBid","placement_id","bid_price_cents","AudienceNetwork","VERSION","conversantUrl","appendScript","script","className","createTextNode","text","getDNT","doNotTrack","msDoNotTrack","getDevice","language","screen","dnt","make","vendor","conversantBids","siteId","conversantImps","conversantBidReqs","adW","adH","bidSizes","displaymanager","displaymanagerver","addEmptyBidResponses","placementsWithBidsBack","allConversantBidRequests","conversantBid","parseSeatbid","responseAd","responseNurl","bidRequested","conversantResponse","conversantResponseObj","path","conversantDebugResponse","adLoader","DistrictmAdaptor","districtmAdaptor","districtmUrl","hb_dmx_res","sendBids","handlerRes","auction","fixSize","run","ssp","FIDELITY_BIDDER_NAME","FIDELITY_SERVER_NAME","currentBid","m3_u","zoneid","charset","characterSet","subid","click","getFlashVersion","plugins","plugin","description","addBlankBidResponses","allFidelityBidRequests","fidelityBid","fidelityResponse","responseObj","requestObj","CALLBACKS","bidEndpoint","topWindow","topScreen","pageViewId","requestCache","throttleTable","defaultThrottle","_getTimeStamp","browserParams","vw","vh","innerHeight","sw","sh","pu","ce","cookieEnabled","dpr","devicePixelRatio","trackingId","inScreen","nativeId","native","slotId","inSlot","tmax","inImage","pi","productId","requestKey","throttle","latestRequest","t","ni","si","pv","cachedBid","jsonp","_handleGumGumResponse","bidCall","cachedBidRequest","pag","thms","pvid","encodedResponse","gumgumAdLoader","handleGumGumCB","HiroMediaAdapter","ADAPTER_VERSION","REQUIRED_BID_PARAMS","DEFAULT_BID_PARAMS","bidUrl","_bidStorage","bidInfo","bidStatus","checkChance","sampling","batchKey","chance","hiromedia_callback","getBrowser","browsers","stringSearch","versionSearch","some","browser","nameSearch","defaultVersionSearch","versionMatch","getDomain","defaultParams","bidParams","getBatchKey","batchParams","accountId","selectedSize","additionalSizes","shouldBid","sendBidRequest","requestParams","adapterVersion","browserVersion","ADAPTER_NAME","ADAPTER_CODE","OPEN_MARKET","PRIVATE_MARKET","cygnus_index_parse_res","_IndexRequestData","impIDToSlotID","targetMode","callbackFn","reqOptions","lastRequestID","targetIDToBid","targetIDToResp","targetIDToCreative","allBids","seatbidLength","pricelevel","slotID","targetID","noTargetModeTargetID","targetPrefix","impBid","impressionID","dealID","priceLevel","cygnus_index_ready_state","index_render","pop","cygnus_index_args","siteID","px_call","headertag_render","index_slot","index_ary","unpack","cygnus_index_adunits","getIndexDebugMode","INDEX_DEBUG_MODE","queryParam","wdw","childsReferrer","mode","sandbox","topFrameLimit","parent","topURL","cygnus_index_start","parseFn","escapable","meta","escapeCharacter","character","escaped","quote","lastIndex","OpenRTBRequest","timeoutDelay","initialized","_parseFnName","topframe","requestCounter","requestID","serialize","json","impObj","bidfloorcur","setPageOverride","sitePageOverride","addImpression","bidFloorCurrency","jsonURI","scriptSrc","queryValue","prebidVersion","slots","req","slotDef","impID","slotIdMap","requiredParams","firstAdUnitCode","bidArr","targetAggregate","expectedBids","sizeID","validSize","usingSizeSpecificSiteID","slotName","mergeSlotInto","tier2SiteID","tier3SiteID","indexObj","lookupObj","adSlotId","cpmAndSlotId","tier","currentCPM","slotObj","getSlotObj","logErrorBidResponse","slot","slotList","arr","returnObj","bidURL","requestURL","pub","parseSized","arrSize","_doInnityCallback","libURL","_qs","_makeBidResponse","_makeCallback","impids","bidRequestParams","qs","KruxAdapter","GetIntentAdapter","headerBiddingStaticJS","gi_hb","addOptional","props","pid","known","is_video","r","br","makeBid","no_bid","nobid","vast_url","V","RECTANGLE_SIZE","W","H","SPOT_TYPES","INTERSTITIAL","RECTANGLE","FLOATING","BANNER","DISPLAY_AD","ENDPOINT_URL","EVENTS_ENDPOINT_URL","RESPONSE_HEADERS_NAME","PRICING_VALUE","AD_H","AD_W","iaRef","Helpers","defaultsQsParams","mw","hb","stringToCamel","first","$1","objectToCamel","keyCamelCase","Tracker","fire","urls","Reporter","errorEventName","pageProtocol","getPageProtocol","getEventUrl","evtName","extraDetails","eventsEndpoint","queryStringParams","eventQueryStringParams","queryStringParamsWithAID","reportEvent","createTrackingPixel","defaults","toQS","realAppId","urlWithoutProtocol","Url","defaultsParams","fs","serverParamNameBySettingParamName","portal","age","gender","unwantedValues","toServerParams","serverParams","paramName","isSecured","getUrlParams","toQueryString","spotType","rw","rh","bco","qa","Http","headers","getBidHeaders","xhr","headersData","headerName","getResponseHeader","InnerActiveAdapter","iaAdapter","bidByBidId","adSettings","_setBidCpm","storedBid","responseAsJson","html","_isValidBidResponse","passback","_getBidDetails","_getAd","tracking","auctionBid","adHtml","impressionsHtml","clicks","adTemplate","bidParamsWithCustomParams","customParams","_toIaBidParams","_isValidRequest","_storeBidRequestDetails","_getEndpointUrl","_onResponse","storedBids","placementid","hbid","creative","SLOTS_LOAD_MAP","PREBID_REQUEST_MESSAGE","PREBID_RESPONSE_MESSAGE","jstagUrl","jstag_url","adkey","adSize","ad_size","shouldRequest","adSizeArray","_callJSTag","_addSlotBidResponse","LSM_Slot","slotTagParams","_preload","_hb_request","_timeout","_onload","action","state","getSlotObjectName","_constructLSMAd","show","property","ev","source","postMessage","slotObject","destroy","hasResponse","jsTagUrl","mantis_link","isDesktop","ignoreTouch","scope","supportsTouch","msMaxTouchPoints","mantis_breakpoint","ex","isSendable","isObject","isAmp","context","isSecure","mantis_jsonp","jsonToQuery","chain","form","parts","queryKey","akey","aval","buildMantisUrl","tz","buster","mobile","mantis_uuid","localStorage","localUuid","getItem","title","canonicalUrl","mantis_domain","Prebid","BIDDER_CONFIG","pdNode","oxARJResponse","oxResponseObj","makePDCall","auid","adunitid","adUnitHasValidSizeFromBid","used","beaconParams","bd","bt","bs","pub_rev","bp","ts","buildBoPixel","getViewportDimensions","isIfr","tWin","tDoc","docEl","clientHeight","pixelsUrl","pdFrame","setAttribute","rootNode","replaceChild","ad_id","adid","buildQueryStringFromParams","recordPixel","boBase","sizeLength","creative_size","delDomain","aus","customParam","queryString","currentURL","ju","jr","ch","charSet","colorDepth","ifr","tws","ee","ef","be","bc","PREBID_URL","bidStash","tryAppendPixiQueryString","callBidsPiximedia","cbid","prebidUrl","handlePiximediaCallback","stash","timelapsed","foundbypm","currency","_pm_pub_id","_pm_optimize_adslots","adSlot","_getBids","iframeDoc","_createRequestContent","PM_PUB_ID","PM_OPTIMIZE_ADSLOTS","handlePubmaticCallback","bidDetailsMap","progKeyValueMap","adUnitInfo","bidResponseMap","bidInfoMap","dimensions","pair","bidstatus","bidid","unescape","creative_tag","tracking_url","wdeal","consts","SCRIPT","PARAMS","SIZES","SIZE","AD","WIDTH","HEIGHT","PUB_ZONE","GROSS_PRICE","RESOURCE","DETAIL","BIDDER_CODE_RESPONSE_KEY","SCRIPT_ID","ATTRIBUTE_PREFIX","SLOT_LIST_ATTRIBUTE","PUBLISHER_ATTRIBUTE","FLAG_ATTRIBUTE","PLACEMENT_CODE","BID_ID","PUBLISHER_PARAM","PUB_ZONE_PARAM","BID_RECEIVED_EVENT_NAME","SLOT_READY_EVENT_NAME","CREATIVE_TEMPLATE","TAG_URL","publisher","PubGearsAdapter","proxy","pendingSlots","PL_BIDS","getSlotFromBidParam","getScript","makeScript","registerEventListeners","anchor","scripts","getSlotFromResource","resource","getElementById","onBid","onComplete","slotKey","buildResponse","eventData","dims","getCreative","replacementValues","publisher_name","pub_zone","PulsePointAdapter","getJsStaticUrl","pp","requestBid","ppBidRequest","Ad","bidRequestOptions","bidResponseAvailable","bidResponseCallback","cn","ca","requestActions","BID","cu","cf","bidCpm","PulsePointLiteAdapter","ajaxOptions","environment","tl","cwu","cwr","dw","cxy","ln","browserLanguage","userLanguage","systemLanguage","rawResponse","QUANTCAST_CALLBACK_URL","returnEmptyBid","handleQuantcastCB","responseBid","battr","bidManager","loader","defaultZone","defaultPath","debug","requestCompleted","loadStart","configuredPlacements","fat","applyMacros","txt","load","flashInstalled","m","mimeTypes","ActiveXObject","enabledPlugin","attempt","valueFunction","logToConsole","getBidParameters","noBids","getRMPURL","trace","ancestorOrigins","heights","widths","floors","mediaTypes","th","tw","sendAuditBeacon","doc_version","doc_type","ao","q","u","ancestor_origins","popped","opener","framed","prebid_instance","prebid_version","response_ms","placement_codes","bidder_version","prebid_timeout","sort","slotMap","registerBid","pbResponse","RUBICON_BIDDER_CODE","getIntegration","FASTLANE_ENDPOINT","VIDEO_ENDPOINT","TIMEOUT_BUFFER","sizeMap","bidCallback","bidError","buildVideoRequestPayload","buildOptimizedCall","addErrorBid","handleRpCB","badBid","_getScreenResolution","playerWidth","playerHeight","postData","resolution","account_id","integration","stash_creatives","ae_pass_through_parameters","aeParams","slotData","site_id","element_id","size_id","inventory","visitor","userId","pageUrl","masSizeOrdering","memo","_renderCreative","impId","adResponseKey","_adCpmSort","deal","creative_depot_url","impression_id","num","rubiconTargeting","adA","adB","MAS_SIZE_PRIORITY","mappedSize","second","firstPriority","secondPriority","SMARTYADS_BIDDER_CODE","deviceWidth","deviceHeight","banner_id","HuddledMassesAdapter","SmartAdServer","generateCallback","adCall","formatId","sekindoUMAdapter","bidsCount","pubUrl","bidReqeust","sekindoCB","spaceId","subId","ServerBidAdapter","time","enableBotFiltering","includePricingData","bid_data","networkId","zoneIds","campaignId","flightId","divName","adTypes","_responseCallback","decision","decisions","pricing","clearPrice","retrieveAd","contents","impressionUrl","keymakerAssoc","bidReqAssoc","_phone_in","trinity","adSlots","_keymaker","_operator","keyring","slotIdentifier","ad_unit","_failure","cb_name","_trinity","sbi_dc","slot_id","sbi_aid","sbi_mouse","sbi_size","_success","_seraph","theOne","goodBid","sbi_dozer","_creative","failBid","formRequest","parseResponse","failure","sovrnUrl","sovrnBids","sovrnImps","sovrnBidReq","REPO_AND_VERSION","impidsWithBidBack","missing","sovrnResponse","sovrnResponseObj","sovrnBid","SpringServeAdapter","buildSpringServeCall","spCall","requestAttrMap","sp","imp_id","handleSpringServeCB","adloader_1","ROOT_URL","BID_AVAILABLE","tldr","requestPrebid","rootUrl","root_url","handleBids","_i","bids_1","requestPlacement","_this","rid","then","receiver","TLDR_REQUEST","TLDR_RESPONSE","stopListen","removeEventListener","StickyAdsTVAdapter","STICKYADS_BIDDERCODE","MUSTANG_URL","INTEXTROLL_URL","SCREENROLL_URL","topMostWindow","getTopMostWindow","stickyadstv_cache","integrationType","urltoLoad","bidRegistered","getBid","getBiggerSize","vastLoader","com","stickyadstv","vast","VastLoader","getVast","vastCallback","onSuccess","formatAdHTML","extractPrice","formatBidObject","onError","playerSize","vastUrlParams","componentId","screenroll","getPlayerSize","formatInBannerHTML","divHtml","formatIntextHTML","domId","formatScreenRollHTML","priceData","getPricing","TripleLiftAdapter","tlReq","buildTLCall","tlURI","tlCall","isFlashEnabled","hasFlash","fo","TLCB","tlResponseObj","buildBidCall","handleTwCB","bidResponseObj","ybotq","ybotlib","BID_STATUS","PENDING","AVAILABLE","EMPTY","definedSlots","pageLevelOption","buildCreative","buildBid","slotCriteria","ybot_ad","ybot_cpm","szArr","ybot_size","ybot_slot","sizeStr","yieldbot","psn","defineSlot","enableAsync","_initialized","go","nextPageview","handleUpdateState","ybRequest","getSlotCriteria","defaultPlacementForBadBid","NginAdAdapter","rtbServerDomain","nginadBids","_getUniqueTagids","PubZoneIds","getWidthAndHeight","nginadImps","whArr","nginadDomain","nginadBidReq","handleErrorResponse","nginadResponse","nginadResponseObj","nginadBid","Id","brightcomUrl","brightcomBidderCode","brightcomCallbackFunction","reqAdUnitsCode","resAdUnitsCode","brightcomImps","pubId","adWidth","adHeight","refoverride","brightcomBidReq","PREBID_TIMEOUT","curTimeout","bidRequestCallUrl","brightcomResponse","brightcomResponseObj","curBid","responseCreative","WideOrbitAdapter","pageImpression","pageRepeatCommonParam","pageRepeatParamId","pageRepeatParamNamed","base","adapterName","_fixParamNames","properties","prop","correctName","_setParam","pattern","_setParams","keyValuePairs","keyValuePair","_setCommonParams","atf","ecpm","_getRankParam","rank","_setupIdPlacementParameters","pId","_setupNamedPlacementParameters","subPublisher","_setupAdCall","placementCount","placementsComponent","_setupPlacementParameters","commonParams","pbId","_processUserMatchings","userMatchings","headElem","createdElem","userMatching","Type","_getBidResponse","ExtPlacementId","_isUrl","scr","_buildAdCode","adCode","Source","pixelTag","TrackingCodes","trackingCode","handleWideOrbitCallback","Placements","UserMatchings","Width","Height","JCMAdapter","processJCMResponse","JCMResponse","JCMRespObj","BidRequest","adSizes","JSONStr","reqURL","UnderdogMediaAdapter","UDM_ADAPTER_VERSION","bidParam","_callback","mids","filled","mid","useCount","size_not_found","ad_code_html","_makeNotification","handleUnderdogMediaCB","notification_url","visibilityState","_getUrlVars","vars","hashes","bidderName","MemeGlobalAdapter","_requestBid","bidReq","getBidSetForBidder","mgres","bidderBid","_publisherTagUrl","_bidderCode","_profileId","criteo_pubtag","_pushBidRequestEvent","Criteo","biddingEventFunc","isAudit","PubTag","DirectBidding","DirectBiddingSlot","audit","biddingEvent","DirectBiddingEvent","DirectBiddingUrlBuilder","_callbackSuccess","_callbackError","parseBidResponse","bidsResponse","isNoBidResponse","jsonbidsResponse","_invalidBidResponse","baseUrl","devUrl","handlerPrefix","LOG_ERROR_MESS","noUnit","noAdTag","anotherCode","undefBid","unitNum","_makeHandler","handlerName","_responseProcessing","_sendBidRequest","isDev","adTag","sectionID","_defaultBidderSettings","handleXhbCB","STR_BIDDER_CODE","STR_VERSION","STR_BTLR_HOST","STR_BEACON_HOST","placementCodeSet","_buildSharethroughCall","_strcallback","pkey","appendEnvFields","creatives","adserverRequestId","windowLocation","bidJsonString","_handleInvalidBid","roxotUrl","roxotResponseHandler","roxotBidReqs","roxotResponseObject","isResponseInvalid","fillPlacementEmptyBid","pushRoxotBid","allBidResponse","roxotBid","pushErrorBid","places","fillIfNotFilled","BIDDER_NAME","QUERY_PARAM_KEY","slotBidId","round","vzEndPoint","reqParams","reqSrc","vzReq","_vzPlacementId","_rqsrc","_cb","_slotBidId","queryParamValue","vzResponse","vertozResponse","bidRespObj","reqBidObj","respStatusText","adSpaceId","WS_ADAPTER_VERSION","useSSL","baseURL","callbackUid","sid","paramKeys","widespaceHandleCB","bidsArray","inBid","Ajax","invUrl","_error","responseCallback","atomx_prebid","_bid","TapSenseAdapter","creativeSizes","validParams","SCRIPT_URL","tapsense","ad_unit_id","tapsenseCallback","count_ad_units","ad_units","scriptURL","BID_REQUEST_BASE_URL","USER_SYNC_URL","userTag","TRION_INT","sectionId","to","int_t","TR_INT_T","buildTrionUrl","trionUrl","handleTrionCB","trionResponseObj","placeBid","cookiePersistMessage","cookiePersistUrl","PrebidServer","s2sconfig","requestJson","max_bids","timeout_millis","hasSizes","bidder_status","no_cookie","cookie","queue","fireSyncs","queueSync","syncCookies","persist","msgHtml","linkOverride","displayFooter","links","link","createFooter","footer","background","color","boxShadow","fontFamily","lineHeight","bottom","left","right","padding","zindex","footerText","margin","ADSUPPLY_CODE","AdSupplyAdapter","_validateParams","endpointUrl","clientId","_getRequestUrl","referrerUrl","rand","adSupplyResponseHandler","zoneProp","media","Media","Ecpm","noFillbject","_makeCallBackHandler","requestUrl","isFinite","listenMessagesFromCreative","receiveMessage","adObject","sendAdToCreative","adServerDomain","remoteDomain","resizeRemoteCreative","getAdUnitPath","getSlotElementId","AdServer","attr","getWinningBidByCode","dfpReqParams","dfpParamsWithVariableValue","getCustomParams","description_url","cust_params","correlator","pbTargetingKeys","getWinningBidTargeting","getAlwaysUseBidTargeting","getBidLandscapeTargeting","targetKey","targetingConfig","keywordsObj","nKey","apntag","setKeywords","winners","standardKeys","getStandardKeys","winner","TARGETING_KEYS","getTargetingMap"],"mappings":"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D,+B;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAqF,uBAAuB;AAC5G,oEAAmE;AACnE,iEAAgE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd,eAAc;AACd,eAAc;AACd,eAAc;AACd,gBAAe;AACf,gBAAe;AACf,gBAAe;AACf,iBAAgB;AAChB,0B;;;;;;AC1CA;AACA;AACA;AACA,wCAAuC,gC;;;;;;ACHvC,8BAA6B;AAC7B,sCAAqC,gC;;;;;;ACDrC;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,G;;;;;;ACPA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG,UAAU;AACb;AACA;AACA;AACA,G;;;;;;ACfA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA,G;;;;;;ACFA;AACA,uEAAsE,gBAAgB,UAAU,GAAG;AACnG,EAAC,E;;;;;;ACFD;AACA;AACA,kCAAiC,QAAQ,gBAAgB,UAAU,GAAG;AACtE,EAAC,E;;;;;;ACHD;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,G;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA,EAAC,E;;;;;;AC/BD,wBAAuB;AACvB;AACA;AACA,G;;;;;;ACHA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACnBA;AACA;AACA;AACA,G;;;;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS,eAAe;AACxB;AACA;AACA;AACA,uCAAsC;AACtC;AACA,+BAA8B;AAC9B,8BAA6B;AAC7B,gCAA+B;AAC/B,oCAAmC;AACnC,UAAS,+BAA+B;AACxC;AACA;AACA;AACA;AACA,G;;;;;;AC3CA;AACA;AACA;AACA;AACA,G;;;;;;ACJA,kBAAiB;;AAEjB;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA;AACA,4DAA2D;AAC3D,G;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACLA;AACA;;AAEA;AACA;AACA,G;;;;;;ACLA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;ACfA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,wB;;;;;;ACVA;AACA;AACA,oDAAmD;AACnD;AACA,wCAAuC;AACvC,G;;;;;;ACLA;AACA;AACA;AACA,4FAAsF;AACtF;AACA;AACA,G;;;;;;ACNA;AACA,yD;;;;;;ACDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAC;;AAED,sC;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,WAAW,eAAe;AAC/B;AACA,MAAK;AACL;AACA,G;;;;;;ACpBA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACNA;AACA,wD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","file":"prebid.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8a242c693c0fb2a53bb4","/** @module pbjs */\n\nimport { getGlobal } from './prebidGlobal';\nimport {flatten, uniques, isGptPubadsDefined, adUnitsFilter } from './utils';\nimport { videoAdUnit, hasNonVideoBidder } from './video';\nimport 'polyfill';\nimport {parse as parseURL, format as formatURL} from './url';\nimport {isValidePriceConfig} from './cpmBucketManager';\nimport {listenMessagesFromCreative} from './secure-creatives';\nimport { syncCookies } from 'src/cookie.js';\nimport { loadScript } from './adloader';\n\n\nvar pbjs = getGlobal();\nvar CONSTANTS = require('./constants.json');\nvar utils = require('./utils.js');\nvar bidmanager = require('./bidmanager.js');\nvar adaptermanager = require('./adaptermanager');\nvar bidfactory = require('./bidfactory');\nvar events = require('./events');\nvar adserver = require('./adserver.js');\nvar targeting = require('./targeting.js');\n\n/* private variables */\n\nvar objectType_function = 'function';\nvar objectType_undefined = 'undefined';\nvar objectType_object = 'object';\nvar BID_WON = CONSTANTS.EVENTS.BID_WON;\nvar SET_TARGETING = CONSTANTS.EVENTS.SET_TARGETING;\n\nvar auctionRunning = false;\nvar bidRequestQueue = [];\n\nvar eventValidators = {\n  bidWon: checkDefinedPlacement\n};\n\n/* Public vars */\n\npbjs._bidsRequested = [];\npbjs._bidsReceived = [];\n// _adUnitCodes stores the current filter to use for adUnits as an array of adUnitCodes\npbjs._adUnitCodes = [];\npbjs._winningBids = [];\npbjs._adsReceived = [];\npbjs._sendAllBids = false;\n\npbjs.bidderSettings = pbjs.bidderSettings || {};\n\n//default timeout for all bids\npbjs.bidderTimeout = pbjs.bidderTimeout || 3000;\n\n// current timeout set in `requestBids` or to default `bidderTimeout`\npbjs.cbTimeout = pbjs.cbTimeout || 200;\n\n// timeout buffer to adjust for bidder CDN latency\npbjs.timeoutBuffer = 200;\n\npbjs.logging = pbjs.logging || false;\n\n// domain where prebid is running for cross domain iframe communication\npbjs.publisherDomain = pbjs.publisherDomain || window.location.origin;\n\n//let the world know we are loaded\npbjs.libLoaded = true;\n\n//version auto generated from build\npbjs.version = 'v0.24.0-pre';\nutils.logInfo('Prebid.js v0.24.0-pre loaded');\n\n//create adUnit array\npbjs.adUnits = pbjs.adUnits || [];\n\n//delay to request cookie sync to stay out of critical path\npbjs.cookieSyncDelay = pbjs.cookieSyncDelay || 100;\n\n\n/**\n * Command queue that functions will execute once prebid.js is loaded\n * @param  {function} cmd Anonymous function to execute\n * @alias module:pbjs.que.push\n */\npbjs.que.push = function (cmd) {\n  if (typeof cmd === objectType_function) {\n    try {\n      cmd.call();\n    } catch (e) {\n      utils.logError('Error processing command :' + e.message);\n    }\n  } else {\n    utils.logError('Commands written into pbjs.que.push must wrapped in a function');\n  }\n};\n\nfunction processQue() {\n  for (var i = 0; i < pbjs.que.length; i++) {\n    if (typeof pbjs.que[i].called === objectType_undefined) {\n      try {\n        pbjs.que[i].call();\n        pbjs.que[i].called = true;\n      }\n      catch (e) {\n        utils.logError('Error processing command :', 'prebid.js', e);\n      }\n    }\n  }\n}\n\nfunction checkDefinedPlacement(id) {\n  var placementCodes = pbjs._bidsRequested.map(bidSet => bidSet.bids.map(bid => bid.placementCode))\n    .reduce(flatten)\n    .filter(uniques);\n\n  if (!utils.contains(placementCodes, id)) {\n    utils.logError('The \"' + id + '\" placement is not defined.');\n    return;\n  }\n\n  return true;\n}\n\n/**\n * When a request for bids is made any stale bids remaining will be cleared for\n * a placement included in the outgoing bid request.\n */\nfunction clearPlacements() {\n  pbjs._bidsRequested = [];\n\n  // leave bids received for ad slots not in this bid request\n  pbjs._bidsReceived = pbjs._bidsReceived\n    .filter(bid => !pbjs._adUnitCodes.includes(bid.adUnitCode));\n}\n\nfunction setRenderSize(doc, width, height) {\n  if (doc.defaultView && doc.defaultView.frameElement) {\n    doc.defaultView.frameElement.width = width;\n    doc.defaultView.frameElement.height = height;\n  }\n}\n\n//////////////////////////////////\n//                              //\n//    Start Public APIs         //\n//                              //\n//////////////////////////////////\n\n/**\n * This function returns the query string targeting parameters available at this moment for a given ad unit. Note that some bidder's response may not have been received if you call this function too quickly after the requests are sent.\n * @param  {string} [adunitCode] adUnitCode to get the bid responses for\n * @alias module:pbjs.getAdserverTargetingForAdUnitCodeStr\n * @return {array}  returnObj return bids array\n */\npbjs.getAdserverTargetingForAdUnitCodeStr = function (adunitCode) {\n  utils.logInfo('Invoking pbjs.getAdserverTargetingForAdUnitCodeStr', arguments);\n\n  // call to retrieve bids array\n  if (adunitCode) {\n    var res = pbjs.getAdserverTargetingForAdUnitCode(adunitCode);\n    return utils.transformAdServerTargetingObj(res);\n  } else {\n    utils.logMessage('Need to call getAdserverTargetingForAdUnitCodeStr with adunitCode');\n  }\n};\n\n/**\n * This function returns the query string targeting parameters available at this moment for a given ad unit. Note that some bidder's response may not have been received if you call this function too quickly after the requests are sent.\n * @param adUnitCode {string} adUnitCode to get the bid responses for\n * @returns {object}  returnObj return bids\n */\npbjs.getAdserverTargetingForAdUnitCode = function(adUnitCode) {\n  return pbjs.getAdserverTargeting(adUnitCode)[adUnitCode];\n};\n\n/**\n * returns all ad server targeting for all ad units\n * @return {object} Map of adUnitCodes and targeting values []\n * @alias module:pbjs.getAdserverTargeting\n */\n\npbjs.getAdserverTargeting = function (adUnitCode) {\n  utils.logInfo('Invoking pbjs.getAdserverTargeting', arguments);\n  return targeting.getAllTargeting(adUnitCode)\n    .map(targeting => {\n      return {\n        [Object.keys(targeting)[0]]: targeting[Object.keys(targeting)[0]]\n          .map(target => {\n            return {\n              [Object.keys(target)[0]]: target[Object.keys(target)[0]].join(', ')\n            };\n          }).reduce((p, c) => Object.assign(c, p), {})\n      };\n    })\n    .reduce(function (accumulator, targeting) {\n      var key = Object.keys(targeting)[0];\n      accumulator[key] = Object.assign({}, accumulator[key], targeting[key]);\n      return accumulator;\n    }, {});\n};\n\n/**\n * This function returns the bid responses at the given moment.\n * @alias module:pbjs.getBidResponses\n * @return {object}            map | object that contains the bidResponses\n */\n\npbjs.getBidResponses = function () {\n  utils.logInfo('Invoking pbjs.getBidResponses', arguments);\n  const responses = pbjs._bidsReceived\n    .filter(adUnitsFilter.bind(this, pbjs._adUnitCodes));\n\n  // find the last requested id to get responses for most recent auction only\n  const currentRequestId = responses && responses.length && responses[responses.length - 1].requestId;\n\n  return responses.map(bid => bid.adUnitCode)\n    .filter(uniques).map(adUnitCode => responses\n      .filter(bid => bid.requestId === currentRequestId && bid.adUnitCode === adUnitCode))\n    .filter(bids => bids && bids[0] && bids[0].adUnitCode)\n    .map(bids => {\n      return {\n        [bids[0].adUnitCode]: { bids: bids }\n      };\n    })\n    .reduce((a, b) => Object.assign(a, b), {});\n};\n\n/**\n * Returns bidResponses for the specified adUnitCode\n * @param  {String} adUnitCode adUnitCode\n * @alias module:pbjs.getBidResponsesForAdUnitCode\n * @return {Object}            bidResponse object\n */\n\npbjs.getBidResponsesForAdUnitCode = function (adUnitCode) {\n  const bids = pbjs._bidsReceived.filter(bid => bid.adUnitCode === adUnitCode);\n  return {\n    bids: bids\n  };\n};\n\n/**\n * Set query string targeting on all GPT ad units.\n * @alias module:pbjs.setTargetingForGPTAsync\n */\npbjs.setTargetingForGPTAsync = function () {\n  utils.logInfo('Invoking pbjs.setTargetingForGPTAsync', arguments);\n  if (!isGptPubadsDefined()) {\n    utils.logError('window.googletag is not defined on the page');\n    return;\n  }\n\n  //first reset any old targeting\n  targeting.resetPresetTargeting();\n\n  //now set new targeting keys\n  targeting.setTargeting(targeting.getAllTargeting());\n\n  //emit event\n  events.emit(SET_TARGETING);\n};\n\npbjs.setTargetingForAst = function() {\n  utils.logInfo('Invoking pbjs.setTargetingForAn', arguments);\n  if(!targeting.isApntagDefined()) {\n    utils.logError('window.apntag is not defined on the page');\n    return;\n  }\n\n  targeting.setTargetingForAst();\n\n  //emit event\n  events.emit(SET_TARGETING);\n};\n\n/**\n * Returns a bool if all the bids have returned or timed out\n * @alias module:pbjs.allBidsAvailable\n * @return {bool} all bids available\n */\npbjs.allBidsAvailable = function () {\n  utils.logInfo('Invoking pbjs.allBidsAvailable', arguments);\n  return bidmanager.bidsBackAll();\n};\n\n/**\n * This function will render the ad (based on params) in the given iframe document passed through.\n * Note that doc SHOULD NOT be the parent document page as we can't doc.write() asynchronously\n * @param  {HTMLDocument} doc document\n * @param  {string} id bid id to locate the ad\n * @alias module:pbjs.renderAd\n */\npbjs.renderAd = function (doc, id) {\n  utils.logInfo('Invoking pbjs.renderAd', arguments);\n  utils.logMessage('Calling renderAd with adId :' + id);\n  if (doc && id) {\n    try {\n      //lookup ad by ad Id\n      const bid = pbjs._bidsReceived.find(bid => bid.adId === id);\n      if (bid) {\n        //replace macros according to openRTB with price paid = bid.cpm\n        bid.ad = utils.replaceAuctionPrice(bid.ad, bid.cpm);\n        bid.url = utils.replaceAuctionPrice(bid.url, bid.cpm);\n        //save winning bids\n        pbjs._winningBids.push(bid);\n\n        //emit 'bid won' event here\n        events.emit(BID_WON, bid);\n\n        const { height, width, ad, mediaType, adUrl: url, renderer } = bid;\n\n        if (renderer && renderer.url) {\n          renderer.render(bid);\n        } else if ((doc === document && !utils.inIframe()) || mediaType === 'video') {\n          utils.logError(`Error trying to write ad. Ad render call ad id ${id} was prevented from writing to the main document.`);\n        } else if (ad) {\n          doc.write(ad);\n          doc.close();\n          setRenderSize(doc, width, height);\n        } else if (url) {\n          doc.write(`<IFRAME SRC=\"${url}\" FRAMEBORDER=\"0\" SCROLLING=\"no\" MARGINHEIGHT=\"0\" MARGINWIDTH=\"0\" TOPMARGIN=\"0\" LEFTMARGIN=\"0\" ALLOWTRANSPARENCY=\"true\" WIDTH=\"${width}\" HEIGHT=\"${height}\"></IFRAME>`);\n          doc.close();\n          setRenderSize(doc, width, height);\n        } else {\n          utils.logError('Error trying to write ad. No ad for bid response id: ' + id);\n        }\n\n      } else {\n        utils.logError('Error trying to write ad. Cannot find ad by given id : ' + id);\n      }\n\n    } catch (e) {\n      utils.logError('Error trying to write ad Id :' + id + ' to the page:' + e.message);\n    }\n  } else {\n    utils.logError('Error trying to write ad Id :' + id + ' to the page. Missing document or adId');\n  }\n\n};\n\n/**\n * Remove adUnit from the pbjs configuration\n * @param  {String} adUnitCode the adUnitCode to remove\n * @alias module:pbjs.removeAdUnit\n */\npbjs.removeAdUnit = function (adUnitCode) {\n  utils.logInfo('Invoking pbjs.removeAdUnit', arguments);\n  if (adUnitCode) {\n    for (var i = 0; i < pbjs.adUnits.length; i++) {\n      if (pbjs.adUnits[i].code === adUnitCode) {\n        pbjs.adUnits.splice(i, 1);\n      }\n    }\n  }\n};\n\npbjs.clearAuction = function() {\n  auctionRunning = false;\n  syncCookies(pbjs.cookieSyncDelay);\n  utils.logMessage('Prebid auction cleared');\n  if (bidRequestQueue.length) {\n    bidRequestQueue.shift()();\n  }\n};\n\n/**\n *\n * @param bidsBackHandler\n * @param timeout\n * @param adUnits\n * @param adUnitCodes\n */\npbjs.requestBids = function ({ bidsBackHandler, timeout, adUnits, adUnitCodes } = {}) {\n  events.emit('requestBids');\n  const cbTimeout = pbjs.cbTimeout = timeout || pbjs.bidderTimeout;\n  adUnits = adUnits || pbjs.adUnits;\n\n  utils.logInfo('Invoking pbjs.requestBids', arguments);\n\n  if (adUnitCodes && adUnitCodes.length) {\n    // if specific adUnitCodes supplied filter adUnits for those codes\n    adUnits = adUnits.filter(unit => adUnitCodes.includes(unit.code));\n  } else {\n    // otherwise derive adUnitCodes from adUnits\n    adUnitCodes = adUnits && adUnits.map(unit => unit.code);\n  }\n\n  // for video-enabled adUnits, only request bids if all bidders support video\n  const invalidVideoAdUnits = adUnits.filter(videoAdUnit).filter(hasNonVideoBidder);\n  invalidVideoAdUnits.forEach(adUnit => {\n    utils.logError(`adUnit ${adUnit.code} has 'mediaType' set to 'video' but contains a bidder that doesn't support video. No Prebid demand requests will be triggered for this adUnit.`);\n    for (let i = 0; i < adUnits.length; i++) {\n      if (adUnits[i].code === adUnit.code) {adUnits.splice(i, 1);}\n    }\n  });\n\n  if (auctionRunning) {\n    bidRequestQueue.push(() => {\n      pbjs.requestBids({ bidsBackHandler, timeout: cbTimeout, adUnits, adUnitCodes });\n    });\n    return;\n  }\n\n  auctionRunning = true;\n\n  // we will use adUnitCodes for filtering the current auction\n  pbjs._adUnitCodes = adUnitCodes;\n\n  bidmanager.externalCallbackReset();\n  clearPlacements();\n\n  if (!adUnits || adUnits.length === 0) {\n    utils.logMessage('No adUnits configured. No bids requested.');\n    if (typeof bidsBackHandler === objectType_function) {\n      bidmanager.addOneTimeCallback(bidsBackHandler, false);\n    }\n    bidmanager.executeCallback();\n    return;\n  }\n\n  //set timeout for all bids\n  const timedOut = true;\n  const timeoutCallback = bidmanager.executeCallback.bind(bidmanager, timedOut);\n  const timer = setTimeout(timeoutCallback, cbTimeout);\n  if (typeof bidsBackHandler === objectType_function) {\n    bidmanager.addOneTimeCallback(bidsBackHandler, timer);\n  }\n\n  adaptermanager.callBids({ adUnits, adUnitCodes, cbTimeout });\n  if(pbjs._bidsRequested.length === 0) {\n    bidmanager.executeCallback();\n  }\n};\n\n/**\n *\n * Add adunit(s)\n * @param {Array|String} adUnitArr Array of adUnits or single adUnit Object.\n * @alias module:pbjs.addAdUnits\n */\npbjs.addAdUnits = function (adUnitArr) {\n  utils.logInfo('Invoking pbjs.addAdUnits', arguments);\n  if (utils.isArray(adUnitArr)) {\n    // generate transactionid for each new adUnits\n    // Append array to existing\n    adUnitArr.forEach(adUnit => adUnit.transactionId = utils.generateUUID());\n    pbjs.adUnits.push.apply(pbjs.adUnits, adUnitArr);\n  } else if (typeof adUnitArr === objectType_object) {\n    // Generate the transaction id for the adunit\n    adUnitArr.transactionId = utils.generateUUID();\n    pbjs.adUnits.push(adUnitArr);\n  }\n};\n\n/**\n * @param {String} event the name of the event\n * @param {Function} handler a callback to set on event\n * @param {String} id an identifier in the context of the event\n *\n * This API call allows you to register a callback to handle a Prebid.js event.\n * An optional `id` parameter provides more finely-grained event callback registration.\n * This makes it possible to register callback events for a specific item in the\n * event context. For example, `bidWon` events will accept an `id` for ad unit code.\n * `bidWon` callbacks registered with an ad unit code id will be called when a bid\n * for that ad unit code wins the auction. Without an `id` this method registers the\n * callback for every `bidWon` event.\n *\n * Currently `bidWon` is the only event that accepts an `id` parameter.\n */\npbjs.onEvent = function (event, handler, id) {\n  utils.logInfo('Invoking pbjs.onEvent', arguments);\n  if (!utils.isFn(handler)) {\n    utils.logError('The event handler provided is not a function and was not set on event \"' + event + '\".');\n    return;\n  }\n\n  if (id && !eventValidators[event].call(null, id)) {\n    utils.logError('The id provided is not valid for event \"' + event + '\" and no handler was set.');\n    return;\n  }\n\n  events.on(event, handler, id);\n};\n\n/**\n * @param {String} event the name of the event\n * @param {Function} handler a callback to remove from the event\n * @param {String} id an identifier in the context of the event (see `pbjs.onEvent`)\n */\npbjs.offEvent = function (event, handler, id) {\n  utils.logInfo('Invoking pbjs.offEvent', arguments);\n  if (id && !eventValidators[event].call(null, id)) {\n    return;\n  }\n\n  events.off(event, handler, id);\n};\n\n/**\n * Add a callback event\n * @param {String} eventStr event to attach callback to Options: \"allRequestedBidsBack\" | \"adUnitBidsBack\"\n * @param {Function} func  function to execute. Parameters passed into the function: (bidResObj), [adUnitCode]);\n * @alias module:pbjs.addCallback\n * @returns {String} id for callback\n */\npbjs.addCallback = function (eventStr, func) {\n  utils.logInfo('Invoking pbjs.addCallback', arguments);\n  var id = null;\n  if (!eventStr || !func || typeof func !== objectType_function) {\n    utils.logError('error registering callback. Check method signature');\n    return id;\n  }\n\n  id = utils.getUniqueIdentifierStr;\n  bidmanager.addCallback(id, func, eventStr);\n  return id;\n};\n\n/**\n * Remove a callback event\n * //@param {string} cbId id of the callback to remove\n * @alias module:pbjs.removeCallback\n * @returns {String} id for callback\n */\npbjs.removeCallback = function (/* cbId */) {\n  //todo\n  return null;\n};\n\n/**\n * Wrapper to register bidderAdapter externally (adaptermanager.registerBidAdapter())\n * @param  {[type]} bidderAdaptor [description]\n * @param  {[type]} bidderCode    [description]\n * @return {[type]}               [description]\n */\npbjs.registerBidAdapter = function (bidderAdaptor, bidderCode) {\n  utils.logInfo('Invoking pbjs.registerBidAdapter', arguments);\n  try {\n    adaptermanager.registerBidAdapter(bidderAdaptor(), bidderCode);\n  }\n  catch (e) {\n    utils.logError('Error registering bidder adapter : ' + e.message);\n  }\n};\n\n/**\n * Wrapper to register analyticsAdapter externally (adaptermanager.registerAnalyticsAdapter())\n * @param  {[type]} options [description]\n */\npbjs.registerAnalyticsAdapter = function (options) {\n  utils.logInfo('Invoking pbjs.registerAnalyticsAdapter', arguments);\n  try {\n    adaptermanager.registerAnalyticsAdapter(options);\n  }\n  catch (e) {\n    utils.logError('Error registering analytics adapter : ' + e.message);\n  }\n};\n\npbjs.bidsAvailableForAdapter = function (bidderCode) {\n  utils.logInfo('Invoking pbjs.bidsAvailableForAdapter', arguments);\n\n  pbjs._bidsRequested.find(bidderRequest => bidderRequest.bidderCode === bidderCode).bids\n    .map(bid => {\n      return Object.assign(bid, bidfactory.createBid(1), {\n        bidderCode,\n        adUnitCode: bid.placementCode\n      });\n    })\n    .map(bid => pbjs._bidsReceived.push(bid));\n};\n\n/**\n * Wrapper to bidfactory.createBid()\n * @param  {[type]} statusCode [description]\n * @return {[type]}            [description]\n */\npbjs.createBid = function (statusCode) {\n  utils.logInfo('Invoking pbjs.createBid', arguments);\n  return bidfactory.createBid(statusCode);\n};\n\n/**\n * Wrapper to bidmanager.addBidResponse\n * @param {[type]} adUnitCode [description]\n * @param {[type]} bid        [description]\n */\npbjs.addBidResponse = function (adUnitCode, bid) {\n  utils.logInfo('Invoking pbjs.addBidResponse', arguments);\n  bidmanager.addBidResponse(adUnitCode, bid);\n};\n\n/**\n * Wrapper to adloader.loadScript\n * @param  {[type]}   tagSrc   [description]\n * @param  {Function} callback [description]\n * @return {[type]}            [description]\n */\npbjs.loadScript = function (tagSrc, callback, useCache) {\n  utils.logInfo('Invoking pbjs.loadScript', arguments);\n  loadScript(tagSrc, callback, useCache);\n};\n\n/**\n * Will enable sending a prebid.js to data provider specified\n * @param  {object} config object {provider : 'string', options : {}}\n */\npbjs.enableAnalytics = function (config) {\n  if (config && !utils.isEmpty(config)) {\n    utils.logInfo('Invoking pbjs.enableAnalytics for: ', config);\n    adaptermanager.enableAnalytics(config);\n  } else {\n    utils.logError('pbjs.enableAnalytics should be called with option {}');\n  }\n};\n\npbjs.aliasBidder = function (bidderCode, alias) {\n  utils.logInfo('Invoking pbjs.aliasBidder', arguments);\n  if (bidderCode && alias) {\n    adaptermanager.aliasBidAdapter(bidderCode, alias);\n  } else {\n    utils.logError('bidderCode and alias must be passed as arguments', 'pbjs.aliasBidder');\n  }\n};\n\n/**\n * Sets a default price granularity scheme.\n * @param {String|Object} granularity - the granularity scheme.\n * \"low\": $0.50 increments, capped at $5 CPM\n * \"medium\": $0.10 increments, capped at $20 CPM (the default)\n * \"high\": $0.01 increments, capped at $20 CPM\n * \"auto\": Applies a sliding scale to determine granularity\n * \"dense\": Like \"auto\", but the bid price granularity uses smaller increments, especially at lower CPMs\n *\n * Alternatively a custom object can be specified:\n * { \"buckets\" : [{\"min\" : 0,\"max\" : 20,\"increment\" : 0.1,\"cap\" : true}]};\n * See http://prebid.org/dev-docs/publisher-api-reference.html#module_pbjs.setPriceGranularity for more details\n */\npbjs.setPriceGranularity = function (granularity) {\n  utils.logInfo('Invoking pbjs.setPriceGranularity', arguments);\n  if (!granularity) {\n    utils.logError('Prebid Error: no value passed to `setPriceGranularity()`');\n    return;\n  }\n  if(typeof granularity === 'string') {\n    bidmanager.setPriceGranularity(granularity);\n  }\n  else if(typeof granularity === 'object') {\n    if(!isValidePriceConfig(granularity)){\n      utils.logError('Invalid custom price value passed to `setPriceGranularity()`');\n      return;\n    }\n    bidmanager.setCustomPriceBucket(granularity);\n    bidmanager.setPriceGranularity(CONSTANTS.GRANULARITY_OPTIONS.CUSTOM);\n    utils.logMessage('Using custom price granularity');\n  }\n};\n\npbjs.enableSendAllBids = function () {\n  pbjs._sendAllBids = true;\n};\n\npbjs.getAllWinningBids = function () {\n  return pbjs._winningBids;\n};\n\n/**\n * Build master video tag from publishers adserver tag\n * @param {string} adserverTag default url\n * @param {object} options options for video tag\n */\npbjs.buildMasterVideoTagFromAdserverTag = function (adserverTag, options) {\n  utils.logInfo('Invoking pbjs.buildMasterVideoTagFromAdserverTag', arguments);\n  var urlComponents = parseURL(adserverTag);\n\n  //return original adserverTag if no bids received\n  if(pbjs._bidsReceived.length === 0) {\n    return adserverTag;\n  }\n\n  var masterTag = '';\n  if(options.adserver.toLowerCase() === 'dfp') {\n    var dfpAdserverObj = adserver.dfpAdserver(options, urlComponents);\n    if(!dfpAdserverObj.verifyAdserverTag()) {\n      utils.logError('Invalid adserverTag, required google params are missing in query string');\n    }\n    dfpAdserverObj.appendQueryParams();\n    masterTag = formatURL(dfpAdserverObj.urlComponents);\n  } else {\n    utils.logError('Only DFP adserver is supported');\n    return;\n  }\n  return masterTag;\n};\n\n/**\n * Set the order bidders are called in. If not set, the bidders are called in\n * the order they are defined within the adUnit.bids array\n * @param {string} order - Order to call bidders in. Currently the only possible value\n * is 'random', which randomly shuffles the order\n */\npbjs.setBidderSequence = function (order) {\n  if (order === CONSTANTS.ORDER.RANDOM) {\n    adaptermanager.setBidderSequence(CONSTANTS.ORDER.RANDOM);\n  }\n};\n\n/**\n * Get array of highest cpm bids for all adUnits, or highest cpm bid\n * object for the given adUnit\n * @param {string} adUnitCode - optional ad unit code\n * @return {array} array containing highest cpm bid object(s)\n */\npbjs.getHighestCpmBids = function (adUnitCode) {\n  return targeting.getWinningBids(adUnitCode);\n};\n\n/**\n * Set config for server to server header bidding\n * @param {object} options - config object for s2s\n */\npbjs.setS2SConfig = function(options) {\n\n  if (!utils.contains(Object.keys(options), 'accountId')) {\n    utils.logError('accountId missing in Server to Server config');\n    return;\n  }\n\n  if (!utils.contains(Object.keys(options), 'bidders')) {\n    utils.logError('bidders missing in Server to Server config');\n    return;\n  }\n\n  const config = Object.assign({\n    enabled : false,\n    endpoint : CONSTANTS.S2S.DEFAULT_ENDPOINT,\n    timeout : 1000,\n    maxBids : 1,\n    adapter : 'prebidServer'\n  }, options);\n  adaptermanager.setS2SConfig(config);\n};\n\n\npbjs.que.push(() => listenMessagesFromCreative());\nprocessQue();\n\n\n\n// WEBPACK FOOTER //\n// ./src/prebid.js","// if pbjs already exists in global document scope, use it, if not, create the object\n// global defination should happen BEFORE imports to avoid global undefined errors.\nwindow.pbjs = (window.pbjs || {});\nwindow.pbjs.que = window.pbjs.que || [];\n\nexport function getGlobal() {\n  return window.pbjs;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/prebidGlobal.js","var CONSTANTS = require('./constants.json');\n\nvar objectType_object = 'object';\nvar objectType_string = 'string';\nvar objectType_number = 'number';\n\nvar _loggingChecked = false;\n\nvar t_Arr = 'Array';\nvar t_Str = 'String';\nvar t_Fn = 'Function';\nvar t_Numb = 'Number';\nvar toString = Object.prototype.toString;\nlet infoLogger = null;\ntry {\n  infoLogger = console.info.bind(window.console);\n}\ncatch (e) {\n}\n\n/*\n *   Substitutes into a string from a given map using the token\n *   Usage\n *   var str = 'text %%REPLACE%% this text with %%SOMETHING%%';\n *   var map = {};\n *   map['replace'] = 'it was subbed';\n *   map['something'] = 'something else';\n *   console.log(replaceTokenInString(str, map, '%%')); => \"text it was subbed this text with something else\"\n */\nexports.replaceTokenInString = function (str, map, token) {\n  this._each(map, function (value, key) {\n    value = (value === undefined) ? '' : value;\n\n    var keyString = token + key.toUpperCase() + token;\n    var re = new RegExp(keyString, 'g');\n\n    str = str.replace(re, value);\n  });\n\n  return str;\n};\n\n/* utility method to get incremental integer starting from 1 */\nvar getIncrementalInteger = (function () {\n  var count = 0;\n  return function () {\n    count++;\n    return count;\n  };\n})();\n\nfunction _getUniqueIdentifierStr() {\n  return getIncrementalInteger() + Math.random().toString(16).substr(2);\n}\n\n//generate a random string (to be used as a dynamic JSONP callback)\nexports.getUniqueIdentifierStr = _getUniqueIdentifierStr;\n\n/**\n * Returns a random v4 UUID of the form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx,\n * where each x is replaced with a random hexadecimal digit from 0 to f,\n * and y is replaced with a random hexadecimal digit from 8 to b.\n * https://gist.github.com/jed/982883 via node-uuid\n */\nexports.generateUUID = function generateUUID(placeholder) {\n  return placeholder ?\n    (placeholder ^ Math.random() * 16 >> placeholder/4).toString(16)\n    :\n    ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, generateUUID);\n};\n\nexports.getBidIdParameter = function (key, paramsObj) {\n  if (paramsObj && paramsObj[key]) {\n    return paramsObj[key];\n  }\n\n  return '';\n};\n\nexports.tryAppendQueryString = function (existingUrl, key, value) {\n  if (value) {\n    return existingUrl += key + '=' + encodeURIComponent(value) + '&';\n  }\n\n  return existingUrl;\n};\n\n//parse a query string object passed in bid params\n//bid params should be an object such as {key: \"value\", key1 : \"value1\"}\nexports.parseQueryStringParameters = function (queryObj) {\n  var result = '';\n  for (var k in queryObj) {\n    if (queryObj.hasOwnProperty(k))\n      result += k + '=' + encodeURIComponent(queryObj[k]) + '&';\n  }\n\n  return result;\n};\n\n//transform an AdServer targeting bids into a query string to send to the adserver\nexports.transformAdServerTargetingObj = function (targeting) {\n  // we expect to receive targeting for a single slot at a time\n  if (targeting && Object.getOwnPropertyNames(targeting).length > 0) {\n\n    return getKeys(targeting)\n      .map(key => `${key}=${encodeURIComponent(getValue(targeting, key))}`).join('&');\n  } else {\n    return '';\n  }\n};\n\n/**\n * Parse a GPT-Style general size Array like `[[300, 250]]` or `\"300x250,970x90\"` into an array of sizes `[\"300x250\"]` or '['300x250', '970x90']'\n * @param  {array[array|number]} sizeObj Input array or double array [300,250] or [[300,250], [728,90]]\n * @return {array[string]}  Array of strings like `[\"300x250\"]` or `[\"300x250\", \"728x90\"]`\n */\nexports.parseSizesInput = function (sizeObj) {\n  var parsedSizes = [];\n\n  //if a string for now we can assume it is a single size, like \"300x250\"\n  if (typeof sizeObj === objectType_string) {\n    //multiple sizes will be comma-separated\n    var sizes = sizeObj.split(',');\n\n    //regular expression to match strigns like 300x250\n    //start of line, at least 1 number, an \"x\" , then at least 1 number, and the then end of the line\n    var sizeRegex = /^(\\d)+x(\\d)+$/i;\n    if (sizes) {\n      for (var curSizePos in sizes) {\n        if (hasOwn(sizes, curSizePos) && sizes[curSizePos].match(sizeRegex)) {\n          parsedSizes.push(sizes[curSizePos]);\n        }\n      }\n    }\n  } else if (typeof sizeObj === objectType_object) {\n    var sizeArrayLength = sizeObj.length;\n\n    //don't process empty array\n    if (sizeArrayLength > 0) {\n      //if we are a 2 item array of 2 numbers, we must be a SingleSize array\n      if (sizeArrayLength === 2 && typeof sizeObj[0] === objectType_number && typeof sizeObj[1] === objectType_number) {\n        parsedSizes.push(this.parseGPTSingleSizeArray(sizeObj));\n      } else {\n        //otherwise, we must be a MultiSize array\n        for (var i = 0; i < sizeArrayLength; i++) {\n          parsedSizes.push(this.parseGPTSingleSizeArray(sizeObj[i]));\n        }\n\n      }\n    }\n  }\n\n  return parsedSizes;\n\n};\n\n//parse a GPT style sigle size array, (i.e [300,250])\n//into an AppNexus style string, (i.e. 300x250)\nexports.parseGPTSingleSizeArray = function (singleSize) {\n  //if we aren't exactly 2 items in this array, it is invalid\n  if (this.isArray(singleSize) && singleSize.length === 2 && (!isNaN(singleSize[0]) && !isNaN(singleSize[1]))) {\n    return singleSize[0] + 'x' + singleSize[1];\n  }\n};\n\nexports.getTopWindowLocation = function () {\n  let location;\n  try {\n    location = window.top.location;\n  } catch (e) {\n    location = window.location;\n  }\n\n  return location;\n};\n\nexports.getTopWindowUrl = function () {\n  let href;\n  try {\n    href = this.getTopWindowLocation().href;\n  } catch (e) {\n    href = '';\n  }\n\n  return href;\n};\n\nexports.logWarn = function (msg) {\n  if (debugTurnedOn() && console.warn) {\n    console.warn('WARNING: ' + msg);\n  }\n};\n\nexports.logInfo = function (msg, args) {\n  if (debugTurnedOn() && hasConsoleLogger()) {\n    if (infoLogger) {\n      if (!args || args.length === 0) {\n        args = '';\n      }\n\n      infoLogger('INFO: ' + msg + ((args === '') ? '' : ' : params : '), args);\n    }\n  }\n};\n\nexports.logMessage = function (msg) {\n  if (debugTurnedOn() && hasConsoleLogger()) {\n    console.log('MESSAGE: ' + msg);\n  }\n};\n\nfunction hasConsoleLogger() {\n  return (window.console && window.console.log);\n}\n\nexports.hasConsoleLogger = hasConsoleLogger;\n\nvar errLogFn = (function (hasLogger) {\n  if (!hasLogger) return '';\n  return window.console.error ? 'error' : 'log';\n}(hasConsoleLogger()));\n\nvar debugTurnedOn = function () {\n  if (pbjs.logging === false && _loggingChecked === false) {\n    pbjs.logging = getParameterByName(CONSTANTS.DEBUG_MODE).toUpperCase() === 'TRUE';\n    _loggingChecked = true;\n  }\n\n  return !!pbjs.logging;\n};\n\nexports.debugTurnedOn = debugTurnedOn;\n\nexports.logError = function (msg, code, exception) {\n  var errCode = code || 'ERROR';\n  if (debugTurnedOn() && hasConsoleLogger()) {\n    console[errLogFn](console, errCode + ': ' + msg, exception || '');\n  }\n};\n\nexports.createInvisibleIframe = function _createInvisibleIframe() {\n  var f = document.createElement('iframe');\n  f.id = _getUniqueIdentifierStr();\n  f.height = 0;\n  f.width = 0;\n  f.border = '0px';\n  f.hspace = '0';\n  f.vspace = '0';\n  f.marginWidth = '0';\n  f.marginHeight = '0';\n  f.style.border = '0';\n  f.scrolling = 'no';\n  f.frameBorder = '0';\n  f.src = 'about:blank';\n  f.style.display = 'none';\n  return f;\n};\n\n/*\n *   Check if a given parameter name exists in query string\n *   and if it does return the value\n */\nvar getParameterByName = function (name) {\n  var regexS = '[\\\\?&]' + name + '=([^&#]*)';\n  var regex = new RegExp(regexS);\n  var results = regex.exec(window.location.search);\n  if (results === null) {\n    return '';\n  }\n\n  return decodeURIComponent(results[1].replace(/\\+/g, ' '));\n};\n\n/**\n * This function validates paramaters.\n * @param  {object[string]} paramObj          [description]\n * @param  {string[]} requiredParamsArr [description]\n * @return {bool}                   Bool if paramaters are valid\n */\nexports.hasValidBidRequest = function (paramObj, requiredParamsArr, adapter) {\n  var found = false;\n\n  function findParam(value, key) {\n    if (key === requiredParamsArr[i]) {\n      found = true;\n    }\n  }\n\n  for (var i = 0; i < requiredParamsArr.length; i++) {\n    found = false;\n\n    this._each(paramObj, findParam);\n\n    if (!found) {\n      this.logError('Params are missing for bid request. One of these required paramaters are missing: ' + requiredParamsArr, adapter);\n      return false;\n    }\n  }\n\n  return true;\n};\n\n// Handle addEventListener gracefully in older browsers\nexports.addEventHandler = function (element, event, func) {\n  if (element.addEventListener) {\n    element.addEventListener(event, func, true);\n  } else if (element.attachEvent) {\n    element.attachEvent('on' + event, func);\n  }\n};\n/**\n * Return if the object is of the\n * given type.\n * @param {*} object to test\n * @param {String} _t type string (e.g., Array)\n * @return {Boolean} if object is of type _t\n */\nexports.isA = function (object, _t) {\n  return toString.call(object) === '[object ' + _t + ']';\n};\n\nexports.isFn = function (object) {\n  return this.isA(object, t_Fn);\n};\n\nexports.isStr = function (object) {\n  return this.isA(object, t_Str);\n};\n\nexports.isArray = function (object) {\n  return this.isA(object, t_Arr);\n};\n\nexports.isNumber = function(object) {\n  return this.isA(object, t_Numb);\n};\n\n/**\n * Return if the object is \"empty\";\n * this includes falsey, no keys, or no items at indices\n * @param {*} object object to test\n * @return {Boolean} if object is empty\n */\nexports.isEmpty = function (object) {\n  if (!object) return true;\n  if (this.isArray(object) || this.isStr(object)) {\n    return !(object.length > 0); // jshint ignore:line\n  }\n\n  for (var k in object) {\n    if (hasOwnProperty.call(object, k)) return false;\n  }\n\n  return true;\n};\n\n/**\n * Return if string is empty, null, or undefined\n * @param str string to test\n * @returns {boolean} if string is empty\n */\nexports.isEmptyStr = function(str) {\n  return this.isStr(str) && (!str || 0 === str.length);\n};\n\n/**\n * Iterate object with the function\n * falls back to es5 `forEach`\n * @param {Array|Object} object\n * @param {Function(value, key, object)} fn\n */\nexports._each = function (object, fn) {\n  if (this.isEmpty(object)) return;\n  if (this.isFn(object.forEach)) return object.forEach(fn, this);\n\n  var k = 0;\n  var l = object.length;\n\n  if (l > 0) {\n    for (; k < l; k++) fn(object[k], k, object);\n  } else {\n    for (k in object) {\n      if (hasOwnProperty.call(object, k)) fn.call(this, object[k], k);\n    }\n  }\n};\n\nexports.contains = function (a, obj) {\n  if (this.isEmpty(a)) {\n    return false;\n  }\n\n  if (this.isFn(a.indexOf)) {\n    return a.indexOf(obj) !== -1;\n  }\n\n  var i = a.length;\n  while (i--) {\n    if (a[i] === obj) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nexports.indexOf = (function () {\n  if (Array.prototype.indexOf) {\n    return Array.prototype.indexOf;\n  }\n\n  // ie8 no longer supported\n  //return polyfills.indexOf;\n}());\n\n/**\n * Map an array or object into another array\n * given a function\n * @param {Array|Object} object\n * @param {Function(value, key, object)} callback\n * @return {Array}\n */\nexports._map = function (object, callback) {\n  if (this.isEmpty(object)) return [];\n  if (this.isFn(object.map)) return object.map(callback);\n  var output = [];\n  this._each(object, function (value, key) {\n    output.push(callback(value, key, object));\n  });\n\n  return output;\n};\n\nvar hasOwn = function (objectToCheck, propertyToCheckFor) {\n  if (objectToCheck.hasOwnProperty) {\n    return objectToCheck.hasOwnProperty(propertyToCheckFor);\n  } else {\n    return (typeof objectToCheck[propertyToCheckFor] !== 'undefined') && (objectToCheck.constructor.prototype[propertyToCheckFor] !== objectToCheck[propertyToCheckFor]);\n  }\n};\n\nvar insertElement = function(elm) {\n  let elToAppend = document.getElementsByTagName('head');\n  try{\n    elToAppend = elToAppend.length ? elToAppend : document.getElementsByTagName('body');\n    if (elToAppend.length) {\n      elToAppend = elToAppend[0];\n      elToAppend.insertBefore(elm, elToAppend.firstChild);\n    }\n  } catch (e) {}\n};\n\nexports.insertPixel = function (url) {\n  const img = new Image();\n  img.id = this.getUniqueIdentifierStr();\n  img.src = url;\n  img.height = 0;\n  img.width = 0;\n  img.style.display = 'none';\n  img.onload = function() {\n    try {\n      this.parentNode.removeChild(this);\n    } catch(e) {\n    }\n  };\n  insertElement(img);\n};\n\n/**\n * Inserts empty iframe with the specified `url` for cookie sync\n * @param  {string} url URL to be requested\n * @param  {string} encodeUri boolean if URL should be encoded before inserted. Defaults to true\n */\nexports.insertCookieSyncIframe = function(url, encodeUri) {\n  let iframeHtml = this.createTrackPixelIframeHtml(url, encodeUri);\n  let div = document.createElement('div');\n  div.innerHTML = iframeHtml;\n  let iframe =  div.firstChild;\n  insertElement(iframe);\n};\n\n/**\n * Creates a snippet of HTML that retrieves the specified `url`\n * @param  {string} url URL to be requested\n * @return {string}     HTML snippet that contains the img src = set to `url`\n */\nexports.createTrackPixelHtml = function (url) {\n  if (!url) {\n    return '';\n  }\n\n  let escapedUrl = encodeURI(url);\n  let img = '<div style=\"position:absolute;left:0px;top:0px;visibility:hidden;\">';\n  img += '<img src=\"' + escapedUrl + '\"></div>';\n  return img;\n};\n\n/**\n * Creates a snippet of Iframe HTML that retrieves the specified `url`\n * @param  {string} url plain URL to be requested\n * @param  {string} encodeUri boolean if URL should be encoded before inserted. Defaults to true\n * @return {string}     HTML snippet that contains the iframe src = set to `url`\n */\nexports.createTrackPixelIframeHtml = function (url, encodeUri = true) {\n  if (!url) {\n    return '';\n  }\n  if(encodeUri) {\n    url = encodeURI(url);\n  }\n\n  return `<iframe frameborder=\"0\" allowtransparency=\"true\" marginheight=\"0\" marginwidth=\"0\" width=\"0\" hspace=\"0\" vspace=\"0\" height=\"0\" style=\"height:0p;width:0p;display:none;\" scrolling=\"no\" src=\"${url}\"></iframe>`;\n};\n\n/**\n * Returns iframe document in a browser agnostic way\n * @param  {object} iframe reference\n * @return {object}        iframe `document` reference\n */\nexports.getIframeDocument = function (iframe) {\n  if (!iframe) {\n    return;\n  }\n\n  let doc;\n  try {\n    if (iframe.contentWindow) {\n      doc = iframe.contentWindow.document;\n    } else if (iframe.contentDocument.document) {\n      doc = iframe.contentDocument.document;\n    } else {\n      doc = iframe.contentDocument;\n    }\n  }\n  catch (e) {\n    this.logError('Cannot get iframe document', e);\n  }\n\n  return doc;\n};\n\nexports.getValueString = function(param, val, defaultValue) {\n  if (val === undefined || val === null) {\n    return defaultValue;\n  }\n  if (this.isStr(val) ) {\n    return val;\n  }\n  if (this.isNumber(val)) {\n    return val.toString();\n  }\n  this.logWarn('Unsuported type for param: ' + param + ' required type: String');\n};\n\nexport function uniques(value, index, arry) {\n  return arry.indexOf(value) === index;\n}\n\nexport function flatten(a, b) {\n  return a.concat(b);\n}\n\nexport function getBidRequest(id) {\n  return pbjs._bidsRequested.map(bidSet => bidSet.bids.find(bid => bid.bidId === id)).find(bid => bid);\n}\n\nexport function getKeys(obj) {\n  return Object.keys(obj);\n}\n\nexport function getValue(obj, key) {\n  return obj[key];\n}\n\nexport function getBidderCodes(adUnits = pbjs.adUnits) {\n  // this could memoize adUnits\n  return adUnits.map(unit => unit.bids.map(bid => bid.bidder)\n    .reduce(flatten, [])).reduce(flatten).filter(uniques);\n}\n\nexport function isGptPubadsDefined() {\n  if (window.googletag && exports.isFn(window.googletag.pubads) && exports.isFn(window.googletag.pubads().getSlots)) {\n    return true;\n  }\n}\n\nexport function getHighestCpm(previous, current) {\n  if (previous.cpm === current.cpm) {\n    return previous.timeToRespond > current.timeToRespond ? current : previous;\n  }\n\n  return previous.cpm < current.cpm ? current : previous;\n}\n\n/**\n * Fisher–Yates shuffle\n * http://stackoverflow.com/a/6274398\n * https://bost.ocks.org/mike/shuffle/\n * istanbul ignore next\n */\nexport function shuffle(array) {\n  let counter = array.length;\n\n  // while there are elements in the array\n  while (counter > 0) {\n    // pick a random index\n    let index = Math.floor(Math.random() * counter);\n\n    // decrease counter by 1\n    counter--;\n\n    // and swap the last element with it\n    let temp = array[counter];\n    array[counter] = array[index];\n    array[index] = temp;\n  }\n\n  return array;\n}\n\nexport function adUnitsFilter(filter, bid) {\n  return filter.includes(bid && bid.placementCode || bid && bid.adUnitCode);\n}\n\n/**\n * Check if parent iframe of passed document supports content rendering via 'srcdoc' property\n * @param {HTMLDocument} doc document to check support of 'srcdoc'\n */\nexport function isSrcdocSupported(doc) {\n  //Firefox is excluded due to https://bugzilla.mozilla.org/show_bug.cgi?id=1265961\n  return doc.defaultView && doc.defaultView.frameElement &&\n    'srcdoc' in doc.defaultView.frameElement && !/firefox/i.test(navigator.userAgent);\n}\n\nexport function cloneJson(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nexport function inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\n\nexport function isSafariBrowser() {\n  return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n}\n\nexport function replaceAuctionPrice(str, cpm) {\n  if(!str) return;\n  return str.replace(/\\$\\{AUCTION_PRICE\\}/g, cpm);\n}\n\nexport function getBidderRequest(bidder, adUnitCode) {\n  return pbjs._bidsRequested.find(request => {\n    return request.bids\n        .filter(bid => bid.bidder === bidder && bid.placementCode === adUnitCode).length > 0;\n  }) || { start: null, requestId: null };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","module.exports = {\n\t\"JSON_MAPPING\": {\n\t\t\"PL_CODE\": \"code\",\n\t\t\"PL_SIZE\": \"sizes\",\n\t\t\"PL_BIDS\": \"bids\",\n\t\t\"BD_BIDDER\": \"bidder\",\n\t\t\"BD_ID\": \"paramsd\",\n\t\t\"BD_PL_ID\": \"placementId\",\n\t\t\"ADSERVER_TARGETING\": \"adserverTargeting\",\n\t\t\"BD_SETTING_STANDARD\": \"standard\"\n\t},\n\t\"REPO_AND_VERSION\": \"prebid_prebid_0.24.0-pre\",\n\t\"DEBUG_MODE\": \"pbjs_debug\",\n\t\"STATUS\": {\n\t\t\"GOOD\": 1,\n\t\t\"NO_BID\": 2\n\t},\n\t\"CB\": {\n\t\t\"TYPE\": {\n\t\t\t\"ALL_BIDS_BACK\": \"allRequestedBidsBack\",\n\t\t\t\"AD_UNIT_BIDS_BACK\": \"adUnitBidsBack\",\n\t\t\t\"BID_WON\": \"bidWon\",\n\t\t\t\"REQUEST_BIDS\": \"requestBids\"\n\t\t}\n\t},\n\t\"objectType_function\": \"function\",\n\t\"objectType_undefined\": \"undefined\",\n\t\"objectType_object\": \"object\",\n\t\"objectType_string\": \"string\",\n\t\"objectType_number\": \"number\",\n\t\"EVENTS\": {\n\t\t\"AUCTION_INIT\": \"auctionInit\",\n\t\t\"AUCTION_END\": \"auctionEnd\",\n\t\t\"BID_ADJUSTMENT\": \"bidAdjustment\",\n\t\t\"BID_TIMEOUT\": \"bidTimeout\",\n\t\t\"BID_REQUESTED\": \"bidRequested\",\n\t\t\"BID_RESPONSE\": \"bidResponse\",\n\t\t\"BID_WON\": \"bidWon\",\n\t\t\"SET_TARGETING\": \"setTargeting\",\n\t\t\"REQUEST_BIDS\": \"requestBids\"\n\t},\n\t\"EVENT_ID_PATHS\": {\n\t\t\"bidWon\": \"adUnitCode\"\n\t},\n\t\"ORDER\": {\n\t\t\"RANDOM\": \"random\"\n\t},\n\t\"GRANULARITY_OPTIONS\": {\n\t\t\"LOW\": \"low\",\n\t\t\"MEDIUM\": \"medium\",\n\t\t\"HIGH\": \"high\",\n\t\t\"AUTO\": \"auto\",\n\t\t\"DENSE\": \"dense\",\n\t\t\"CUSTOM\": \"custom\"\n\t},\n\t\"TARGETING_KEYS\": [\n\t\t\"hb_bidder\",\n\t\t\"hb_adid\",\n\t\t\"hb_pb\",\n\t\t\"hb_size\",\n\t\t\"hb_deal\"\n\t],\n\t\"S2S\": {\n\t\t\"DEFAULT_ENDPOINT\": \"https://prebid.adnxs.com/pbs/v1/auction\"\n\t}\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/constants.json\n// module id = 3\n// module chunks = 0","import { videoAdapters } from './adaptermanager';\n\n/**\n * Helper functions for working with video-enabled adUnits\n */\nexport const videoAdUnit = adUnit => adUnit.mediaType === 'video';\nconst nonVideoBidder = bid => !videoAdapters.includes(bid.bidder);\nexport const hasNonVideoBidder = adUnit => adUnit.bids.filter(nonVideoBidder).length;\n\n\n\n// WEBPACK FOOTER //\n// ./src/video.js","/** @module adaptermanger */\n\nimport { flatten, getBidderCodes, shuffle } from './utils';\nimport { mapSizes } from './sizeMapping';\n\nvar utils = require('./utils.js');\nvar CONSTANTS = require('./constants.json');\nvar events = require('./events');\nimport { BaseAdapter } from './adapters/baseAdapter';\n\nvar _bidderRegistry = {};\nexports.bidderRegistry = _bidderRegistry;\n\n//create s2s settings objectType_function\nlet _s2sConfig = {};\nvar _analyticsRegistry = {};\nlet _bidderSequence = null;\n\nfunction getBids({bidderCode, requestId, bidderRequestId, adUnits}) {\n  return adUnits.map(adUnit => {\n    return adUnit.bids.filter(bid => bid.bidder === bidderCode)\n      .map(bid => {\n        let sizes = adUnit.sizes;\n        if (adUnit.sizeMapping) {\n          let sizeMapping = mapSizes(adUnit);\n          if (sizeMapping === '') {\n            return '';\n          }\n          sizes = sizeMapping;\n        }\n        return Object.assign({}, bid, {\n          placementCode: adUnit.code,\n          mediaType: adUnit.mediaType,\n          transactionId : adUnit.transactionId,\n          sizes: sizes,\n          bidId: bid.bid_id || utils.getUniqueIdentifierStr(),\n          bidderRequestId,\n          requestId\n        });\n      }\n      );\n  }).reduce(flatten, []).filter(val => val !== '');\n}\n\nexports.callBids = ({adUnits, cbTimeout}) => {\n  const requestId = utils.generateUUID();\n  const auctionStart = Date.now();\n\n  const auctionInit = {\n    timestamp: auctionStart,\n    requestId,\n  };\n  events.emit(CONSTANTS.EVENTS.AUCTION_INIT, auctionInit);\n\n  let bidderCodes = getBidderCodes(adUnits);\n  if (_bidderSequence === CONSTANTS.ORDER.RANDOM) {\n    bidderCodes = shuffle(bidderCodes);\n  }\n\n  if(_s2sConfig.enabled) {\n    //these are called on the s2s adapter\n    let adaptersServerSide = _s2sConfig.bidders;\n\n    //don't call these client side\n    bidderCodes = bidderCodes.filter((elm) => {\n      return !adaptersServerSide.includes(elm);\n    });\n    let adUnitsCopy = utils.cloneJson(adUnits);\n\n    //filter out client side bids\n    adUnitsCopy.forEach((adUnit) => {\n      if (adUnit.sizeMapping) {\n        adUnit.sizes = mapSizes(adUnit);\n        delete adUnit.sizeMapping;\n      }\n      adUnit.sizes = transformHeightWidth(adUnit);\n      adUnit.bids = adUnit.bids.filter((bid) => {\n        return adaptersServerSide.includes(bid.bidder);\n      }).map((bid) => {\n        bid.bid_id = utils.getUniqueIdentifierStr();\n        return bid;\n      });\n    });\n\n    let tid = utils.generateUUID();\n    adaptersServerSide.forEach(bidderCode => {\n      const bidderRequestId = utils.getUniqueIdentifierStr();\n      const bidderRequest = {\n        bidderCode,\n        requestId,\n        bidderRequestId,\n        tid,\n        bids: getBids({bidderCode, requestId, bidderRequestId, 'adUnits' : adUnitsCopy}),\n        start: new Date().getTime(),\n        auctionStart: auctionStart,\n        timeout: _s2sConfig.timeout\n      };\n      //Pushing server side bidder\n      pbjs._bidsRequested.push(bidderRequest);\n    });\n\n    let s2sBidRequest = {tid, 'ad_units' : adUnitsCopy};\n    let s2sAdapter = _bidderRegistry[_s2sConfig.adapter]; //jshint ignore:line\n    utils.logMessage(`CALLING S2S HEADER BIDDERS ==== ${adaptersServerSide.join(',')}`);\n    s2sAdapter.setConfig(_s2sConfig);\n    s2sAdapter.callBids(s2sBidRequest);\n  }\n\n  bidderCodes.forEach(bidderCode => {\n    const adapter = _bidderRegistry[bidderCode];\n    if (adapter) {\n      const bidderRequestId = utils.getUniqueIdentifierStr();\n      const bidderRequest = {\n        bidderCode,\n        requestId,\n        bidderRequestId,\n        bids: getBids({bidderCode, requestId, bidderRequestId, adUnits}),\n        start: new Date().getTime(),\n        auctionStart: auctionStart,\n        timeout: cbTimeout\n      };\n      if (bidderRequest.bids && bidderRequest.bids.length !== 0) {\n        utils.logMessage(`CALLING BIDDER ======= ${bidderCode}`);\n        pbjs._bidsRequested.push(bidderRequest);\n        events.emit(CONSTANTS.EVENTS.BID_REQUESTED, bidderRequest);\n        adapter.callBids(bidderRequest);\n      }\n    } else {\n      utils.logError(`Adapter trying to be called which does not exist: ${bidderCode} adaptermanager.callBids`);\n    }\n  });\n};\n\n\nfunction transformHeightWidth(adUnit) {\n  let sizesObj = [];\n  let sizes = utils.parseSizesInput(adUnit.sizes);\n  sizes.forEach(size => {\n    let heightWidth = size.split('x');\n    let sizeObj = {\n      'w' : parseInt(heightWidth[0]),\n      'h' : parseInt(heightWidth[1])\n    };\n    sizesObj.push(sizeObj);\n  });\n  return sizesObj;\n}\n\nexports.registerBidAdapter = function (bidAdaptor, bidderCode) {\n  if (bidAdaptor && bidderCode) {\n\n    if (typeof bidAdaptor.callBids === CONSTANTS.objectType_function) {\n      _bidderRegistry[bidderCode] = bidAdaptor;\n\n    } else {\n      utils.logError('Bidder adaptor error for bidder code: ' + bidderCode + 'bidder must implement a callBids() function');\n    }\n\n  } else {\n    utils.logError('bidAdaptor or bidderCode not specified');\n  }\n};\n\nexports.aliasBidAdapter = function (bidderCode, alias) {\n  var existingAlias = _bidderRegistry[alias];\n\n  if (typeof existingAlias === CONSTANTS.objectType_undefined) {\n    var bidAdaptor = _bidderRegistry[bidderCode];\n\n    if (typeof bidAdaptor === CONSTANTS.objectType_undefined) {\n      utils.logError('bidderCode \"' + bidderCode + '\" is not an existing bidder.', 'adaptermanager.aliasBidAdapter');\n    } else {\n      try {\n        let newAdapter = null;\n        if (bidAdaptor instanceof BaseAdapter) {\n          //newAdapter = new bidAdaptor.constructor(alias);\n          utils.logError(bidderCode + ' bidder does not currently support aliasing.', 'adaptermanager.aliasBidAdapter');\n        } else {\n          newAdapter = bidAdaptor.createNew();\n          newAdapter.setBidderCode(alias);\n          this.registerBidAdapter(newAdapter, alias);\n        }\n      } catch (e) {\n        utils.logError(bidderCode + ' bidder does not currently support aliasing.', 'adaptermanager.aliasBidAdapter');\n      }\n    }\n  } else {\n    utils.logMessage('alias name \"' + alias + '\" has been already specified.');\n  }\n};\n\nexports.registerAnalyticsAdapter = function ({adapter, code}) {\n  if (adapter && code) {\n\n    if (typeof adapter.enableAnalytics === CONSTANTS.objectType_function) {\n      adapter.code = code;\n      _analyticsRegistry[code] = adapter;\n    } else {\n      utils.logError(`Prebid Error: Analytics adaptor error for analytics \"${code}\"\n        analytics adapter must implement an enableAnalytics() function`);\n    }\n  } else {\n    utils.logError('Prebid Error: analyticsAdapter or analyticsCode not specified');\n  }\n};\n\nexports.enableAnalytics = function (config) {\n  if (!utils.isArray(config)) {\n    config = [config];\n  }\n\n  utils._each(config, adapterConfig => {\n    var adapter = _analyticsRegistry[adapterConfig.provider];\n    if (adapter) {\n      adapter.enableAnalytics(adapterConfig);\n    } else {\n      utils.logError(`Prebid Error: no analytics adapter found in registry for\n        ${adapterConfig.provider}.`);\n    }\n  });\n};\n\nexports.setBidderSequence = function (order) {\n  _bidderSequence = order;\n};\n\nexports.setS2SConfig = function (config) {\n  _s2sConfig = config;\n};\n\nvar AardvarkAdapter = require('./adapters/aardvark.js');\n    exports.registerBidAdapter(new AardvarkAdapter(), 'aardvark');\nvar AdbladeAdapter = require('./adapters/adblade.js');\n    exports.registerBidAdapter(new AdbladeAdapter(), 'adblade');\nvar AdbundAdapter = require('./adapters/adbund.js');\n    exports.registerBidAdapter(new AdbundAdapter(), 'adbund');\nvar AdbutlerAdapter = require('./adapters/adbutler.js');\n    exports.registerBidAdapter(new AdbutlerAdapter(), 'adbutler');\nvar AdequantAdapter = require('./adapters/adequant.js');\n    exports.registerBidAdapter(new AdequantAdapter(), 'adequant');\nvar AdformAdapter = require('./adapters/adform.js');\n    exports.registerBidAdapter(new AdformAdapter(), 'adform');\nvar AdkernelAdapter = require('./adapters/adkernel.js');\n    exports.registerBidAdapter(new AdkernelAdapter(), 'adkernel');\nvar AdmediaAdapter = require('./adapters/admedia.js');\n    exports.registerBidAdapter(new AdmediaAdapter(), 'admedia');\nvar BidfluenceAdapter = require('./adapters/bidfluence.js');\n    exports.registerBidAdapter(new BidfluenceAdapter(), 'bidfluence');\nvar VertamediaAdapter = require('./adapters/vertamedia.js');\n    exports.registerBidAdapter(new VertamediaAdapter(), 'vertamedia');\nvar AolAdapter = require('./adapters/aol.js');\n    exports.registerBidAdapter(new AolAdapter(), 'aol');\nvar AppnexusAdapter = require('./adapters/appnexus.js');\n    exports.registerBidAdapter(new AppnexusAdapter(), 'appnexus');\nvar AppnexusAstAdapter = require('./adapters/appnexusAst.js');\n    exports.registerBidAdapter(new AppnexusAstAdapter(), 'appnexusAst');\nvar BeachfrontAdapter = require('./adapters/beachfront.js');\n    exports.registerBidAdapter(new BeachfrontAdapter(), 'beachfront');\nvar AudienceNetworkAdapter = require('./adapters/audienceNetwork.js');\n    exports.registerBidAdapter(new AudienceNetworkAdapter(), 'audienceNetwork');\nvar ConversantAdapter = require('./adapters/conversant.js');\n    exports.registerBidAdapter(new ConversantAdapter(), 'conversant');\nvar DistrictmDMXAdapter = require('./adapters/districtmDMX.js');\n    exports.registerBidAdapter(new DistrictmDMXAdapter(), 'districtmDMX');\nvar FidelityAdapter = require('./adapters/fidelity.js');\n    exports.registerBidAdapter(new FidelityAdapter(), 'fidelity');\nvar GumgumAdapter = require('./adapters/gumgum.js');\n    exports.registerBidAdapter(new GumgumAdapter(), 'gumgum');\nvar HiromediaAdapter = require('./adapters/hiromedia.js');\n    exports.registerBidAdapter(new HiromediaAdapter(), 'hiromedia');\nvar IndexExchangeAdapter = require('./adapters/indexExchange.js');\n    exports.registerBidAdapter(new IndexExchangeAdapter(), 'indexExchange');\nvar InnityAdapter = require('./adapters/innity.js');\n    exports.registerBidAdapter(new InnityAdapter(), 'innity');\nvar KruxlinkAdapter = require('./adapters/kruxlink.js');\n    exports.registerBidAdapter(new KruxlinkAdapter(), 'kruxlink');\nvar GetintentAdapter = require('./adapters/getintent.js');\n    exports.registerBidAdapter(new GetintentAdapter(), 'getintent');\nvar InneractiveAdapter = require('./adapters/inneractive.js');\n    exports.registerBidAdapter(new InneractiveAdapter(), 'inneractive');\nvar KomoonaAdapter = require('./adapters/komoona.js');\n    exports.registerBidAdapter(new KomoonaAdapter(), 'komoona');\nvar LifestreetAdapter = require('./adapters/lifestreet.js');\n    exports.registerBidAdapter(new LifestreetAdapter(), 'lifestreet');\nvar MantisAdapter = require('./adapters/mantis.js');\n    exports.registerBidAdapter(new MantisAdapter(), 'mantis');\nvar OpenxAdapter = require('./adapters/openx.js');\n    exports.registerBidAdapter(new OpenxAdapter(), 'openx');\nvar PiximediaAdapter = require('./adapters/piximedia.js');\n    exports.registerBidAdapter(new PiximediaAdapter(), 'piximedia');\nvar PubmaticAdapter = require('./adapters/pubmatic.js');\n    exports.registerBidAdapter(new PubmaticAdapter(), 'pubmatic');\nvar PubgearsAdapter = require('./adapters/pubgears.js');\n    exports.registerBidAdapter(new PubgearsAdapter(), 'pubgears');\nvar PulsepointAdapter = require('./adapters/pulsepoint.js');\n    exports.registerBidAdapter(new PulsepointAdapter(), 'pulsepoint');\nvar PulsepointLiteAdapter = require('./adapters/pulsepointLite.js');\n    exports.registerBidAdapter(new PulsepointLiteAdapter(), 'pulsepointLite');\nvar QuantcastAdapter = require('./adapters/quantcast.js');\n    exports.registerBidAdapter(new QuantcastAdapter(), 'quantcast');\nvar RhythmoneAdapter = require('./adapters/rhythmone.js');\n    exports.registerBidAdapter(new RhythmoneAdapter(), 'rhythmone');\nvar RubiconAdapter = require('./adapters/rubicon.js');\n    exports.registerBidAdapter(new RubiconAdapter(), 'rubicon');\nvar SmartyadsAdapter = require('./adapters/smartyads.js');\n    exports.registerBidAdapter(new SmartyadsAdapter(), 'smartyads');\nvar HuddledmassesAdapter = require('./adapters/huddledmasses.js');\n    exports.registerBidAdapter(new HuddledmassesAdapter(), 'huddledmasses');\nvar SmartadserverAdapter = require('./adapters/smartadserver.js');\n    exports.registerBidAdapter(new SmartadserverAdapter(), 'smartadserver');\nvar SekindoUMAdapter = require('./adapters/sekindoUM.js');\n    exports.registerBidAdapter(new SekindoUMAdapter(), 'sekindoUM');\nvar ServerbidAdapter = require('./adapters/serverbid.js');\n    exports.registerBidAdapter(new ServerbidAdapter(), 'serverbid');\nvar SonobiAdapter = require('./adapters/sonobi.js');\n    exports.registerBidAdapter(new SonobiAdapter(), 'sonobi');\nvar SovrnAdapter = require('./adapters/sovrn.js');\n    exports.registerBidAdapter(new SovrnAdapter(), 'sovrn');\nvar SpringserveAdapter = require('./adapters/springserve.js');\n    exports.registerBidAdapter(new SpringserveAdapter(), 'springserve');\nvar ThoughtleadrAdapter = require('./adapters/thoughtleadr.js');\n    exports.registerBidAdapter(new ThoughtleadrAdapter(), 'thoughtleadr');\nvar StickyadstvAdapter = require('./adapters/stickyadstv.js');\n    exports.registerBidAdapter(new StickyadstvAdapter(), 'stickyadstv');\nvar TripleliftAdapter = require('./adapters/triplelift.js');\n    exports.registerBidAdapter(new TripleliftAdapter(), 'triplelift');\nvar TwengaAdapter = require('./adapters/twenga.js');\n    exports.registerBidAdapter(new TwengaAdapter(), 'twenga');\nvar YieldbotAdapter = require('./adapters/yieldbot.js');\n    exports.registerBidAdapter(new YieldbotAdapter(), 'yieldbot');\nvar NginadAdapter = require('./adapters/nginad.js');\n    exports.registerBidAdapter(new NginadAdapter(), 'nginad');\nvar BrightcomAdapter = require('./adapters/brightcom.js');\n    exports.registerBidAdapter(new BrightcomAdapter(), 'brightcom');\nvar WideorbitAdapter = require('./adapters/wideorbit.js');\n    exports.registerBidAdapter(new WideorbitAdapter(), 'wideorbit');\nvar JcmAdapter = require('./adapters/jcm.js');\n    exports.registerBidAdapter(new JcmAdapter(), 'jcm');\nvar UnderdogmediaAdapter = require('./adapters/underdogmedia.js');\n    exports.registerBidAdapter(new UnderdogmediaAdapter(), 'underdogmedia');\nvar MemeglobalAdapter = require('./adapters/memeglobal.js');\n    exports.registerBidAdapter(new MemeglobalAdapter(), 'memeglobal');\nvar CriteoAdapter = require('./adapters/criteo.js');\n    exports.registerBidAdapter(new CriteoAdapter(), 'criteo');\nvar CentroAdapter = require('./adapters/centro.js');\n    exports.registerBidAdapter(new CentroAdapter(), 'centro');\nvar XhbAdapter = require('./adapters/xhb.js');\n    exports.registerBidAdapter(new XhbAdapter(), 'xhb');\nvar SharethroughAdapter = require('./adapters/sharethrough.js');\n    exports.registerBidAdapter(new SharethroughAdapter(), 'sharethrough');\nvar RoxotAdapter = require('./adapters/roxot.js');\n    exports.registerBidAdapter(new RoxotAdapter(), 'roxot');\nvar VertozAdapter = require('./adapters/vertoz.js');\n    exports.registerBidAdapter(new VertozAdapter(), 'vertoz');\nvar WidespaceAdapter = require('./adapters/widespace.js');\n    exports.registerBidAdapter(new WidespaceAdapter(), 'widespace');\nvar AdmixerAdapter = require('./adapters/admixer.js');\n    exports.registerBidAdapter(new AdmixerAdapter(), 'admixer');\nvar AtomxAdapter = require('./adapters/atomx.js');\n    exports.registerBidAdapter(new AtomxAdapter(), 'atomx');\nvar TapsenseAdapter = require('./adapters/tapsense.js');\n    exports.registerBidAdapter(new TapsenseAdapter(), 'tapsense');\nvar TrionAdapter = require('./adapters/trion.js');\n    exports.registerBidAdapter(new TrionAdapter(), 'trion');\nvar PrebidServerAdapter = require('./adapters/prebidServer.js');\n    exports.registerBidAdapter(new PrebidServerAdapter(), 'prebidServer');\nvar AdsupplyAdapter = require('./adapters/adsupply.js');\n    exports.registerBidAdapter(new AdsupplyAdapter(), 'adsupply');\nexports.aliasBidAdapter('appnexus','brealtime');\nexports.aliasBidAdapter('appnexus','pagescience');\nexports.aliasBidAdapter('appnexus','defymedia');\nexports.aliasBidAdapter('appnexus','gourmetads');\nexports.aliasBidAdapter('appnexus','matomy');\nexports.aliasBidAdapter('rubicon','rubiconLite');\nexports.aliasBidAdapter('appnexus','featureforward');\nexports.aliasBidAdapter('appnexus','oftmedia');\nexports.aliasBidAdapter('adkernel','headbidding');\nexports.aliasBidAdapter('stickyadstv','freewheel-ssp');\nexports.videoAdapters = [\"appnexusAst\",\"vertamedia\",\"beachfront\",\"rubicon\",\"getintent\",\"rhythmone\"];\n\nnull\n\n\n\n// WEBPACK FOOTER //\n// ./src/adaptermanager.js","/**\n * @module sizeMapping\n */\nimport * as utils from './utils';\nlet _win;\n\nfunction mapSizes(adUnit) {\n  if(!isSizeMappingValid(adUnit.sizeMapping)){\n    return adUnit.sizes;\n  }\n  const width = getScreenWidth();\n  if(!width) {\n    //size not detected - get largest value set for desktop\n    const mapping = adUnit.sizeMapping.reduce((prev, curr) => {\n      return prev.minWidth < curr.minWidth ? curr : prev;\n    });\n    if(mapping.sizes && mapping.sizes.length) {\n      return mapping.sizes;\n    }\n    return adUnit.sizes;\n  }\n  let sizes = '';\n  const mapping = adUnit.sizeMapping.find(sizeMapping =>{\n    return width > sizeMapping.minWidth;\n  });\n  if(mapping && mapping.sizes && mapping.sizes.length){\n    sizes = mapping.sizes;\n    utils.logMessage(`AdUnit : ${adUnit.code} resized based on device width to : ${sizes}`);\n  }\n  else{\n    utils.logMessage(`AdUnit : ${adUnit.code} not mapped to any sizes for device width. This request will be suppressed.`);\n  }\n  return sizes;\n\n}\n\nfunction isSizeMappingValid(sizeMapping) {\n  if(utils.isArray(sizeMapping) && sizeMapping.length > 0){\n    return true;\n  }\n  utils.logInfo('No size mapping defined');\n  return false;\n}\n\nfunction getScreenWidth(win) {\n  var w = win || _win || window;\n  var d = w.document;\n\n  if (w.innerWidth) {\n    return w.innerWidth;\n  }\n  else if (d.body.clientWidth) {\n    return d.body.clientWidth;\n  }\n  else if (d.documentElement.clientWidth) {\n    return d.documentElement.clientWidth;\n  }\n  return 0;\n}\n\nfunction setWindow(win) {\n  _win = win;\n}\n\nexport { mapSizes, getScreenWidth, setWindow };\n\n\n\n// WEBPACK FOOTER //\n// ./src/sizeMapping.js","export class BaseAdapter {\n  constructor(code) {\n    this.code = code;\n  }\n\n  getCode() {\n    return this.code;\n  }\n\n  setCode(code) {\n    this.code = code;\n  }\n\n  callBids() {\n    throw 'adapter implementation must override callBids method';\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/baseAdapter.js","/**\n * events.js\n */\nvar utils = require('./utils');\nvar CONSTANTS = require('./constants');\nvar slice = Array.prototype.slice;\nvar push = Array.prototype.push;\n\n//define entire events\n//var allEvents = ['bidRequested','bidResponse','bidWon','bidTimeout'];\nvar allEvents = utils._map(CONSTANTS.EVENTS, function (v) {\n  return v;\n});\n\nvar idPaths = CONSTANTS.EVENT_ID_PATHS;\n\n//keep a record of all events fired\nvar eventsFired = [];\n\nmodule.exports = (function () {\n\n  var _handlers = {};\n  var _public = {};\n\n  /**\n   *\n   * @param {String} eventString  The name of the event.\n   * @param {Array} args  The payload emitted with the event.\n   * @private\n   */\n  function _dispatch(eventString, args) {\n    utils.logMessage('Emitting event for: ' + eventString);\n\n    var eventPayload = args[0] || {};\n    var idPath = idPaths[eventString];\n    var key = eventPayload[idPath];\n    var event = _handlers[eventString] || { que: [] };\n    var eventKeys = utils._map(event, function (v, k) {\n      return k;\n    });\n\n    var callbacks = [];\n\n    //record the event:\n    eventsFired.push({\n      eventType: eventString,\n      args: eventPayload,\n      id: key\n    });\n\n    /** Push each specific callback to the `callbacks` array.\n     * If the `event` map has a key that matches the value of the\n     * event payload id path, e.g. `eventPayload[idPath]`, then apply\n     * each function in the `que` array as an argument to push to the\n     * `callbacks` array\n     * */\n    if (key && utils.contains(eventKeys, key)) {\n      push.apply(callbacks, event[key].que);\n    }\n\n    /** Push each general callback to the `callbacks` array. */\n    push.apply(callbacks, event.que);\n\n    /** call each of the callbacks */\n    utils._each(callbacks, function (fn) {\n      if (!fn) return;\n      try {\n        fn.apply(null, args);\n      }\n      catch (e) {\n        utils.logError('Error executing handler:', 'events.js', e);\n      }\n    });\n  }\n\n  function _checkAvailableEvent(event) {\n    return utils.contains(allEvents, event);\n  }\n\n  _public.on = function (eventString, handler, id) {\n\n    //check whether available event or not\n    if (_checkAvailableEvent(eventString)) {\n      var event = _handlers[eventString] || { que: [] };\n\n      if (id) {\n        event[id] = event[id] || { que: [] };\n        event[id].que.push(handler);\n      } else {\n        event.que.push(handler);\n      }\n\n      _handlers[eventString] = event;\n    } else {\n      utils.logError('Wrong event name : ' + eventString + ' Valid event names :' + allEvents);\n    }\n  };\n\n  _public.emit = function (event) {\n    var args = slice.call(arguments, 1);\n    _dispatch(event, args);\n  };\n\n  _public.off = function (eventString, handler, id) {\n    var event = _handlers[eventString];\n\n    if (utils.isEmpty(event) || utils.isEmpty(event.que) && utils.isEmpty(event[id])) {\n      return;\n    }\n\n    if (id && (utils.isEmpty(event[id]) || utils.isEmpty(event[id].que))) {\n      return;\n    }\n\n    if (id) {\n      utils._each(event[id].que, function (_handler) {\n        var que = event[id].que;\n        if (_handler === handler) {\n          que.splice(utils.indexOf.call(que, _handler), 1);\n        }\n      });\n    } else {\n      utils._each(event.que, function (_handler) {\n        var que = event.que;\n        if (_handler === handler) {\n          que.splice(utils.indexOf.call(que, _handler), 1);\n        }\n      });\n    }\n\n    _handlers[eventString] = event;\n  };\n\n  _public.get = function () {\n    return _handlers;\n  };\n\n  /**\n   * This method can return a copy of all the events fired\n   * @return {Array} array of events fired\n   */\n  _public.getEvents = function () {\n    var arrayCopy = [];\n    utils._each(eventsFired, function (value) {\n      var newProp = Object.assign({}, value);\n      arrayCopy.push(newProp);\n    });\n\n    return arrayCopy;\n  };\n\n  return _public;\n}());\n\n\n\n// WEBPACK FOOTER //\n// ./src/events.js","/*\n * Adapter for requesting bids from RTK Aardvark\n * To request an RTK Aardvark Header bidding account\n * or for additional integration support please contact sales@rtk.io\n */\n\nvar utils      = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader   = require('../adloader.js');\nvar adapter    = require('./adapter.js');\nvar constants  = require('../constants.json');\n\nvar AARDVARK_CALLBACK_NAME = 'aardvarkResponse',\n    AARDVARK_REQUESTS_MAP  = 'aardvarkRequests',\n    AARDVARK_BIDDER_CODE   = 'aardvark',\n    DEFAULT_REFERRER       = 'thor.rtk.io',\n    DEFAULT_ENDPOINT       = 'thor.rtk.io',\n\n    endpoint               = DEFAULT_ENDPOINT,\n\n    requestBids = function(bidderCode, callbackName, bidReqs) {\n      var ref    = utils.getTopWindowLocation(),\n          ai     = '',\n          scs    = [],\n          bidIds = [];\n\n      ref = ref ? ref.host : DEFAULT_REFERRER;\n\n      for (var i = 0, l = bidReqs.length, bid, _ai, _sc, _endpoint; i < l; i += 1) {\n        bid = bidReqs[i];\n        _ai = utils.getBidIdParameter('ai', bid.params);\n        _sc = utils.getBidIdParameter('sc', bid.params);\n        if (!_ai || !_ai.length || !_sc || !_sc.length)\n          continue;\n\n        _endpoint = utils.getBidIdParameter('host', bid.params);\n        if (_endpoint)\n          endpoint = _endpoint;\n\n        if (!ai.length)\n          ai = _ai;\n        if (_sc)\n          scs.push(_sc);\n\n        bidIds.push(_sc + \"=\" + bid.bidId);\n\n        // Create the bidIdsMap for easier mapping back later\n        pbjs[AARDVARK_REQUESTS_MAP][bidderCode][bid.bidId] = bid;\n      }\n\n      if (!ai.length || !scs.length)\n        return utils.logWarn(\"Bad bid request params given for adapter $\" + bidderCode + \" (\" + AARDVARK_BIDDER_CODE + \")\");\n\n      adloader.loadScript([\n        '//' + endpoint + '/', ai, '/', scs.join('_'),\n        '/aardvark/?jsonp=pbjs.', callbackName,\n        '&rtkreferer=', ref, '&', bidIds.join('&')\n      ].join(''));\n    },\n\n\n\n    registerBidResponse = function(bidderCode, rawBidResponse) {\n      if (rawBidResponse.error)\n        return utils.logWarn(\"Aardvark bid received with an error, ignoring... [\" + rawBidResponse.error + \"]\");\n\n      if (!rawBidResponse.cid)\n        return utils.logWarn(\"Aardvark bid received without a callback id, ignoring...\");\n\n      var bidObj = pbjs[AARDVARK_REQUESTS_MAP][bidderCode][rawBidResponse.cid];\n      if (!bidObj)\n        return utils.logWarn(\"Aardvark request not found: \" + rawBidResponse.cid);\n\n      if (bidObj.params.sc !== rawBidResponse.id)\n        return utils.logWarn(\"Aardvark bid received with a non matching shortcode \" + rawBidResponse.id + \" instead of \" + bidObj.params.sc);\n\n      var bidResponse = bidfactory.createBid(constants.STATUS.GOOD, bidObj);\n      bidResponse.bidderCode = bidObj.bidder;\n      bidResponse.cpm        = rawBidResponse.cpm;\n      bidResponse.ad         = rawBidResponse.adm + utils.createTrackPixelHtml(decodeURIComponent(rawBidResponse.nurl));\n      bidResponse.width      = bidObj.sizes[0][0];\n      bidResponse.height     = bidObj.sizes[0][1];\n\n      bidmanager.addBidResponse(bidObj.placementCode, bidResponse);\n      pbjs[AARDVARK_REQUESTS_MAP][bidderCode][rawBidResponse.cid].responded = true;\n    },\n\n\n\n    registerAardvarkCallback = function(bidderCode, callbackName) {\n      pbjs[callbackName] = function(rtkResponseObj) {\n\n        rtkResponseObj.forEach(function(bidResponse) {\n          registerBidResponse(bidderCode, bidResponse);\n        });\n\n        for (var bidRequestId in pbjs[AARDVARK_REQUESTS_MAP][bidderCode])\n          if (pbjs[AARDVARK_REQUESTS_MAP][bidderCode].hasOwnProperty(bidRequestId)) {\n            var bidRequest = pbjs[AARDVARK_REQUESTS_MAP][bidderCode][bidRequestId];\n            if (!bidRequest.responded) {\n              var bidResponse = bidfactory.createBid(constants.STATUS.NO_BID, bidRequest);\n              bidResponse.bidderCode = bidRequest.bidder;\n              bidmanager.addBidResponse(bidRequest.placementCode, bidResponse);\n            }\n          }\n      };\n    },\n\n\n\n    AardvarkAdapter = function() {\n      var baseAdapter = adapter.createNew(AARDVARK_BIDDER_CODE);\n\n      pbjs[AARDVARK_REQUESTS_MAP] = pbjs[AARDVARK_REQUESTS_MAP] || {};\n\n      baseAdapter.callBids = function (params) {\n        var bidderCode   = baseAdapter.getBidderCode(),\n            callbackName = AARDVARK_CALLBACK_NAME;\n\n        if (bidderCode !== AARDVARK_BIDDER_CODE)\n          callbackName = [AARDVARK_CALLBACK_NAME, bidderCode].join('_');\n\n        pbjs[AARDVARK_REQUESTS_MAP][bidderCode] = {};\n\n        registerAardvarkCallback(bidderCode, callbackName);\n\n        return requestBids(bidderCode, callbackName, params.bids || []);\n      };\n\n      return {\n        callBids:      baseAdapter.callBids,\n        setBidderCode: baseAdapter.setBidderCode,\n        createNew:     exports.createNew\n      };\n    };\n\n\n\nexports.createNew = function() {\n  return new AardvarkAdapter();\n};\n\nmodule.exports = AardvarkAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/aardvark.js","var utils = require('./utils.js');\n\n/**\n Required paramaters\n bidderCode,\n height,\n width,\n statusCode\n Optional paramaters\n adId,\n cpm,\n ad,\n adUrl,\n dealId,\n priceKeyString;\n */\nfunction Bid(statusCode, bidRequest) {\n  var _bidId = bidRequest && bidRequest.bidId || utils.getUniqueIdentifierStr();\n  var _statusCode = statusCode || 0;\n\n  this.bidderCode = '';\n  this.width = 0;\n  this.height = 0;\n  this.statusMessage = _getStatus();\n  this.adId = _bidId;\n\n  function _getStatus() {\n    switch (_statusCode) {\n      case 0:\n        return 'Pending';\n      case 1:\n        return 'Bid available';\n      case 2:\n        return 'Bid returned empty or error response';\n      case 3:\n        return 'Bid timed out';\n    }\n  }\n\n  this.getStatusCode = function () {\n    return _statusCode;\n  };\n\n  //returns the size of the bid creative. Concatenation of width and height by ‘x’.\n  this.getSize = function () {\n    return this.width + 'x' + this.height;\n  };\n\n}\n\n// Bid factory function.\nexports.createBid = function () {\n  return new Bid(...arguments);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/bidfactory.js","import { uniques, flatten, adUnitsFilter, getBidderRequest } from './utils';\nimport {getPriceBucketString} from './cpmBucketManager';\n\nvar CONSTANTS = require('./constants.json');\nvar AUCTION_END = CONSTANTS.EVENTS.AUCTION_END;\nvar utils = require('./utils.js');\nvar events = require('./events');\n\nvar objectType_function = 'function';\n\nvar externalCallbacks = {byAdUnit: [], all: [], oneTime: null, timer: false};\nvar _granularity = CONSTANTS.GRANULARITY_OPTIONS.MEDIUM;\nlet _customPriceBucket;\nvar defaultBidderSettingsMap = {};\n\nexports.setCustomPriceBucket = function(customConfig) {\n  _customPriceBucket = customConfig;\n};\n\n/**\n * Returns a list of bidders that we haven't received a response yet\n * @return {array} [description]\n */\nexports.getTimedOutBidders = function () {\n  return pbjs._bidsRequested\n    .map(getBidderCode)\n    .filter(uniques)\n    .filter(bidder => pbjs._bidsReceived\n      .map(getBidders)\n      .filter(uniques)\n      .indexOf(bidder) < 0);\n};\n\nfunction timestamp() { return new Date().getTime(); }\n\nfunction getBidderCode(bidSet) {\n  return bidSet.bidderCode;\n}\n\nfunction getBidders(bid) {\n  return bid.bidder;\n}\n\nfunction bidsBackAdUnit(adUnitCode) {\n  const requested = pbjs._bidsRequested\n    .map(request => request.bids\n      .filter(adUnitsFilter.bind(this, pbjs._adUnitCodes))\n      .filter(bid => bid.placementCode === adUnitCode))\n    .reduce(flatten, [])\n    .map(bid => {\n      return bid.bidder === 'indexExchange' ?\n          bid.sizes.length :\n          1;\n    }).reduce(add, 0);\n\n  const received = pbjs._bidsReceived.filter(bid => bid.adUnitCode === adUnitCode).length;\n  return requested === received;\n}\n\nfunction add(a, b) {\n  return a + b;\n}\n\nfunction bidsBackAll() {\n  const requested = pbjs._bidsRequested\n    .map(request => request.bids)\n    .reduce(flatten, [])\n    .filter(adUnitsFilter.bind(this, pbjs._adUnitCodes))\n    .map(bid => {\n      return bid.bidder === 'indexExchange' ?\n        bid.sizes.length :\n        1;\n    }).reduce((a, b) => a + b, 0);\n\n  const received = pbjs._bidsReceived\n    .filter(adUnitsFilter.bind(this, pbjs._adUnitCodes)).length;\n\n  return requested === received;\n}\n\nexports.bidsBackAll = function () {\n  return bidsBackAll();\n};\n\n/*\n *   This function should be called to by the bidder adapter to register a bid response\n */\nexports.addBidResponse = function (adUnitCode, bid) {\n  if (!adUnitCode) {\n    utils.logWarn('No adUnitCode supplied to addBidResponse, response discarded');\n    return;\n  }\n\n  if (bid) {\n\n    const { requestId, start } = getBidderRequest(bid.bidderCode, adUnitCode);\n    Object.assign(bid, {\n      requestId: requestId,\n      responseTimestamp: timestamp(),\n      requestTimestamp: start,\n      cpm: parseFloat(bid.cpm) || 0,\n      bidder: bid.bidderCode,\n      adUnitCode\n    });\n\n    bid.timeToRespond = bid.responseTimestamp - bid.requestTimestamp;\n\n    if (bid.timeToRespond > pbjs.cbTimeout + pbjs.timeoutBuffer) {\n      const timedOut = true;\n\n      exports.executeCallback(timedOut);\n    }\n\n    //emit the bidAdjustment event before bidResponse, so bid response has the adjusted bid value\n    events.emit(CONSTANTS.EVENTS.BID_ADJUSTMENT, bid);\n\n    //emit the bidResponse event\n    events.emit(CONSTANTS.EVENTS.BID_RESPONSE, bid);\n\n    //append price strings\n    const priceStringsObj = getPriceBucketString(bid.cpm, _customPriceBucket);\n    bid.pbLg = priceStringsObj.low;\n    bid.pbMg = priceStringsObj.med;\n    bid.pbHg = priceStringsObj.high;\n    bid.pbAg = priceStringsObj.auto;\n    bid.pbDg = priceStringsObj.dense;\n    bid.pbCg = priceStringsObj.custom;\n\n    //if there is any key value pairs to map do here\n    var keyValues = {};\n    if (bid.bidderCode && (bid.cpm > 0 || bid.dealId ) ) {\n      keyValues = getKeyValueTargetingPairs(bid.bidderCode, bid);\n    }\n\n    bid.adserverTargeting = keyValues;\n    pbjs._bidsReceived.push(bid);\n  }\n\n  if (bid && bid.adUnitCode && bidsBackAdUnit(bid.adUnitCode)) {\n    triggerAdUnitCallbacks(bid.adUnitCode);\n  }\n\n  if (bidsBackAll()) {\n    exports.executeCallback();\n  }\n};\n\nfunction getKeyValueTargetingPairs(bidderCode, custBidObj) {\n  var keyValues = {};\n  var bidder_settings = pbjs.bidderSettings;\n\n  //1) set the keys from \"standard\" setting or from prebid defaults\n  if (custBidObj && bidder_settings) {\n    //initialize default if not set\n    const standardSettings = getStandardBidderSettings();\n    setKeys(keyValues, standardSettings, custBidObj);\n  }\n\n  //2) set keys from specific bidder setting override if they exist\n  if (bidderCode && custBidObj && bidder_settings && bidder_settings[bidderCode] && bidder_settings[bidderCode][CONSTANTS.JSON_MAPPING.ADSERVER_TARGETING]) {\n    setKeys(keyValues, bidder_settings[bidderCode], custBidObj);\n    custBidObj.alwaysUseBid = bidder_settings[bidderCode].alwaysUseBid;\n    custBidObj.sendStandardTargeting = bidder_settings[bidderCode].sendStandardTargeting;\n  }\n\n  //2) set keys from standard setting. NOTE: this API doesn't seem to be in use by any Adapter\n  else if (defaultBidderSettingsMap[bidderCode]) {\n    setKeys(keyValues, defaultBidderSettingsMap[bidderCode], custBidObj);\n    custBidObj.alwaysUseBid = defaultBidderSettingsMap[bidderCode].alwaysUseBid;\n    custBidObj.sendStandardTargeting = defaultBidderSettingsMap[bidderCode].sendStandardTargeting;\n  }\n\n  return keyValues;\n}\n\nexports.getKeyValueTargetingPairs = function() {\n  return getKeyValueTargetingPairs(...arguments);\n};\n\nfunction setKeys(keyValues, bidderSettings, custBidObj) {\n  var targeting = bidderSettings[CONSTANTS.JSON_MAPPING.ADSERVER_TARGETING];\n  custBidObj.size = custBidObj.getSize();\n\n  utils._each(targeting, function (kvPair) {\n    var key = kvPair.key;\n    var value = kvPair.val;\n\n    if (keyValues[key]) {\n      utils.logWarn('The key: ' + key + ' is getting ovewritten');\n    }\n\n    if (utils.isFn(value)) {\n      try {\n        value = value(custBidObj);\n      } catch (e) {\n        utils.logError('bidmanager', 'ERROR', e);\n      }\n    }\n\n    if (\n      (typeof bidderSettings.suppressEmptyKeys !== \"undefined\" && bidderSettings.suppressEmptyKeys === true ||\n      key === \"hb_deal\") && // hb_deal is suppressed automatically if not set\n      (\n        utils.isEmptyStr(value) ||\n        value === null ||\n        value === undefined\n      )\n    ) {\n      utils.logInfo(\"suppressing empty key '\" + key + \"' from adserver targeting\");\n    } else {\n      keyValues[key] = value;\n    }\n\n  });\n\n  return keyValues;\n}\n\nexports.setPriceGranularity = function setPriceGranularity(granularity) {\n  var granularityOptions = CONSTANTS.GRANULARITY_OPTIONS;\n  if (Object.keys(granularityOptions).filter(option => granularity === granularityOptions[option])) {\n    _granularity = granularity;\n  } else {\n    utils.logWarn('Prebid Warning: setPriceGranularity was called with invalid setting, using' +\n      ' `medium` as default.');\n    _granularity = CONSTANTS.GRANULARITY_OPTIONS.MEDIUM;\n  }\n};\n\nexports.registerDefaultBidderSetting = function (bidderCode, defaultSetting) {\n  defaultBidderSettingsMap[bidderCode] = defaultSetting;\n};\n\nexports.executeCallback = function (timedOut) {\n  // if there's still a timeout running, clear it now\n  if (!timedOut && externalCallbacks.timer) {\n    clearTimeout(externalCallbacks.timer);\n  }\n\n  if (externalCallbacks.all.called !== true) {\n    processCallbacks(externalCallbacks.all);\n    externalCallbacks.all.called = true;\n\n    if (timedOut) {\n      const timedOutBidders = exports.getTimedOutBidders();\n\n      if (timedOutBidders.length) {\n        events.emit(CONSTANTS.EVENTS.BID_TIMEOUT, timedOutBidders);\n      }\n    }\n  }\n\n  //execute one time callback\n  if (externalCallbacks.oneTime) {\n    events.emit(AUCTION_END);\n    try {\n      processCallbacks([externalCallbacks.oneTime]);\n    }\n    catch(e){\n      utils.logError('Error executing bidsBackHandler', null, e);\n    }\n    finally {\n      externalCallbacks.oneTime = null;\n      externalCallbacks.timer = false;\n      pbjs.clearAuction();\n    }\n  }\n};\n\nexports.externalCallbackReset = function () {\n  externalCallbacks.all.called = false;\n};\n\nfunction triggerAdUnitCallbacks(adUnitCode) {\n  //todo : get bid responses and send in args\n  var singleAdUnitCode = [adUnitCode];\n  processCallbacks(externalCallbacks.byAdUnit, singleAdUnitCode);\n}\n\nfunction processCallbacks(callbackQueue, singleAdUnitCode) {\n  if (utils.isArray(callbackQueue)) {\n    callbackQueue.forEach(callback => {\n      const adUnitCodes = singleAdUnitCode || pbjs._adUnitCodes;\n      const bids = [pbjs._bidsReceived\n                      .filter(adUnitsFilter.bind(this, adUnitCodes))\n                      .reduce(groupByPlacement, {})];\n\n      callback.apply(pbjs, bids);\n    });\n  }\n}\n\n/**\n * groupByPlacement is a reduce function that converts an array of Bid objects\n * to an object with placement codes as keys, with each key representing an object\n * with an array of `Bid` objects for that placement\n * @returns {*} as { [adUnitCode]: { bids: [Bid, Bid, Bid] } }\n */\nfunction groupByPlacement(bidsByPlacement, bid) {\n  if (!bidsByPlacement[bid.adUnitCode])\n    bidsByPlacement[bid.adUnitCode] = { bids: [] };\n\n  bidsByPlacement[bid.adUnitCode].bids.push(bid);\n\n  return bidsByPlacement;\n}\n\n/**\n * Add a one time callback, that is discarded after it is called\n * @param {Function} callback\n * @param timer Timer to clear if callback is triggered before timer time's out\n */\nexports.addOneTimeCallback = function (callback, timer) {\n  externalCallbacks.oneTime = callback;\n  externalCallbacks.timer = timer;\n};\n\nexports.addCallback = function (id, callback, cbEvent) {\n  callback.id = id;\n  if (CONSTANTS.CB.TYPE.ALL_BIDS_BACK === cbEvent) {\n    externalCallbacks.all.push(callback);\n  } else if (CONSTANTS.CB.TYPE.AD_UNIT_BIDS_BACK === cbEvent) {\n    externalCallbacks.byAdUnit.push(callback);\n  }\n};\n\n//register event for bid adjustment\nevents.on(CONSTANTS.EVENTS.BID_ADJUSTMENT, function (bid) {\n  adjustBids(bid);\n});\n\nfunction adjustBids(bid) {\n  var code = bid.bidderCode;\n  var bidPriceAdjusted = bid.cpm;\n  if (code && pbjs.bidderSettings && pbjs.bidderSettings[code]) {\n    if (typeof pbjs.bidderSettings[code].bidCpmAdjustment === objectType_function) {\n      try {\n        bidPriceAdjusted = pbjs.bidderSettings[code].bidCpmAdjustment.call(null, bid.cpm, Object.assign({}, bid));\n      }\n      catch (e) {\n        utils.logError('Error during bid adjustment', 'bidmanager.js', e);\n      }\n    }\n  }\n\n  if (bidPriceAdjusted >= 0) {\n    bid.cpm = bidPriceAdjusted;\n  }\n}\n\nexports.adjustBids = function() {\n  return adjustBids(...arguments);\n};\n\nfunction getStandardBidderSettings() {\n  let bidder_settings = pbjs.bidderSettings;\n  if (!bidder_settings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD]) {\n    bidder_settings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD] = {\n      adserverTargeting: [\n        {\n          key: 'hb_bidder',\n          val: function (bidResponse) {\n            return bidResponse.bidderCode;\n          }\n        }, {\n          key: 'hb_adid',\n          val: function (bidResponse) {\n            return bidResponse.adId;\n          }\n        }, {\n          key: 'hb_pb',\n          val: function (bidResponse) {\n            if (_granularity === CONSTANTS.GRANULARITY_OPTIONS.AUTO) {\n              return bidResponse.pbAg;\n            } else if (_granularity === CONSTANTS.GRANULARITY_OPTIONS.DENSE) {\n              return bidResponse.pbDg;\n            } else if (_granularity === CONSTANTS.GRANULARITY_OPTIONS.LOW) {\n              return bidResponse.pbLg;\n            } else if (_granularity === CONSTANTS.GRANULARITY_OPTIONS.MEDIUM) {\n              return bidResponse.pbMg;\n            } else if (_granularity === CONSTANTS.GRANULARITY_OPTIONS.HIGH) {\n              return bidResponse.pbHg;\n            } else if (_granularity === CONSTANTS.GRANULARITY_OPTIONS.CUSTOM) {\n              return bidResponse.pbCg;\n            }\n          }\n        }, {\n          key: 'hb_size',\n          val: function (bidResponse) {\n            return bidResponse.size;\n          }\n        }, {\n          key: 'hb_deal',\n          val: function (bidResponse) {\n            return bidResponse.dealId;\n          }\n        }\n      ]\n    };\n  }\n  return bidder_settings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD];\n}\n\nfunction getStandardBidderAdServerTargeting() {\n  return getStandardBidderSettings()[CONSTANTS.JSON_MAPPING.ADSERVER_TARGETING];\n}\n\nexports.getStandardBidderAdServerTargeting = getStandardBidderAdServerTargeting;\n\n\n\n// WEBPACK FOOTER //\n// ./src/bidmanager.js","const _defaultPrecision = 2;\nconst _lgPriceConfig = {\n  'buckets': [{\n    'min': 0,\n    'max': 5,\n    'increment': 0.5\n  }]\n};\nconst _mgPriceConfig = {\n  'buckets': [{\n    'min': 0,\n    'max': 20,\n    'increment': 0.1\n  }]\n};\nconst _hgPriceConfig = {\n  'buckets': [{\n    'min': 0,\n    'max': 20,\n    'increment': 0.01\n  }]\n};\nconst _densePriceConfig = {\n  'buckets': [{\n      'min': 0,\n      'max': 3,\n      'increment': 0.01\n    },\n    {\n      'min': 3,\n      'max': 8,\n      'increment': 0.05\n    },\n    {\n      'min': 8,\n      'max': 20,\n      'increment': 0.5\n    }]\n};\nconst _autoPriceConfig = {\n  'buckets': [{\n      'min': 0,\n      'max': 5,\n      'increment': 0.05\n    },\n    {\n      'min': 5,\n      'max': 10,\n      'increment': 0.1\n    },\n    {\n      'min': 10,\n      'max': 20,\n      'increment': 0.5\n    }]\n};\n\nfunction getPriceBucketString(cpm, customConfig) {\n  let cpmFloat = 0;\n  cpmFloat = parseFloat(cpm);\n  if (isNaN(cpmFloat)) {\n    cpmFloat = '';\n  }\n\n  return {\n    low: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _lgPriceConfig),\n    med: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _mgPriceConfig),\n    high: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _hgPriceConfig),\n    auto: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _autoPriceConfig),\n    dense: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _densePriceConfig),\n    custom:  (cpmFloat === '') ? '' : getCpmStringValue(cpm, customConfig)\n  };\n}\n\nfunction getCpmStringValue(cpm, config) {\n  let cpmStr = '';\n  if (!isValidePriceConfig(config)) {\n    return cpmStr;\n  }\n  const cap = config.buckets.reduce((prev,curr) => {\n    if (prev.max > curr.max) {\n      return prev;\n    }\n    return curr;\n  }, {\n    'max': 0,\n  });\n  let bucket = config.buckets.find(bucket => {\n    if (cpm > cap.max) {\n      const precision = bucket.precision || _defaultPrecision;\n      cpmStr = bucket.max.toFixed(precision);\n    } else if (cpm <= bucket.max && cpm >= bucket.min) {\n      return bucket;\n    }\n  });\n  if (bucket) {\n    cpmStr = getCpmTarget(cpm, bucket.increment, bucket.precision);\n  }\n  return cpmStr;\n}\n\nfunction isValidePriceConfig(config) {\n  if (!config || !config.buckets || !Array.isArray(config.buckets)) {\n    return false;\n  }\n  let isValid = true;\n  config.buckets.forEach(bucket => {\n    if(typeof bucket.min === 'undefined' || !bucket.max || !bucket.increment) {\n      isValid = false;\n    }\n  });\n  return isValid;\n}\n\nfunction getCpmTarget(cpm, increment, precision) {\n  if (!precision) {\n    precision = _defaultPrecision;\n  }\n  let bucketSize = 1 / increment;\n  return (Math.floor(cpm * bucketSize) / bucketSize).toFixed(precision);\n}\n\nexport { getPriceBucketString, isValidePriceConfig };\n\n\n\n// WEBPACK FOOTER //\n// ./src/cpmBucketManager.js","var utils = require('./utils');\nlet _requestCache = {};\n\n//add a script tag to the page, used to add /jpt call to page\nexports.loadScript = function (tagSrc, callback, cacheRequest) {\n  //var noop = () => {};\n  //\n  //callback = callback || noop;\n  if (!tagSrc) {\n    utils.logError('Error attempting to request empty URL', 'adloader.js:loadScript');\n    return;\n  }\n\n  if (cacheRequest) {\n    if (_requestCache[tagSrc]) {\n      if (callback && typeof callback === 'function') {\n        if (_requestCache[tagSrc].loaded) {\n          //invokeCallbacks immediately\n          callback();\n        } else {\n          //queue the callback\n          _requestCache[tagSrc].callbacks.push(callback);\n        }\n      }\n    } else {\n      _requestCache[tagSrc] = {\n        loaded: false,\n        callbacks: []\n      };\n      if (callback && typeof callback === 'function') {\n        _requestCache[tagSrc].callbacks.push(callback);\n      }\n\n      requestResource(tagSrc, function () {\n        _requestCache[tagSrc].loaded = true;\n        try {\n          for (let i = 0; i < _requestCache[tagSrc].callbacks.length; i++) {\n            _requestCache[tagSrc].callbacks[i]();\n          }\n        }\n        catch (e) {\n          utils.logError('Error executing callback', 'adloader.js:loadScript', e);\n        }\n      });\n    }\n  }\n\n  //trigger one time request\n  else {\n    requestResource(tagSrc, callback);\n  }\n\n};\n\nfunction requestResource(tagSrc, callback) {\n  var jptScript = document.createElement('script');\n  jptScript.type = 'text/javascript';\n  jptScript.async = true;\n\n  // Execute a callback if necessary\n  if (callback && typeof callback === 'function') {\n    if (jptScript.readyState) {\n      jptScript.onreadystatechange = function () {\n        if (jptScript.readyState === 'loaded' || jptScript.readyState === 'complete') {\n          jptScript.onreadystatechange = null;\n          callback();\n        }\n      };\n    } else {\n      jptScript.onload = function () {\n        callback();\n      };\n    }\n  }\n\n  jptScript.src = tagSrc;\n\n  //add the new script tag to the page\n  var elToAppend = document.getElementsByTagName('head');\n  elToAppend = elToAppend.length ? elToAppend : document.getElementsByTagName('body');\n  if (elToAppend.length) {\n    elToAppend = elToAppend[0];\n    elToAppend.insertBefore(jptScript, elToAppend.firstChild);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/adloader.js","function Adapter(code) {\n  var bidderCode = code;\n\n  function setBidderCode(code) {\n    bidderCode = code;\n  }\n\n  function getBidderCode() {\n    return bidderCode;\n  }\n\n  function callBids() {\n  }\n\n  return {\n    callBids: callBids,\n    setBidderCode: setBidderCode,\n    getBidderCode: getBidderCode\n  };\n}\n\nexports.createNew = function (bidderCode) {\n  return new Adapter(bidderCode);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/adapter.js","var utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\n/**\n * Adapter for requesting bids from Adblade\n * To request an Adblade Header partner account\n * or for additional integration support please\n * register at http://www.adblade.com.\n */\nvar AdbladeAdapter = function AdbladeAdapter() {\n  'use strict';\n\n  const BIDDER_CODE       = 'adblade';\n  const BASE_URI          = '//rtb.adblade.com/prebidjs/bid?';\n  const DEFAULT_BID_FLOOR = 0.0000000001;\n\n  function _callBids(params) {\n    var bids        = params.bids || [],\n        referrer    = utils.getTopWindowUrl(),\n        loc         = utils.getTopWindowLocation(),\n        domain      = loc.hostname,\n        partnerId   = 0,\n        bidRequests = {};\n\n    if (bids.length > 0) {\n      partnerId = '' + bids[0].params.partnerId;\n    }\n\n    utils._each(bids, function(bid) {\n      // make sure the \"sizes\" are an array of arrays\n      if (!(bid.sizes[0] instanceof Array)) {\n        bid.sizes = [bid.sizes];\n      }\n      utils._each(bid.sizes, function(size) {\n        let key = size[0] + 'x' + size[1];\n\n        bidRequests[key] = bidRequests[key] || {\n          'site': {\n            'id': partnerId,\n            'page': referrer,\n            'domain': domain,\n            'publisher': {\n              'id': partnerId,\n              'name': referrer,\n              'domain': domain\n            }\n          },\n          'id': params.requestId,\n          'imp': [],\n          'device': {\n            'ua': window.navigator.userAgent,\n          },\n          'cur': ['USD'],\n          'user': {}\n        };\n\n        bidRequests[key].imp.push({\n          'id': bid.bidId,\n          'bidfloor': bid.params.bidFloor || DEFAULT_BID_FLOOR,\n          'tag': bid.placementCode,\n          'banner': {\n            'w': size[0],\n            'h': size[1],\n          },\n          'secure': 0 + (loc.protocol === 'https')\n        });\n      });\n    });\n\n    utils._each(bidRequests, function (bidRequest) {\n      adloader.loadScript(\n        utils.tryAppendQueryString(\n          utils.tryAppendQueryString(\n            BASE_URI,\n            'callback',\n            'pbjs.adbladeResponse'\n          ),\n          'json',\n          JSON.stringify(\n            bidRequest\n          )\n        )\n      );\n    });\n  }\n\n  pbjs.adbladeResponse = function (response) {\n    var auctionIdRe    = /\\$(%7B|\\{)AUCTION_ID(%7D|\\})/gi,\n        auctionPriceRe = /\\$(%7B|\\{)AUCTION_PRICE(%7D|\\})/gi,\n        clickUrlRe     = /\\$(%7B|\\{)CLICK_URL(%7D|\\})/gi;\n\n    if (typeof(response) === 'undefined' || !response.hasOwnProperty('seatbid') || utils.isEmpty(response.seatbid)) {\n      // handle empty bids\n      var bidsRequested = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === BIDDER_CODE).bids;\n      if (bidsRequested.length > 0) {\n        let bid = bidfactory.createBid(2);\n        bid.bidderCode = BIDDER_CODE;\n        bidmanager.addBidResponse(bidsRequested[0].placementCode, bid);\n      }\n\n      return;\n    }\n\n    utils._each(response.seatbid, function(seatbid) {\n      utils._each(seatbid.bid, function(seatbidBid) {\n        var bidRequest = utils.getBidRequest(seatbidBid.impid),\n            ad         = seatbidBid.adm + utils.createTrackPixelHtml(seatbidBid.nurl);\n\n        ad = ad.replace(auctionIdRe, seatbidBid.impid);\n        ad = ad.replace(clickUrlRe, '');\n        ad = ad.replace(auctionPriceRe, seatbidBid.price);\n\n        let bid = bidfactory.createBid(1);\n\n        bid.bidderCode = BIDDER_CODE;\n        bid.cpm = seatbidBid.price;\n        bid.ad = ad;\n        bid.width = seatbidBid.w;\n        bid.height = seatbidBid.h;\n        bidmanager.addBidResponse(bidRequest.placementCode, bid);\n      });\n    });\n  };\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = AdbladeAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/adblade.js","var CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\nvar adBundAdapter = function adBundAdapter() {\n  var timezone = (new Date()).getTimezoneOffset();\n  var bidAPIs = [\n    'http://us-east-engine.adbund.xyz/prebid/ad/get',\n    'http://us-west-engine.adbund.xyz/prebid/ad/get'\n  ];\n  //Based on the time zone to select the interface to the server\n  var bidAPI = bidAPIs[timezone < 0 ? 0 : 1];\n\n  function _stringify(param) {\n    var result = [];\n    var key;\n    for (key in param) {\n      if (param.hasOwnProperty(key)) {\n        result.push(key + '=' + encodeURIComponent(param[key]));\n      }\n    }\n    return result.join('&');\n  }\n\n  function _createCallback(bid) {\n    return function (data) {\n      var response;\n      if (data && data.cpm) {\n        response = bidfactory.createBid(CONSTANTS.STATUS.GOOD);\n        response.bidderCode = 'adbund';\n        Object.assign(response, data);\n      } else {\n        response = bidfactory.createBid(CONSTANTS.STATUS.NO_BID);\n        response.bidderCode = 'adbund';\n      }\n      bidmanager.addBidResponse(bid.placementCode, response);\n    };\n  }\n\n  function _requestBids(bid) {\n    var info = {\n      referrer: utils.getTopWindowUrl(),\n      domain: utils.getTopWindowLocation().hostname,\n      ua: window.navigator.userAgent\n    };\n    var param = Object.assign({}, bid.params, info);\n    param.sizes = JSON.stringify(param.sizes || bid.sizes);\n    param.callback = 'pbjs.adbundResponse';\n    pbjs.adbundResponse = _createCallback(bid);\n    adloader.loadScript(bidAPI + '?' + _stringify(param));\n  }\n\n  function _callBids(params) {\n    (params.bids || []).forEach(function (bid) {\n      _requestBids(bid);\n    });\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = adBundAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/adbund.js","/**\n * @overview AdButler Prebid.js adapter.\n * @author dkharton\n */\n\n'use strict';\n\nvar utils = require('../utils.js');\nvar adloader = require('../adloader.js');\nvar bidmanager = require('../bidmanager.js');\nvar bidfactory = require('../bidfactory.js');\n\nvar AdButlerAdapter = function AdButlerAdapter() {\n  \n  function _callBids(params) {\n    \n    var bids = params.bids || [],\n        callbackData = {},\n        zoneCount = {},\n        pageID = Math.floor(Math.random() * 10e6);\n\n    //Build and send bid requests\n    for (var i = 0; i < bids.length; i++) {\n      var bid = bids[i],\n        zoneID = utils.getBidIdParameter('zoneID', bid.params),\n        callbackID;  \n        \n      if(!(zoneID in zoneCount)){\n        zoneCount[zoneID] = 0;\n      }\n      \n      //build callbackID to get placementCode later  \n      callbackID = zoneID + '_' +zoneCount[zoneID];\n\n      callbackData[callbackID] = {};\n      callbackData[callbackID].bidId = bid.bidId;\n      \n      var adRequest = buildRequest(bid,zoneCount[zoneID],pageID);\n      zoneCount[zoneID]++;\n\n      adloader.loadScript(adRequest);\n    }\n      \n    //Define callback function for bid responses\n    pbjs.adbutlerCB = function(aBResponseObject){\n        \n      var bidResponse = {},\n        callbackID = aBResponseObject.zone_id+'_'+aBResponseObject.place,\n        width = parseInt(aBResponseObject.width),\n        height = parseInt(aBResponseObject.height),\n        isCorrectSize = false,\n        isCorrectCPM = true,\n        CPM,minCPM,maxCPM,\n        bidObj = callbackData[callbackID] ? utils.getBidRequest(callbackData[callbackID].bidId) : null;\n        \n      if (bidObj) {\n        \n        if(aBResponseObject.status === 'SUCCESS'){\n          CPM = aBResponseObject.cpm;\n          minCPM = utils.getBidIdParameter('minCPM',bidObj.params);\n          maxCPM = utils.getBidIdParameter('maxCPM',bidObj.params);\n\n          //Ensure response CPM is within the given bounds\n          if(minCPM !== '' && CPM < parseFloat(minCPM)){\n            isCorrectCPM = false;\n          }\n          if(maxCPM !== '' && CPM > parseFloat(maxCPM)){\n            isCorrectCPM = false;\n          }\n\n          //Ensure that response ad matches one of the placement sizes.  \n          utils._each(bidObj.sizes,function(size){\n            if(width === size[0] && height === size[1]){\n              isCorrectSize = true;\n            }\n          });\n\n          if(isCorrectCPM && isCorrectSize){\n\n            bidResponse = bidfactory.createBid(1,bidObj);\n            bidResponse.bidderCode = 'adbutler';\n            bidResponse.cpm = CPM;\n            bidResponse.width = width;\n            bidResponse.height = height;\n            bidResponse.ad = aBResponseObject.ad_code;\n            bidResponse.ad += addTrackingPixels(aBResponseObject.tracking_pixels);\n\n          } else {\n\n            bidResponse = bidfactory.createBid(2,bidObj);\n            bidResponse.bidderCode = 'adbutler';\n\n          }\n        } else {\n\n          bidResponse = bidfactory.createBid(2,bidObj);\n          bidResponse.bidderCode = 'adbutler';\n\n        }  \n          \n        bidmanager.addBidResponse(bidObj.placementCode, bidResponse);\n          \n      }\n    };\n  }\n  \n  function buildRequest(bid,adIndex,pageID){\n    var accountID = utils.getBidIdParameter('accountID', bid.params),\n        zoneID = utils.getBidIdParameter('zoneID', bid.params),\n        keyword = utils.getBidIdParameter('keyword', bid.params),\n        domain = utils.getBidIdParameter('domain', bid.params);\n\n    if(typeof domain === 'undefined' || domain.length === 0){\n      domain = 'servedbyadbutler.com';\n    }\n\n    var requestURI = location.protocol + '//' + domain + '/adserve/;type=hbr;';\n    requestURI += 'ID='+encodeURIComponent(accountID)+';';\n    requestURI += 'setID='+encodeURIComponent(zoneID)+';';\n    requestURI += 'pid='+encodeURIComponent(pageID)+';';\n    requestURI += 'place='+encodeURIComponent(adIndex)+';';\n      \n    //append the keyword for targeting if one was passed in  \n    if(keyword !== ''){\n      requestURI +='kw='+encodeURIComponent(keyword)+';';\n    }\n    requestURI += 'jsonpfunc=pbjs.adbutlerCB;';\n    requestURI += 'click=CLICK_MACRO_PLACEHOLDER';\n    \n    return requestURI;\n  }\n  \n  function addTrackingPixels(trackingPixels){\n    var trackingPixelMarkup = '';\n    utils._each(trackingPixels,function(pixelURL){\n      \n      var trackingPixel = '<img height=\"0\" width=\"0\" border=\"0\" style=\"display:none;\" src=\"';\n      trackingPixel += pixelURL;\n      trackingPixel += '\">';\n      \n      trackingPixelMarkup += trackingPixel;\n    });\n    return trackingPixelMarkup;\n  }\n  \n  // Export the callBids function, so that prebid.js can execute this function\n  // when the page asks to send out bid requests.\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = AdButlerAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/adbutler.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\nvar utils = require('../utils.js');\nvar CONSTANTS = require('../constants.json');\n\nmodule.exports = function() {\n  var req_url_base = 'https://rex.adequant.com/rex/c2s_prebid?';\n\n  function _callBids(params) {\n    var req_url = [];\n    var publisher_id = null;\n    var sizes = [];\n    var cats = null;\n    var replies = [];\n    var placements = {};\n\n    var bids = params.bids || [];\n    for (var i = 0; i < bids.length; i++) {\n      var bid_request = bids[i];\n      var br_params = bid_request.params || {};\n      placements[bid_request.placementCode] = true;\n\n      publisher_id = br_params.publisher_id.toString()    || publisher_id;\n      var bidfloor = br_params.bidfloor                   || 0.01;\n      cats         = br_params.cats                       || cats;\n      if (typeof(cats) === utils.objectType_string) { cats = cats.split(' '); }\n      var br_sizes = utils.parseSizesInput(bid_request.sizes);\n      for (var j = 0; j < br_sizes.length; j++) {\n        sizes.push(br_sizes[j]+'_'+bidfloor);\n        replies.push(bid_request.placementCode);\n      }\n    }\n    // send out 1 bid request for all bids\n    if (publisher_id) { req_url.push('a='+publisher_id); }\n    if (cats)         { req_url.push('c='+cats.join('+')); }\n    if (sizes)        { req_url.push('s='+sizes.join('+')); }\n\n    adloader.loadScript(req_url_base+req_url.join('&'), function() { process_bids(replies, placements); });\n  }\n\n  function process_bids(replies, placements) {\n    var placement_code, bid, adequant_creatives = window.adequant_creatives;\n    if (adequant_creatives && adequant_creatives.seatbid) {\n      for (var i=0; i<adequant_creatives.seatbid.length; i++) {\n        var bid_response = adequant_creatives.seatbid[i].bid[0];\n        placement_code = replies[parseInt(bid_response.impid,10)-1];\n        if (!placement_code || !placements[placement_code]) { continue; }\n\n        bid = bidfactory.createBid(CONSTANTS.STATUS.GOOD);\n        bid.bidderCode = 'adequant';\n        bid.cpm = bid_response.price;\n        bid.ad = bid_response.adm;\n        bid.width = bid_response.w;\n        bid.height = bid_response.h;\n        bidmanager.addBidResponse(placement_code, bid);\n        placements[placement_code] = false;\n      }\n    }\n    for (placement_code in placements) {\n      if (placements[placement_code]) {\n        bid = bidfactory.createBid(CONSTANTS.STATUS.NO_BID);\n        bid.bidderCode = 'adequant';\n        bidmanager.addBidResponse(placement_code, bid);\n        utils.logMessage('No bid response from Adequant for placement code ' + placement_code);\n      }\n    }\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/adequant.js","var utils = require('../utils.js');\nvar adloader = require('../adloader.js');\nvar bidmanager = require('../bidmanager.js');\nvar bidfactory = require('../bidfactory.js');\nvar STATUSCODES = require('../constants.json').STATUS;\n\nfunction AdformAdapter() {\n\n  return {\n    callBids: _callBids\n  };\n\n  function _callBids(params) {\n    var bid, _value, _key, i, j, k, l;\n    var bids = params.bids;\n    var request = [];\n    var callbackName = '_adf_' + utils.getUniqueIdentifierStr();\n    var globalParams = [ [ 'adxDomain', 'adx.adform.net' ], [ 'url', null ], [ 'tid', null ], [ 'callback', 'pbjs.' + callbackName ] ];\n\n    for (i = 0, l = bids.length; i < l; i++) {\n      bid = bids[i];\n\n      for (j = 0, k = globalParams.length; j < k; j++) {\n        _key = globalParams[j][0];\n        _value = bid[_key] || bid.params[_key];\n        if (_value) {\n          bid[_key] = bid.params[_key] = null;\n          globalParams[j][1] = _value;\n        }\n      }\n\n      request.push(formRequestUrl(bid.params));\n    }\n\n    request.unshift('//' + globalParams[0][1]+ '/adx/?rp=4');\n\n    for (i = 1, l = globalParams.length; i < l; i++) {\n      _key = globalParams[i][0];\n      _value = globalParams[i][1];\n      if (_value) {\n        request.push(globalParams[i][0] + '='+ encodeURIComponent(_value));\n      }\n    }\n\n    pbjs[callbackName] = handleCallback(bids);\n\n    adloader.loadScript(request.join('&'));\n  }\n\n  function formRequestUrl(reqData) {\n    var key;\n    var url = [];\n\n    for (key in reqData) {\n      if (reqData.hasOwnProperty(key) && reqData[key])\n        url.push(key, '=', reqData[key], '&');\n    }\n\n    return encode64(url.join('').slice(0, -1));\n  }\n\n  function handleCallback(bids) {\n    return function handleResponse(adItems) {\n      var bidObject;\n      var bidder = 'adform';\n      var adItem;\n      var bid;\n      for (var i = 0, l = adItems.length; i < l; i++) {\n        adItem = adItems[i];\n        bid = bids[i];\n        if (adItem && adItem.response === 'banner' &&\n            verifySize(adItem, bid.sizes)) {\n\n          bidObject = bidfactory.createBid(STATUSCODES.GOOD, bid);\n          bidObject.bidderCode = bidder;\n          bidObject.cpm = adItem.win_bid;\n          bidObject.cur = adItem.win_cur;\n          bidObject.ad = adItem.banner;\n          bidObject.width = adItem.width;\n          bidObject.height = adItem.height;\n          bidObject.dealId = adItem.deal_id;\n          bidmanager.addBidResponse(bid.placementCode, bidObject);\n        } else {\n          bidObject = bidfactory.createBid(STATUSCODES.NO_BID, bid);\n          bidObject.bidderCode = bidder;\n          bidmanager.addBidResponse(bid.placementCode, bidObject);\n        }\n      }\n    };\n\n    function verifySize(adItem, validSizes) {\n      for (var j = 0, k = validSizes.length; j < k; j++) {\n        if (adItem.width === validSizes[j][0] &&\n            adItem.height === validSizes[j][1]) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }\n\n  function encode64(input) {\n    var out = [];\n    var chr1;\n    var chr2;\n    var chr3;\n    var enc1;\n    var enc2;\n    var enc3;\n    var enc4;\n    var i = 0;\n    var _keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=';\n\n    input = utf8_encode(input);\n\n    while (i < input.length) {\n\n      chr1 = input.charCodeAt(i++);\n      chr2 = input.charCodeAt(i++);\n      chr3 = input.charCodeAt(i++);\n\n      enc1 = chr1 >> 2;\n      enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n      enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n      enc4 = chr3 & 63;\n\n      if (isNaN(chr2)) {\n        enc3 = enc4 = 64;\n      } else if (isNaN(chr3)) {\n        enc4 = 64;\n      }\n\n      out.push(_keyStr.charAt(enc1), _keyStr.charAt(enc2));\n      if (enc3 !== 64)\n          out.push(_keyStr.charAt(enc3));\n      if (enc4 !== 64)\n          out.push(_keyStr.charAt(enc4));\n    }\n\n    return out.join('');\n  }\n\n  function utf8_encode(string) {\n    string = string.replace(/\\r\\n/g, '\\n');\n    var utftext = '';\n\n    for (var n = 0; n < string.length; n++) {\n\n      var c = string.charCodeAt(n);\n\n      if (c < 128) {\n        utftext += String.fromCharCode(c);\n      } else if ((c > 127) && (c < 2048)) {\n        utftext += String.fromCharCode((c >> 6) | 192);\n        utftext += String.fromCharCode((c & 63) | 128);\n      } else {\n        utftext += String.fromCharCode((c >> 12) | 224);\n        utftext += String.fromCharCode(((c >> 6) & 63) | 128);\n        utftext += String.fromCharCode((c & 63) | 128);\n      }\n    }\n\n    return utftext;\n  }\n\n}\n\nmodule.exports = AdformAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/adform.js","import bidmanager from 'src/bidmanager';\nimport bidfactory from 'src/bidfactory';\nimport * as utils from 'src/utils';\nimport {ajax} from 'src/ajax';\nimport Adapter from 'src/adapters/adapter';\n\n/**\n * Adapter for requesting bids from AdKernel white-label platform\n * @class\n */\nconst AdKernelAdapter = function AdKernelAdapter() {\n  const AJAX_REQ_PARAMS = {\n    contentType: 'text/plain',\n    withCredentials: true,\n    method: 'GET'\n  };\n  const EMPTY_BID_RESPONSE = {'seatbid': [{'bid': []}]};\n\n  let baseAdapter = Adapter.createNew('adkernel');\n\n  /**\n   * Helper object to build multiple bid requests in case of multiple zones/ad-networks\n   * @constructor\n   */\n  function RtbRequestDispatcher() {\n    const _dispatch = {};\n    const originalBids = {};\n    const site = createSite();\n    const syncedHostZones = {};\n\n    //translate adunit info into rtb impression dispatched by host/zone\n    this.addImp = function (bid) {\n      let host = bid.params.host;\n      let zone = bid.params.zoneId;\n      let size = bid.sizes[0];\n      let bidId = bid.bidId;\n\n      if (!(host in _dispatch)) {\n        _dispatch[host] = {};\n      }\n      /* istanbul ignore else  */\n      if (!(zone in _dispatch[host])) {\n        _dispatch[host][zone] = [];\n      }\n      let imp = {'id': bidId, 'tagid' : bid.placementCode, 'banner': {'w': size[0], 'h': size[1]}};\n      if (utils.getTopWindowLocation().protocol === 'https:') {\n        imp.secure = 1;\n      }\n      //save rtb impression for specified ad-network host and zone\n      _dispatch[host][zone].push(imp);\n      originalBids[bidId] = bid;\n      //perform user-sync\n      if (!(host in syncedHostZones)){\n        syncedHostZones[host] = [];\n      }\n      if (syncedHostZones[host].indexOf(zone) === -1) {\n        syncedHostZones[host].push(zone);\n        insertUserSync(host, zone);\n      }\n    };\n\n    function insertUserSync(host, zone) {\n      var iframe = utils.createInvisibleIframe();\n      iframe.src = `//${host}/user-sync?zone=${zone}`;\n      try {\n        document.body.appendChild(iframe);\n      } catch (error) {\n        /* istanbul ignore next */\n        utils.logError(error);\n      }\n    }\n\n    /**\n     *  Main function to get bid requests\n     */\n    this.dispatch = function (callback) {\n      utils._each(_dispatch, (zones, host) => {\n        utils.logMessage(`processing network ${host}`);\n        utils._each(zones, (impressions, zone) => {\n          utils.logMessage(`processing zone ${zone}`);\n          dispatchRtbRequest(host, zone, impressions, callback);\n        });\n      });\n    };\n\n    function dispatchRtbRequest(host, zone, impressions, callback) {\n      let url = buildEndpointUrl(host);\n      let rtbRequest = buildRtbRequest(impressions);\n      let params = buildRequestParams(zone, rtbRequest);\n      ajax(url, (bidResp) => {\n        bidResp = bidResp === '' ? EMPTY_BID_RESPONSE : JSON.parse(bidResp);\n        utils._each(rtbRequest.imp, (imp) => {\n          let bidFound = false;\n          utils._each(bidResp.seatbid[0].bid, (bid) => {\n            /* istanbul ignore else */\n            if (!bidFound && bid.impid === imp.id) {\n              bidFound = true;\n              callback(originalBids[imp.id], imp, bid);\n            }\n          });\n          if (!bidFound) {\n            callback(originalBids[imp.id], imp);\n          }\n        });\n      }, params, AJAX_REQ_PARAMS);\n    }\n\n    /**\n     * Builds complete rtb bid request\n     * @param imps collection of impressions\n     */\n    function buildRtbRequest(imps) {\n      return {\n        'id': utils.getUniqueIdentifierStr(),\n        'imp': imps,\n        'site': site,\n        'at': 1,\n        'device': {\n          'ip': 'caller',\n          'ua': 'caller'\n        }\n      };\n    }\n\n    /**\n     * Build ad-network specific endpoint url\n     */\n    function buildEndpointUrl(host) {\n      return `${window.location.protocol}//${host}/rtbg`;\n    }\n\n    function buildRequestParams(zone, rtbReq) {\n      return {\n        'zone': encodeURIComponent(zone),\n        'ad_type': 'rtb',\n        'r': encodeURIComponent(JSON.stringify(rtbReq))\n      };\n    }\n  }\n\n  /**\n   *  Main module export function implementation\n   */\n  baseAdapter.callBids = function (params) {\n    var bids = params.bids || [];\n    processBids(bids);\n  };\n\n  /**\n   *  Process all bids grouped by network/zone\n   */\n  function processBids(bids) {\n    const dispatcher = new RtbRequestDispatcher();\n    //process individual bids\n    utils._each(bids, (bid) => {\n      if (!validateBidParams(bid.params)) {\n        utils.logError(`Incorrect configuration for adkernel bidder: ${bid.params}`);\n        bidmanager.addBidResponse(bid.placementCode, createEmptyBidObject(bid));\n      } else {\n        dispatcher.addImp(bid);\n      }\n    });\n    //process bids grouped into bidrequests\n    dispatcher.dispatch((bid, imp, bidResp) => {\n      let adUnitId = bid.placementCode;\n      if (bidResp) {\n        utils.logMessage(`got response for ${adUnitId}`);\n        bidmanager.addBidResponse(adUnitId, createBidObject(bidResp, bid, imp.banner.w, imp.banner.h));\n      } else {\n        utils.logMessage(`got empty response for ${adUnitId}`);\n        bidmanager.addBidResponse(adUnitId, createEmptyBidObject(bid));\n      }\n    });\n  }\n\n  /**\n   *  Create bid object for the bid manager\n   */\n  function createBidObject(resp, bid, width, height) {\n    return Object.assign(bidfactory.createBid(1, bid), {\n      bidderCode: bid.bidder,\n      ad: formatAdMarkup(resp),\n      width: width,\n      height: height,\n      cpm: parseFloat(resp.price)\n    });\n  }\n\n  /**\n   * Create empty bid object for the bid manager\n   */\n  function createEmptyBidObject(bid) {\n    return Object.assign(bidfactory.createBid(2, bid), {\n      bidderCode: bid.bidder\n    });\n  }\n\n  /**\n   *  Format creative with optional nurl call\n   */\n  function formatAdMarkup(bid) {\n    var adm = bid.adm;\n    if ('nurl' in bid) {\n      adm += utils.createTrackPixelHtml(`${bid.nurl}&px=1`);\n    }\n    return adm;\n  }\n\n  function validateBidParams(params) {\n    return typeof params.host !== 'undefined' && typeof params.zoneId !== 'undefined';\n  }\n\n  /**\n   * Creates site description object\n   */\n  function createSite() {\n    var location = utils.getTopWindowLocation();\n    return {\n      'domain': location.hostname,\n      'page' : location.href.split('?')[0]\n    };\n  }\n\n  return {\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode,\n    getBidderCode : baseAdapter.getBidderCode,\n    createNew : AdKernelAdapter.createNew\n  };\n};\n\n/**\n * Creates new instance of AdKernel bidder adapter\n */\nAdKernelAdapter.createNew = function() {\n  return new AdKernelAdapter();\n};\n\nmodule.exports = AdKernelAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/adkernel.js","import {parse as parseURL, format as formatURL} from './url';\n\nvar utils = require('./utils');\n\nconst XHR_DONE = 4;\n\n/**\n * Simple IE9+ and cross-browser ajax request function\n * Note: x-domain requests in IE9 do not support the use of cookies\n *\n * @param url string url\n * @param callback {object | function} callback\n * @param data mixed data\n * @param options object\n */\n\nexport function ajax(url, callback, data, options = {}) {\n  try {\n    let x;\n    let useXDomainRequest = false;\n    let method = options.method || (data ? 'POST' : 'GET');\n\n    let callbacks = typeof callback === \"object\" ? callback : {\n      success: function() {\n        utils.logMessage('xhr success');\n      },\n      error: function(e) {\n        utils.logError('xhr error', null, e);\n      }\n    };\n\n    if(typeof callback === \"function\") {\n      callbacks.success = callback;\n    }\n\n    if (!window.XMLHttpRequest) {\n      useXDomainRequest = true;\n    } else{\n      x = new window.XMLHttpRequest();\n      if (x.responseType === undefined) {\n        useXDomainRequest = true;\n      }\n    }\n\n    if (useXDomainRequest) {\n      x = new window.XDomainRequest();\n      x.onload = function () {\n        callbacks.success(x.responseText, x);\n      };\n\n      // http://stackoverflow.com/questions/15786966/xdomainrequest-aborts-post-on-ie-9\n      x.onerror = function () {\n        callbacks.error(\"error\", x);\n      };\n      x.ontimeout = function () {\n        callbacks.error(\"timeout\", x);\n      };\n      x.onprogress = function() {\n        utils.logMessage('xhr onprogress');\n      };\n    } else {\n      x.onreadystatechange = function () {\n        if (x.readyState === XHR_DONE) {\n          let status = x.status;\n          if(status >= 200 && status < 300 || status === 304) {\n            callbacks.success(x.responseText, x);\n          } else {\n            callbacks.error(x.statusText, x);\n          }\n        }\n      };\n    }\n\n    if (method === 'GET' && data) {\n      let urlInfo = parseURL(url);\n      Object.assign(urlInfo.search, data);\n      url = formatURL(urlInfo);\n    }\n\n    x.open(method, url);\n\n    if (!useXDomainRequest) {\n      if (options.withCredentials) {\n        x.withCredentials = true;\n      }\n      utils._each(options.customHeaders, (value, header) => {\n        x.setRequestHeader(header, value);\n      });\n      if (options.preflight) {\n        x.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n      }\n      x.setRequestHeader('Content-Type', options.contentType || 'text/plain');\n    }\n    x.send(method === 'POST' && data);\n  } catch (error) {\n    utils.logError('xhr construction', error);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ajax.js","export function parseQS(query) {\n  return !query ? {} : query\n    .replace(/^\\?/, '')\n    .split('&')\n    .reduce((acc, criteria) => {\n      let [k, v] = criteria.split('=');\n      if (/\\[\\]$/.test(k)) {\n        k = k.replace('[]', '');\n        acc[k] = acc[k] || [];\n        acc[k].push(v);\n      } else {\n        acc[k] = v || '';\n      }\n      return acc;\n    }, {});\n}\n\nexport function formatQS(query) {\n  return Object\n    .keys(query)\n    .map(k => Array.isArray(query[k]) ?\n      query[k].map(v => `${k}[]=${v}`).join('&') :\n      `${k}=${query[k]}`)\n    .join('&');\n}\n\nexport function parse(url) {\n  let parsed = document.createElement('a');\n  parsed.href = decodeURIComponent(url);\n  return {\n    protocol: (parsed.protocol || '').replace(/:$/, ''),\n    hostname: parsed.hostname,\n    port: +parsed.port,\n    pathname: parsed.pathname.replace(/^(?!\\/)/,'/'),\n    search: parseQS(parsed.search || ''),\n    hash: (parsed.hash || '').replace(/^#/, ''),\n    host: parsed.host\n  };\n}\n\nexport function format(obj) {\n  return (obj.protocol || 'http') + '://' +\n         (obj.host ||\n          obj.hostname + (obj.port ? `:${obj.port}` : '')) +\n         (obj.pathname || '') +\n         (obj.search ? `?${formatQS(obj.search || '')}` : '') +\n         (obj.hash ? `#${obj.hash}` : '');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/url.js","import { getBidRequest } from '../utils.js';\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\nvar utils = require('../utils.js');\nvar CONSTANTS = require('../constants.json');\n\n/**\n * Adapter for requesting bids from AdMedia.\n *\n */\nvar AdmediaAdapter = function AdmediaAdapter() {\n\n  function _callBids(params){\n    var bids, bidderUrl = (window.location.protocol) + \"//b.admedia.com/banner/prebid/bidder/?\";\n    bids = params.bids || [];\n    for (var i = 0; i < bids.length; i++) {\n      var request_obj = {};\n      var bid = bids[i];\n\n      if (bid.params.aid) {\n        request_obj.aid = bid.params.aid;\n      }\n      else{\n        utils.logError('required param aid is missing', \"admedia\");\n        continue;\n      }\n\n      //optional page_url macro\n      if (bid.params.page_url) {\n        request_obj.page_url = bid.params.page_url;\n      }\n\n      //if set, return a test ad for all aids\n      if (bid.params.test_ad === 1) {\n        request_obj.test_ad = 1;\n      }\n\n      var parsedSizes = utils.parseSizesInput(bid.sizes);\n      var parsedSizesLength = parsedSizes.length;\n      if (parsedSizesLength > 0) {\n        //first value should be \"size\"\n        request_obj.size = parsedSizes[0];\n        if (parsedSizesLength > 1) {\n          //any subsequent values should be \"promo_sizes\"\n          var promo_sizes = [];\n          for (var j = 1; j < parsedSizesLength; j++) {\n            promo_sizes.push(parsedSizes[j]);\n          }\n\n          request_obj.promo_sizes = promo_sizes.join(\",\");\n\n        }\n      }\n\n      //detect urls\n      request_obj.siteDomain = window.location.host;\n      request_obj.sitePage = window.location.href;\n      request_obj.siteRef = document.referrer;\n      request_obj.topUrl = utils.getTopWindowUrl();\n\n      request_obj.callbackId = bid.bidId;\n\n      var endpoint = bidderUrl+utils.parseQueryStringParameters(request_obj);\n\n      //utils.logMessage('Admedia request built: ' + endpoint);\n\n      adloader.loadScript(endpoint);\n    }\n  }\n\n  //expose the callback to global object\n  pbjs.admediaHandler = function(response){\n    var bidObject = {};\n    var callback_id = response.callback_id;\n    var placementCode = '';\n    var bidObj = getBidRequest(callback_id);\n    if (bidObj) {\n      placementCode = bidObj.placementCode;\n    }\n\n    if(bidObj && response.cpm>0 && !!response.ad){\n      bidObject = bidfactory.createBid(CONSTANTS.STATUS.GOOD);\n      bidObject.bidderCode = bidObj.bidder;\n      bidObject.cpm = parseFloat(response.cpm);\n      bidObject.ad = response.ad;\n      bidObject.width = response.width;\n      bidObject.height = response.height;\n    }\n    else{\n      bidObject = bidfactory.createBid(CONSTANTS.STATUS.NO_BID);\n      bidObject.bidderCode = bidObj.bidder;\n      utils.logMessage('No prebid response from Admedia for placement code ' + placementCode);\n    }\n\n    bidmanager.addBidResponse(placementCode, bidObject);\n\n  };\n\n\n  // Export the callBids function, so that prebid.js can execute this function\n  // when the page asks to send out bid requests.\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = AdmediaAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/admedia.js","const bidmanager = require('../bidmanager.js');\r\nconst bidfactory = require('../bidfactory.js');\r\nconst utils = require('../utils.js');\r\nconst adloader = require('../adloader');\r\n\r\nvar BidfluenceAdapter = function BidfluenceAdapter() {\r\n\r\n  const scriptUrl = \"//cdn.bidfluence.com/forge.js\";\r\n\r\n  pbjs.bfPbjsCB = function (bfr) {\r\n    var bidRequest = utils.getBidRequest(bfr.cbID);\r\n    var bidObject = null;\r\n    if (bfr.cpm > 0) {\r\n      bidObject = bidfactory.createBid(1, bidRequest);\r\n      bidObject.bidderCode = 'bidfluence';\r\n      bidObject.cpm = bfr.cpm;\r\n      bidObject.ad = bfr.ad;\r\n      bidObject.width = bfr.width;\r\n      bidObject.height = bfr.height;\r\n    } else {\r\n      bidObject = bidfactory.createBid(2, bidRequest);\r\n      bidObject.bidderCode = 'bidfluence';\r\n    }\r\n\r\n    bidmanager.addBidResponse(bfr.placementCode, bidObject);\r\n  };\r\n\r\n  function _callBids(params) {\r\n    var bfbids = params.bids || [];\r\n    for (var i = 0; i < bfbids.length; i++) {\r\n      var bid = bfbids[i];\r\n      call(bid);\r\n    }\r\n  }\r\n  function call(bid) {\r\n\r\n    var adunitId = utils.getBidIdParameter('adunitId', bid.params);\r\n    var publisherId = utils.getBidIdParameter('pubId', bid.params);\r\n    var reservePrice = utils.getBidIdParameter('reservePrice', bid.params);\r\n    var pbjsBfobj = {\r\n      placementCode: bid.placementCode,\r\n      cbID: bid.bidId\r\n    }; \r\n\r\n    var cb = function () {\r\n      /* globals FORGE */\r\n      FORGE.init([adunitId, publisherId, pbjsBfobj, reservePrice]);\r\n    };\r\n\r\n    adloader.loadScript(scriptUrl, cb);\r\n  }\r\n  return {\r\n    callBids: _callBids\r\n  };\r\n};\r\n\r\nmodule.exports = BidfluenceAdapter;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/bidfluence.js","import Adapter from 'src/adapters/adapter';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport { ajax } from 'src/ajax';\nimport { STATUS } from 'src/constants';\n\nconst ENDPOINT = '//rtb.vertamedia.com/hb/';\n\nfunction VertamediaAdapter() {\n  var baseAdapter = Adapter.createNew('vertamedia'),\n      bidRequest;\n\n  baseAdapter.callBids = function (bidRequests) {\n    if (!bidRequests || !bidRequests.bids || bidRequests.bids.length === 0) {\n      return;\n    }\n\n    var RTBDataParams = prepareAndSaveRTBRequestParams(bidRequests.bids[0]);\n\n    if (!RTBDataParams) {\n      return;\n    }\n\n    ajax(ENDPOINT, handleResponse, RTBDataParams, {\n      contentType: 'text/plain',\n      withCredentials: true,\n      method: 'GET'\n    });\n  };\n\n  function prepareAndSaveRTBRequestParams(bid) {\n    if (!bid || !bid.params || !bid.params.aid || !bid.placementCode) {\n      return;\n    }\n\n    bidRequest = bid;\n\n    let size = getSize(bid.sizes);\n\n    bidRequest.width = size.width;\n    bidRequest.height = size.height;\n\n    return {\n      aid: bid.params.aid,\n      w: size.width,\n      h: size.height,\n      domain: document.location.hostname\n    };\n  }\n\n  function getSize(requestSizes) {\n    var parsed = {},\n        size = utils.parseSizesInput(requestSizes)[0];\n\n    if (typeof size !== 'string') {\n      return parsed;\n    }\n\n    let parsedSize = size.toUpperCase().split('X');\n\n    return {\n      width: parseInt(parsedSize[0], 10) || undefined,\n      height: parseInt(parsedSize[1], 10) || undefined\n    };\n  }\n\n  /* Notify Prebid of bid responses so bids can get in the auction */\n  function handleResponse(response) {\n    var parsed;\n\n    try {\n      parsed = JSON.parse(response);\n    } catch (error) {\n      utils.logError(error);\n    }\n\n    if (!parsed || parsed.error || !parsed.bids || !parsed.bids.length) {\n      bidmanager.addBidResponse(bidRequest.placementCode, createBid(STATUS.NO_BID));\n\n      return;\n    }\n\n    bidmanager.addBidResponse(bidRequest.placementCode, createBid(STATUS.GOOD, parsed.bids[0]));\n  }\n\n  function createBid(status, tag) {\n    var bid = bidfactory.createBid(status, tag);\n\n    bid.code = baseAdapter.getBidderCode();\n    bid.bidderCode = bidRequest.bidder;\n\n    if (!tag || status !== STATUS.GOOD) {\n      return bid;\n    }\n\n    bid.mediaType = 'video';\n    bid.cpm = tag.cpm;\n    bid.creative_id = tag.cmpId;\n    bid.width = bidRequest.width;\n    bid.height = bidRequest.height;\n    bid.descriptionUrl = tag.url;\n    bid.vastUrl = tag.url;\n\n    return bid;\n  }\n\n  return {\n    createNew: VertamediaAdapter.createNew,\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode\n  };\n\n}\n\nVertamediaAdapter.createNew = function () {\n  return new VertamediaAdapter();\n};\n\nmodule.exports = VertamediaAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/vertamedia.js","const utils = require('../utils.js');\nconst ajax = require('../ajax.js').ajax;\nconst bidfactory = require('../bidfactory.js');\nconst bidmanager = require('../bidmanager.js');\nconst constants = require('../constants.json');\n\nconst AolAdapter = function AolAdapter() {\n\n  let showCpmAdjustmentWarning = true;\n  const pubapiTemplate = template`${'protocol'}://${'host'}/pubapi/3.0/${'network'}/${'placement'}/${'pageid'}/${'sizeid'}/ADTECH;v=2;cmd=bid;cors=yes;alias=${'alias'}${'bidfloor'};misc=${'misc'}`;\n  const nexageBaseApiTemplate = template`${'protocol'}://${'host'}/bidRequest?`;\n  const nexageGetApiTemplate = template`dcn=${'dcn'}&pos=${'pos'}&cmd=bid${'ext'}`;\n  const BIDDER_CODE = 'aol';\n  const MP_SERVER_MAP = {\n    us: 'adserver-us.adtech.advertising.com',\n    eu: 'adserver-eu.adtech.advertising.com',\n    as: 'adserver-as.adtech.advertising.com'\n  };\n  const NEXAGE_SERVER = 'hb.nexage.com';\n  const SYNC_TYPES = {\n    iframe: 'IFRAME',\n    img: 'IMG'\n  };\n\n  let domReady = (() => {\n    let readyEventFired = false;\n    return fn => {\n      let idempotentFn = () => {\n        if (readyEventFired) {\n          return;\n        }\n        readyEventFired = true;\n        return fn();\n      };\n\n      if (document.readyState === \"complete\") {\n        return idempotentFn();\n      }\n\n      document.addEventListener(\"DOMContentLoaded\", idempotentFn, false);\n      window.addEventListener(\"load\", idempotentFn, false);\n    };\n  })();\n\n  function dropSyncCookies(pixels) {\n    let pixelElements = parsePixelItems(pixels);\n    renderPixelElements(pixelElements);\n  }\n\n  function parsePixelItems(pixels) {\n    let itemsRegExp = /(img|iframe)[\\s\\S]*?src\\s*=\\s*(\"|')(.*?)\\2/gi;\n    let tagNameRegExp = /\\w*(?=\\s)/;\n    let srcRegExp = /src=(\"|')(.*?)\\1/;\n    let pixelsItems = [];\n\n    if (pixels) {\n      let matchedItems = pixels.match(itemsRegExp);\n      if (matchedItems) {\n        matchedItems.forEach(item => {\n          let tagNameMatches = item.match(tagNameRegExp);\n          let sourcesPathMatches = item.match(srcRegExp);\n          if (tagNameMatches && sourcesPathMatches) {\n            pixelsItems.push({\n              tagName: tagNameMatches[0].toUpperCase(),\n              src: sourcesPathMatches[2]\n            });\n          }\n        });\n      }\n    }\n\n    return pixelsItems;\n  }\n\n  function renderPixelElements(pixelsElements) {\n    pixelsElements.forEach((element) => {\n      switch (element.tagName) {\n        case SYNC_TYPES.img:\n          return renderPixelImage(element);\n        case SYNC_TYPES.iframe:\n          return renderPixelIframe(element);\n      }\n    });\n  }\n\n  function renderPixelImage(pixelsItem) {\n    let image = new Image();\n    image.src = pixelsItem.src;\n  }\n\n  function renderPixelIframe(pixelsItem) {\n    let iframe = document.createElement('iframe');\n    iframe.width = 1;\n    iframe.height = 1;\n    iframe.style.display = 'none';\n    iframe.src = pixelsItem.src;\n    if (document.readyState === 'interactive' ||\n      document.readyState === 'complete') {\n      document.body.appendChild(iframe);\n    } else {\n      domReady(() => {\n        document.body.appendChild(iframe);\n      });\n    }\n  }\n\n  function template(strings, ...keys) {\n    return function(...values) {\n      let dict = values[values.length - 1] || {};\n      let result = [strings[0]];\n      keys.forEach(function(key, i) {\n        let value = Number.isInteger(key) ? values[key] : dict[key];\n        result.push(value, strings[i + 1]);\n      });\n      return result.join('');\n    };\n  }\n\n  function _buildMarketplaceUrl(bid) {\n    const params = bid.params;\n    const serverParam = params.server;\n    let regionParam = params.region || 'us';\n    let server;\n\n    if (!MP_SERVER_MAP.hasOwnProperty(regionParam)) {\n      utils.logWarn(`Unknown region '${regionParam}' for AOL bidder.`);\n      regionParam = 'us'; // Default region.\n    }\n\n    if (serverParam) {\n      server = serverParam;\n    } else {\n      server = MP_SERVER_MAP[regionParam];\n    }\n\n    // Set region param, used by AOL analytics.\n    params.region = regionParam;\n\n    return pubapiTemplate({\n      protocol: (document.location.protocol === 'https:') ? 'https' : 'http',\n      host: server,\n      network: params.network,\n      placement: parseInt(params.placement),\n      pageid: params.pageId || 0,\n      sizeid: params.sizeId || 0,\n      alias: params.alias || utils.getUniqueIdentifierStr(),\n      bidfloor: (typeof params.bidFloor !== 'undefined') ?\n        `;bidfloor=${params.bidFloor.toString()}` : '',\n      misc: new Date().getTime() // cache busting\n    });\n  }\n\n  function _buildNexageApiUrl(bid) {\n    let {dcn, pos} = bid.params;\n    let nexageApi = nexageBaseApiTemplate({\n      protocol: (document.location.protocol === 'https:') ? 'https' : 'http',\n      host: bid.params.host || NEXAGE_SERVER\n    });\n    if (dcn && pos) {\n      let ext = '';\n      utils._each(bid.params.ext, (value, key) => {\n        ext += `&${key}=${encodeURIComponent(value)}`;\n      });\n      nexageApi += nexageGetApiTemplate({dcn, pos, ext});\n    }\n    return nexageApi;\n  }\n\n  function _addErrorBidResponse(bid, response = {}) {\n    const bidResponse = bidfactory.createBid(2, bid);\n    bidResponse.bidderCode = BIDDER_CODE;\n    bidResponse.reason = response.nbr;\n    bidResponse.raw = response;\n    bidmanager.addBidResponse(bid.placementCode, bidResponse);\n  }\n\n  function _addBidResponse(bid, response) {\n    let bidData;\n\n    try {\n      bidData = response.seatbid[0].bid[0];\n    } catch (e) {\n      _addErrorBidResponse(bid, response);\n      return;\n    }\n\n    let cpm;\n\n    if (bidData.ext && bidData.ext.encp) {\n      cpm = bidData.ext.encp;\n    } else {\n      cpm = bidData.price;\n\n      if (cpm === null || isNaN(cpm)) {\n        utils.logError('Invalid price in bid response', BIDDER_CODE, bid);\n        _addErrorBidResponse(bid, response);\n        return;\n      }\n    }\n\n    let ad = bidData.adm;\n    if (response.ext && response.ext.pixels) {\n      if (bid.params.userSyncOn === constants.EVENTS.BID_RESPONSE) {\n        dropSyncCookies(response.ext.pixels);\n      } else {\n        ad += response.ext.pixels;\n      }\n    }\n\n    const bidResponse = bidfactory.createBid(1, bid);\n    bidResponse.bidderCode = BIDDER_CODE;\n    bidResponse.ad = ad;\n    bidResponse.cpm = cpm;\n    bidResponse.width = bidData.w;\n    bidResponse.height = bidData.h;\n    bidResponse.creativeId = bidData.crid;\n    bidResponse.pubapiId = response.id;\n    bidResponse.currencyCode = response.cur;\n    if (bidData.dealid) {\n      bidResponse.dealId = bidData.dealid;\n    }\n\n    bidmanager.addBidResponse(bid.placementCode, bidResponse);\n  }\n\n  function _isNexageRequestPost(bid) {\n    if (bid.params.id && bid.params.imp && bid.params.imp[0]) {\n      let imp = bid.params.imp[0];\n      return imp.id && imp.tagid &&\n          ((imp.banner && imp.banner.w && imp.banner.h) ||\n          (imp.video && imp.video.mimes && imp.video.minduration && imp.video.maxduration));\n    }\n  }\n\n  function _callBids(params) {\n    utils._each(params.bids, bid => {\n      let apiUrl;\n      let data = null;\n      let options = {\n        withCredentials: true\n      };\n      let isNexageRequestPost = _isNexageRequestPost(bid);\n      if (bid.params.placement && bid.params.network) {\n        apiUrl = _buildMarketplaceUrl(bid);\n      } else if(bid.params.dcn && bid.params.pos || isNexageRequestPost) {\n        apiUrl = _buildNexageApiUrl(bid);\n        if (isNexageRequestPost) {\n          data = bid.params;\n          options.customHeaders = {\n            'x-openrtb-version': '2.2'\n          };\n          options.method = 'POST';\n          options.contentType = 'application/json';\n        }\n      }\n      if (apiUrl) {\n        ajax(apiUrl, response => {\n          // Needs to be here in case bidderSettings are defined after requestBids() is called\n          if (showCpmAdjustmentWarning &&\n            pbjs.bidderSettings && pbjs.bidderSettings.aol &&\n            typeof pbjs.bidderSettings.aol.bidCpmAdjustment === 'function'\n          ) {\n            utils.logWarn(\n              'bidCpmAdjustment is active for the AOL adapter. ' +\n              'As of Prebid 0.14, AOL can bid in net – please contact your accounts team to enable.'\n            );\n          }\n          showCpmAdjustmentWarning = false; // warning is shown at most once\n\n          if (!response && response.length <= 0) {\n            utils.logError('Empty bid response', BIDDER_CODE, bid);\n            _addErrorBidResponse(bid, response);\n            return;\n          }\n\n          try {\n            response = JSON.parse(response);\n          } catch (e) {\n            utils.logError('Invalid JSON in bid response', BIDDER_CODE, bid);\n            _addErrorBidResponse(bid, response);\n            return;\n          }\n\n          _addBidResponse(bid, response);\n\n        }, data, options);\n      }\n    });\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = AolAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/aol.js","import { getBidRequest } from '../utils.js';\n\nvar CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar adloader = require('../adloader.js');\nvar bidmanager = require('../bidmanager.js');\nvar bidfactory = require('../bidfactory.js');\nvar Adapter = require('./adapter.js');\n\nvar AppNexusAdapter;\nAppNexusAdapter = function AppNexusAdapter() {\n  var baseAdapter = Adapter.createNew('appnexus');\n  var usersync = false;\n\n  baseAdapter.callBids = function (params) {\n    //var bidCode = baseAdapter.getBidderCode();\n\n    var anArr = params.bids;\n\n    //var bidsCount = anArr.length;\n\n    //set expected bids count for callback execution\n    //bidmanager.setExpectedBidsCount(bidCode, bidsCount);\n\n    for (var i = 0; i < anArr.length; i++) {\n      var bidRequest = anArr[i];\n      var callbackId = bidRequest.bidId;\n      adloader.loadScript(buildJPTCall(bidRequest, callbackId));\n\n      //store a reference to the bidRequest from the callback id\n      //bidmanager.pbCallbackMap[callbackId] = bidRequest;\n    }\n  };\n\n  function buildJPTCall(bid, callbackId) {\n\n    //determine tag params\n    var placementId = utils.getBidIdParameter('placementId', bid.params);\n\n    //memberId will be deprecated, use member instead\n    var memberId = utils.getBidIdParameter('memberId', bid.params);\n    var member = utils.getBidIdParameter('member', bid.params);\n    var inventoryCode = utils.getBidIdParameter('invCode', bid.params);\n    var query = utils.getBidIdParameter('query', bid.params);\n    var referrer = utils.getBidIdParameter('referrer', bid.params);\n    var altReferrer = utils.getBidIdParameter('alt_referrer', bid.params);\n\n    //build our base tag, based on if we are http or https\n\n    var jptCall = 'http' + (document.location.protocol === 'https:' ? 's://secure.adnxs.com/jpt?' : '://ib.adnxs.com/jpt?');\n\n    jptCall = utils.tryAppendQueryString(jptCall, 'callback', 'pbjs.handleAnCB');\n    jptCall = utils.tryAppendQueryString(jptCall, 'callback_uid', callbackId);\n    jptCall = utils.tryAppendQueryString(jptCall, 'psa', '0');\n    jptCall = utils.tryAppendQueryString(jptCall, 'id', placementId);\n    if (member) {\n      jptCall = utils.tryAppendQueryString(jptCall, 'member', member);\n    } else if (memberId) {\n      jptCall = utils.tryAppendQueryString(jptCall, 'member', memberId);\n      utils.logMessage('appnexus.callBids: \"memberId\" will be deprecated soon. Please use \"member\" instead');\n    }\n\n    jptCall = utils.tryAppendQueryString(jptCall, 'code', inventoryCode);\n    jptCall = utils.tryAppendQueryString(jptCall, 'traffic_source_code', (utils.getBidIdParameter('trafficSourceCode', bid.params)));\n\n    //sizes takes a bit more logic\n    var sizeQueryString = '';\n    var parsedSizes = utils.parseSizesInput(bid.sizes);\n\n    //combine string into proper querystring for impbus\n    var parsedSizesLength = parsedSizes.length;\n    if (parsedSizesLength > 0) {\n      //first value should be \"size\"\n      sizeQueryString = 'size=' + parsedSizes[0];\n      if (parsedSizesLength > 1) {\n        //any subsequent values should be \"promo_sizes\"\n        sizeQueryString += '&promo_sizes=';\n        for (var j = 1; j < parsedSizesLength; j++) {\n          sizeQueryString += parsedSizes[j] += ',';\n        }\n\n        //remove trailing comma\n        if (sizeQueryString && sizeQueryString.charAt(sizeQueryString.length - 1) === ',') {\n          sizeQueryString = sizeQueryString.slice(0, sizeQueryString.length - 1);\n        }\n      }\n    }\n\n    if (sizeQueryString) {\n      jptCall += sizeQueryString + '&';\n    }\n\n    //this will be deprecated soon\n    var targetingParams = utils.parseQueryStringParameters(query);\n\n    if (targetingParams) {\n      //don't append a & here, we have already done it in parseQueryStringParameters\n      jptCall += targetingParams;\n    }\n\n    //append custom attributes:\n    var paramsCopy = Object.assign({}, bid.params);\n\n    //delete attributes already used\n    delete paramsCopy.placementId;\n    delete paramsCopy.memberId;\n    delete paramsCopy.invCode;\n    delete paramsCopy.query;\n    delete paramsCopy.referrer;\n    delete paramsCopy.alt_referrer;\n    delete paramsCopy.member;\n\n    //get the reminder\n    var queryParams = utils.parseQueryStringParameters(paramsCopy);\n\n    //append\n    if (queryParams) {\n      jptCall += queryParams;\n    }\n\n    //append referrer\n    if (referrer === '') {\n      referrer = utils.getTopWindowUrl();\n    }\n\n    jptCall = utils.tryAppendQueryString(jptCall, 'referrer', referrer);\n    jptCall = utils.tryAppendQueryString(jptCall, 'alt_referrer', altReferrer);\n\n    //remove the trailing \"&\"\n    if (jptCall.lastIndexOf('&') === jptCall.length - 1) {\n      jptCall = jptCall.substring(0, jptCall.length - 1);\n    }\n\n    // @if NODE_ENV='debug'\n    utils.logMessage('jpt request built: ' + jptCall);\n\n    // @endif\n\n    //append a timer here to track latency\n    bid.startTime = new Date().getTime();\n\n    return jptCall;\n\n  }\n\n  //expose the callback to the global object:\n  pbjs.handleAnCB = function (jptResponseObj) {\n\n    var bidCode;\n\n    if (jptResponseObj && jptResponseObj.callback_uid) {\n\n      var responseCPM;\n      var id = jptResponseObj.callback_uid;\n      var placementCode = '';\n      var bidObj = getBidRequest(id);\n      if (bidObj) {\n\n        bidCode = bidObj.bidder;\n\n        placementCode = bidObj.placementCode;\n\n        //set the status\n        bidObj.status = CONSTANTS.STATUS.GOOD;\n      }\n\n      // @if NODE_ENV='debug'\n      utils.logMessage('JSONP callback function called for ad ID: ' + id);\n\n      // @endif\n      var bid = [];\n      if (jptResponseObj.result && jptResponseObj.result.cpm && jptResponseObj.result.cpm !== 0) {\n        responseCPM = parseInt(jptResponseObj.result.cpm, 10);\n\n        //CPM response from /jpt is dollar/cent multiplied by 10000\n        //in order to avoid using floats\n        //switch CPM to \"dollar/cent\"\n        responseCPM = responseCPM / 10000;\n\n        //store bid response\n        //bid status is good (indicating 1)\n        var adId = jptResponseObj.result.creative_id;\n        bid = bidfactory.createBid(1, bidObj);\n        bid.creative_id = adId;\n        bid.bidderCode = bidCode;\n        bid.cpm = responseCPM;\n        bid.adUrl = jptResponseObj.result.ad;\n        bid.width = jptResponseObj.result.width;\n        bid.height = jptResponseObj.result.height;\n        bid.dealId = jptResponseObj.result.deal_id;\n\n        bidmanager.addBidResponse(placementCode, bid);\n\n      } else {\n        //no response data\n        // @if NODE_ENV='debug'\n        utils.logMessage('No prebid response from AppNexus for placement code ' + placementCode);\n\n        // @endif\n        //indicate that there is no bid for this placement\n        bid = bidfactory.createBid(2, bidObj);\n        bid.bidderCode = bidCode;\n        bidmanager.addBidResponse(placementCode, bid);\n      }\n\n      if (!usersync) {\n        var iframe = utils.createInvisibleIframe();\n        iframe.src = '//acdn.adnxs.com/ib/static/usersync/v3/async_usersync.html';\n        try {\n          document.body.appendChild(iframe);\n        } catch (error) {\n          utils.logError(error);\n        }\n        usersync = true;\n      }\n\n\n    } else {\n      //no response data\n      // @if NODE_ENV='debug'\n      utils.logMessage('No prebid response for placement %%PLACEMENT%%');\n\n      // @endif\n\n    }\n\n  };\n\n  return {\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode,\n    createNew: AppNexusAdapter.createNew,\n    buildJPTCall: buildJPTCall\n  };\n};\n\nAppNexusAdapter.createNew = function () {\n  return new AppNexusAdapter();\n};\n\nmodule.exports = AppNexusAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/appnexus.js","import Adapter from 'src/adapters/adapter';\nimport { Renderer } from 'src/Renderer';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport { ajax } from 'src/ajax';\nimport { STATUS } from 'src/constants';\n\nconst ENDPOINT = '//ib.adnxs.com/ut/v2/prebid';\nconst VIDEO_TARGETING = ['id', 'mimes', 'minduration', 'maxduration',\n  'startdelay', 'skippable', 'playback_method', 'frameworks'];\nconst USER_PARAMS = [\n  'age', 'external_uid', 'segments', 'gender', 'dnt', 'language'\n];\n\n/**\n * Bidder adapter for /ut endpoint. Given the list of all ad unit tag IDs,\n * sends out a bid request. When a bid response is back, registers the bid\n * to Prebid.js. This adapter supports alias bidding.\n */\nfunction AppnexusAstAdapter() {\n\n  let baseAdapter = Adapter.createNew('appnexusAst');\n  let bidRequests = {};\n  let usersync = false;\n\n  /* Prebid executes this function when the page asks to send out bid requests */\n  baseAdapter.callBids = function(bidRequest) {\n    const bids = bidRequest.bids || [];\n    var member = 0;\n    let userObj;\n    const tags = bids\n      .filter(bid => valid(bid))\n      .map(bid => {\n        // map request id to bid object to retrieve adUnit code in callback\n        bidRequests[bid.bidId] = bid;\n\n        let tag = {};\n        tag.sizes = getSizes(bid.sizes);\n        tag.primary_size = tag.sizes[0];\n        tag.uuid = bid.bidId;\n        if(bid.params.placementId) {\n          tag.id = parseInt(bid.params.placementId, 10);\n        } else {\n          tag.code = bid.params.invCode;\n        }\n        tag.allow_smaller_sizes = bid.params.allowSmallerSizes || false;\n        tag.prebid = true;\n        tag.disable_psa = true;\n        member = parseInt(bid.params.member, 10);\n        if (bid.params.reserve) {\n          tag.reserve = bid.params.reserve;\n        }\n        if (bid.params.position) {\n          tag.position = {'above': 1, 'below': 2}[bid.params.position] || 0;\n        }\n        if (bid.params.trafficSourceCode) {\n          tag.traffic_source_code = bid.params.trafficSourceCode;\n        }\n        if (bid.params.privateSizes) {\n          tag.private_sizes = getSizes(bid.params.privateSizes);\n        }\n        if (bid.params.supplyType) {\n          tag.supply_type = bid.params.supplyType;\n        }\n        if (bid.params.pubClick) {\n          tag.pubclick = bid.params.pubClick;\n        }\n        if (bid.params.extInvCode) {\n          tag.ext_inv_code = bid.params.extInvCode;\n        }\n        if (bid.params.externalImpId) {\n          tag.external_imp_id = bid.params.externalImpId;\n        }\n        if (!utils.isEmpty(bid.params.keywords)) {\n          tag.keywords = getKeywords(bid.params.keywords);\n        }\n\n        if (bid.mediaType === 'video') {tag.require_asset_url = true;}\n        if (bid.params.video) {\n          tag.video = {};\n          // place any valid video params on the tag\n          Object.keys(bid.params.video)\n            .filter(param => VIDEO_TARGETING.includes(param))\n            .forEach(param => tag.video[param] = bid.params.video[param]);\n        }\n\n        if (bid.params.user) {\n          userObj = {};\n          Object.keys(bid.params.user)\n            .filter(param => USER_PARAMS.includes(param))\n            .forEach(param => userObj[param] = bid.params.user[param]);\n        }\n\n        return tag;\n      });\n\n    if (!utils.isEmpty(tags)) {\n      const payloadJson = {tags: [...tags], user: userObj};\n      if (member > 0) {\n        payloadJson.member_id = member;\n      }\n      const payload = JSON.stringify(payloadJson);\n      ajax(ENDPOINT, handleResponse, payload, {\n        contentType: 'text/plain',\n        withCredentials : true\n      });\n    }\n  };\n\n  /* Notify Prebid of bid responses so bids can get in the auction */\n  function handleResponse(response) {\n    let parsed;\n\n    try {\n      parsed = JSON.parse(response);\n    } catch (error) {\n      utils.logError(error);\n    }\n\n    if (!parsed || parsed.error) {\n      let errorMessage = `in response for ${baseAdapter.getBidderCode()} adapter`;\n      if (parsed && parsed.error) {errorMessage += `: ${parsed.error}`;}\n      utils.logError(errorMessage);\n\n      // signal this response is complete\n      Object.keys(bidRequests)\n        .map(bidId => bidRequests[bidId].placementCode)\n        .forEach(placementCode => {\n          bidmanager.addBidResponse(placementCode, createBid(STATUS.NO_BID));\n        });\n      return;\n    }\n\n    parsed.tags.forEach(tag => {\n      const ad = getRtbBid(tag);\n      const cpm = ad && ad.cpm;\n      const type = ad && ad.ad_type;\n\n      let status;\n      if (cpm !== 0 && (type === 'banner' || type === 'video' || type === 'video-outstream')) {\n        status = STATUS.GOOD;\n      } else {\n        status = STATUS.NO_BID;\n      }\n\n      if (type && (type !== 'banner' && type !== 'video' && type !== 'video-outstream')) {\n        utils.logError(`${type} ad type not supported`);\n      }\n\n      tag.bidId = tag.uuid;  // bidfactory looks for bidId on requested bid\n      const bid = createBid(status, tag);\n      if (type === 'video') bid.mediaType = 'video';\n      if (type === 'video-outstream') bid.mediaType = 'video-outstream';\n      const placement = bidRequests[bid.adId].placementCode;\n      bidmanager.addBidResponse(placement, bid);\n    });\n\n    if (!usersync) {\n      const iframe = utils.createInvisibleIframe();\n      iframe.src = '//acdn.adnxs.com/ib/static/usersync/v3/async_usersync.html';\n      try {\n        document.body.appendChild(iframe);\n      } catch (error) {\n        utils.logError(error);\n      }\n      usersync = true;\n    }\n  }\n\n  /* Check that a bid has required paramters */\n  function valid(bid) {\n    if (bid.params.placementId || bid.params.member && bid.params.invCode) {\n      return bid;\n    } else {\n      utils.logError('bid requires placementId or (member and invCode) params');\n    }\n  }\n\n  /* Turn keywords parameter into ut-compatible format */\n  function getKeywords(keywords) {\n    let arrs = [];\n\n    utils._each(keywords, (v, k) => {\n      if (utils.isArray(v)) {\n        let values = [];\n        utils._each(v, (val) => {\n          val = utils.getValueString('keywords.' + k, val);\n          if (val) {values.push(val);}\n        });\n        v = values;\n      } else {\n        v = utils.getValueString('keywords.' + k, v);\n        if (utils.isStr(v)) {v = [v];}\n        else {return;} // unsuported types - don't send a key\n      }\n      arrs.push({key: k, value: v});\n    });\n\n    return arrs;\n  }\n\n  /* Turn bid request sizes into ut-compatible format */\n  function getSizes(requestSizes) {\n    let sizes = [];\n    let sizeObj = {};\n\n    if (utils.isArray(requestSizes) && requestSizes.length === 2 &&\n       !utils.isArray(requestSizes[0])) {\n      sizeObj.width = parseInt(requestSizes[0], 10);\n      sizeObj.height = parseInt(requestSizes[1], 10);\n      sizes.push(sizeObj);\n    } else if (typeof requestSizes === 'object') {\n      for (let i = 0; i < requestSizes.length; i++) {\n        let size = requestSizes[i];\n        sizeObj = {};\n        sizeObj.width = parseInt(size[0], 10);\n        sizeObj.height = parseInt(size[1], 10);\n        sizes.push(sizeObj);\n      }\n    }\n\n    return sizes;\n  }\n\n  function getRtbBid(tag) {\n    return tag && tag.ads && tag.ads.length && tag.ads.find(ad => ad.rtb);\n  }\n\n  function outstreamRender(bid) {\n    window.ANOutstreamVideo.renderAd({\n      tagId: bid.adResponse.tag_id,\n      sizes: [bid.getSize().split('x')],\n      targetId: bid.adUnitCode, // target div id to render video\n      uuid: bid.adResponse.uuid,\n      adResponse: bid.adResponse,\n      rendererOptions: bid.renderer.getConfig()\n    }, handleOutstreamRendererEvents.bind(bid));\n  }\n\n  function onOutstreamRendererLoaded() {\n    // setup code for renderer, if any\n  }\n\n  function handleOutstreamRendererEvents(id, eventName) {\n    const bid = this;\n    bid.renderer.handleVideoEvent({ id, eventName });\n  }\n\n  /* Create and return a bid object based on status and tag */\n  function createBid(status, tag) {\n    const ad = getRtbBid(tag);\n    let bid = bidfactory.createBid(status, tag);\n    bid.code = baseAdapter.getBidderCode();\n    bid.bidderCode = baseAdapter.getBidderCode();\n\n    if (ad && status === STATUS.GOOD) {\n      bid.cpm = ad.cpm;\n      bid.creative_id = ad.creative_id;\n      bid.dealId = ad.deal_id;\n\n      if (ad.rtb.video) {\n        bid.width = ad.rtb.video.player_width;\n        bid.height = ad.rtb.video.player_height;\n        bid.vastUrl = ad.rtb.video.asset_url;\n        bid.descriptionUrl = ad.rtb.video.asset_url;\n        if (ad.renderer_url) {\n\n          // outstream video\n\n          bid.adResponse = tag;\n          bid.renderer = Renderer.install({\n            id: ad.renderer_id,\n            url: ad.renderer_url,\n            config: { adText: `AppNexus Outstream Video Ad via Prebid.js` },\n            callback: () => onOutstreamRendererLoaded.call(null, bid)\n          });\n\n          try {\n            bid.renderer.setRender(outstreamRender);\n          } catch (err) {\n            utils.logWarning('Prebid Error calling setRender on renderer', err);\n          }\n\n          bid.renderer.setEventHandlers({\n            impression: () => utils.logMessage('AppNexus outstream video impression event'),\n            loaded: () => utils.logMessage('AppNexus outstream video loaded event'),\n            ended: () => {\n              utils.logMessage('AppNexus outstream renderer video event');\n              document.querySelector(`#${bid.adUnitCode}`).style.display = 'none';\n            }\n          });\n\n          bid.adResponse.ad = bid.adResponse.ads[0];\n          bid.adResponse.ad.video = bid.adResponse.ad.rtb.video;\n        }\n      } else {\n        bid.width = ad.rtb.banner.width;\n        bid.height = ad.rtb.banner.height;\n        bid.ad = ad.rtb.banner.content;\n        try {\n          const url = ad.rtb.trackers[0].impression_urls[0];\n          const tracker = utils.createTrackPixelHtml(url);\n          bid.ad += tracker;\n        } catch (error) {\n          utils.logError('Error appending tracking pixel', error);\n        }\n      }\n    }\n\n    return bid;\n  }\n\n  return {\n    createNew: AppnexusAstAdapter.createNew,\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode,\n  };\n\n}\n\nAppnexusAstAdapter.createNew = function() {\n  return new AppnexusAstAdapter();\n};\n\nmodule.exports = AppnexusAstAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/appnexusAst.js","import { loadScript } from 'src/adloader';\nimport * as utils from 'src/utils';\n\nexport function Renderer(options) {\n  const { url, config, id, callback } = options;\n  this.url = url;\n  this.config = config;\n  this.callback = callback;\n  this.handlers = {};\n  this.id = id;\n\n  // we expect to load a renderer url once only so cache the request to load script\n  loadScript(url, callback, true);\n}\n\nRenderer.install = function({ url, config, id, callback }) {\n  return new Renderer({ url, config, id, callback });\n};\n\nRenderer.prototype.getConfig = function() {\n  return this.config;\n};\n\nRenderer.prototype.setRender = function(fn) {\n  this.render = fn;\n};\n\nRenderer.prototype.setEventHandlers = function(handlers) {\n  this.handlers = handlers;\n};\n\nRenderer.prototype.handleVideoEvent = function({ id, eventName }) {\n  if (typeof this.handlers[eventName] === 'function') {\n    this.handlers[eventName]();\n  }\n\n  utils.logMessage(`Prebid Renderer event for id ${id} type ${eventName}`);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/Renderer.js","import Adapter from 'src/adapters/adapter';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport { ajax } from 'src/ajax';\nimport { STATUS } from 'src/constants';\n\nconst ENDPOINT = '//reachms.bfmio.com/bid.json?exchange_id=';\n\nfunction BeachfrontAdapter() {\n  var baseAdapter = Adapter.createNew('beachfront');\n\n  baseAdapter.callBids = function (bidRequests) {\n    const bids = bidRequests.bids || [];\n    bids.forEach(function(bid) {\n      var bidRequest = getBidRequest(bid);\n      var RTBDataParams = prepareAndSaveRTBRequestParams(bid);\n      if (!RTBDataParams) {\n        var error = \"No bid params\";\n        utils.logError(error);\n        if (bid && bid.placementCode) {\n          bidmanager.addBidResponse(bid.placementCode, createBid(bid, STATUS.NO_BID));\n        }\n        return;\n      }\n      var BID_URL = ENDPOINT + RTBDataParams.appId;\n      ajax(BID_URL, handleResponse(bidRequest), JSON.stringify(RTBDataParams), {\n        contentType: 'text/plain',\n        withCredentials: true\n      });\n    });\n\n  };\n\n  function getBidRequest(bid) {\n    if (!bid || !bid.params || !bid.params.appId) {\n      return;\n    }\n\n    var bidRequest = bid;\n    bidRequest.width = parseInt(bid.sizes[0], 10) || undefined;\n    bidRequest.height = parseInt(bid.sizes[1], 10) || undefined;\n    return bidRequest;\n  }\n\n  function prepareAndSaveRTBRequestParams(bid) {\n    if (!bid || !bid.params || !bid.params.appId || !bid.params.bidfloor) {\n      return;\n    }\n\n    function fetchDeviceType() {\n      return ((/(ios|ipod|ipad|iphone|android)/i).test(global.navigator.userAgent) ? 1 : ((/(smart[-]?tv|hbbtv|appletv|googletv|hdmi|netcast\\.tv|viera|nettv|roku|\\bdtv\\b|sonydtv|inettvbrowser|\\btv\\b)/i).test(global.navigator.userAgent) ? 1 : 2));\n    }\n\n    var bidRequestObject =  {\n      isPrebid: true,\n      appId: bid.params.appId,\n      domain: document.location.hostname,\n      imp:[{\n        video:{},\n        bidfloor: bid.params.bidfloor\n      }],\n      site:{\n        page: utils.getTopWindowLocation().host\n      },\n      device:{\n        ua: navigator.userAgent,\n        devicetype: fetchDeviceType()\n      },\n      cur:[\"USD\"]\n    };\n    return bidRequestObject;\n  }\n\n  /* Notify Prebid of bid responses so bids can get in the auction */\n  function handleResponse(bidRequest) {\n    return function(response) {\n      var parsed;\n      if (response) {\n        try {\n          parsed = JSON.parse(response);\n        } catch (error) {\n          utils.logError(error);\n        }\n      } else {\n        utils.logWarn(\"No bid response\");\n      }\n\n      if (!parsed || parsed.error || !parsed.url || !parsed.bidPrice) {\n        utils.logWarn(\"No Valid Bid\");\n        bidmanager.addBidResponse(bidRequest.placementCode, createBid(bidRequest, STATUS.NO_BID));\n        return;\n      }\n\n      var newBid = {};\n      newBid.price = parsed.bidPrice;\n      newBid.url = parsed.url;\n      newBid.bidId = bidRequest.bidId;\n      bidmanager.addBidResponse(bidRequest.placementCode, createBid(bidRequest, STATUS.GOOD, newBid));\n    };\n  }\n\n  function createBid(bidRequest, status, tag) {\n    var bid = bidfactory.createBid(status, tag);\n    bid.code = baseAdapter.getBidderCode();\n    bid.bidderCode = bidRequest.bidder;\n    if (!tag || status !== STATUS.GOOD) {\n      return bid;\n    }\n\n    bid.cpm = tag.price;\n    bid.creative_id = tag.cmpId;\n    bid.width = bidRequest.width;\n    bid.height = bidRequest.height;\n    bid.descriptionUrl = tag.url;\n    bid.vastUrl = tag.url;\n    bid.mediaType = 'video';\n\n    return bid;\n  }\n\n  return {\n    createNew: BeachfrontAdapter.createNew,\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode\n  };\n}\n\nBeachfrontAdapter.createNew = function () {\n  return new BeachfrontAdapter();\n};\n\nmodule.exports = BeachfrontAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/beachfront.js","/**\n * @file AudienceNetwork adapter.\n */\nimport { ajax } from '../ajax';\nimport { createBid } from '../bidfactory';\nimport { addBidResponse } from '../bidmanager';\nimport { STATUS } from '../constants.json';\nimport { format } from '../url';\nimport { logError } from '../utils';\nimport { createNew } from './adapter';\n\nconst { setBidderCode, getBidderCode } = createNew('audienceNetwork');\n\n/**\n * Does this bid request contain valid parameters?\n * @param {Object} bid\n * @returns {Boolean}\n */\nconst validateBidRequest = bid =>\n  typeof bid.params === 'object' &&\n  typeof bid.params.placementId === 'string' &&\n  bid.params.placementId.length > 0 &&\n  Array.isArray(bid.sizes) && bid.sizes.length > 0;\n\n/**\n * Return a copy of a bid with slot sizes flattened and filtered\n * @param {Object} bid\n * @returns {Object} copy of bid\n */\nconst flattenBidRequestSizes = bid => {\n  const sizes = Array.isArray(bid.sizes) && bid.sizes\n    .map(flattenSize)\n    .filter(isValidSize);\n  return Object.assign({}, bid, { sizes });\n};\n\n/**\n * Flattens a 2-element [W, H] array as a 'WxH' string,\n * otherwise passes value through.\n * @params {Array|String} size\n * @returns {String}\n */\nconst flattenSize = size =>\n  (Array.isArray(size) && size.length === 2) ? `${size[0]}x${size[1]}` : size;\n\n/**\n * Is this a valid slot size?\n * @param {String} size\n * @returns  {Boolean}\n */\nconst isValidSize = size => ['native', 'fullwidth', '300x250', '320x50'].includes(size);\n\n/**\n * Does the search part of the URL contain \"anhb_testmode\"\n * and therefore indicate testmode should be used?\n * @returns {String} \"true\" or \"false\"\n */\nconst isTestmode = () => Boolean(\n  window && window.location &&\n  typeof window.location.search === 'string' &&\n  window.location.search.indexOf('anhb_testmode') !== -1\n).toString();\n\n/**\n * Parse JSON-as-string into an Object, default to empty.\n * @param {String} JSON-as-string\n * @returns {Object}\n */\nconst parseJson = jsonAsString => {\n  let data = {};\n  try {\n    data = JSON.parse(jsonAsString);\n  } catch (err) {}\n  return data;\n};\n\n/**\n * Is this a native advert size?\n * @param {String} size\n * @returns {Boolean}\n */\nconst isNative = (size) => ['native', 'fullwidth'].includes(size);\n\n/**\n * Generate ad HTML for injection into an iframe\n * @param {String} placementId\n * @param {String} size\n * @param {String} bidId\n * @returns {String} HTML\n */\nconst createAdHtml = (placementId, size, bidId) => {\n  const nativeStyle = isNative(size) ? '<script>window.onload=function(){if(parent){var o=document.getElementsByTagName(\"head\")[0];var s=parent.document.getElementsByTagName(\"style\");for(var i=0;i<s.length;i++)o.appendChild(s[i].cloneNode(true));}}</script>' : '';\n  const nativeContainer = isNative(size) ? '<div class=\"thirdPartyRoot\"><a class=\"fbAdLink\"><div class=\"fbAdMedia thirdPartyMediaClass\"></div><div class=\"fbAdSubtitle thirdPartySubtitleClass\"></div><div class=\"fbDefaultNativeAdWrapper\"><div class=\"fbAdCallToAction thirdPartyCallToActionClass\"></div><div class=\"fbAdTitle thirdPartyTitleClass\"></div></div></a></div>' : '';\n  return `<html><head>${nativeStyle}</head><body><div style=\"display:none;position:relative;\">\n<script>var data = {placementid:'${placementId}',format:'${size}',bidid:'${bidId}',onAdLoaded:function(e){e.style.display = 'block';},onAdError:function(c,m){console.log('Audience Network error (' + c + ') ' + m);}};\n(function(a,b,c){var d='https://www.facebook.com',e='https://connect.facebook.net/en_US/fbadnw55.js',f={iframeLoaded:true,xhrLoaded:true},g=5,h=a.data,i=0,j=function(ea){if(ea==null)throw new Error();return ea;},k=function(ea){if(ea instanceof HTMLElement)return ea;throw new Error();},l=function(){if(Date.now){return Date.now();}else return +new Date();},m=function(ea){if(++i>g)return;var fa=d+'/audience_network/client_event',ga={cb:l(),event_name:'ADNW_ADERROR',ad_pivot_type:'audience_network_mobile_web',sdk_version:'5.5.web',app_id:h.placementid.split('_')[0],publisher_id:h.placementid.split('_')[1],error_message:ea},ha=[];for(var ia in ga)ha.push(encodeURIComponent(ia)+'='+encodeURIComponent(ga[ia]));var ja=fa+'?'+ha.join('&'),ka=new XMLHttpRequest();ka.open('GET',ja,true);ka.send();},n=function(){if(b.currentScript){return b.currentScript;}else{var ea=b.getElementsByTagName('script');return ea[ea.length-1];}},o=function(ea){try{return ea.document.referrer;}catch(fa){}return '';},p=function(){var ea=a;try{while(ea!=ea.parent){ea.parent.origin;ea=ea.parent;}}catch(fa){}return ea;},q=function(ea){var fa=ea.indexOf('/',ea.indexOf('://')+3);if(fa===-1)return ea;return ea.substring(0,fa);},r=function(ea){return ea.location.href||o(ea);},s=function(ea,fa){if(ea.sdkLoaded)return;var ga=fa.createElement('iframe');ga.name='fbadnw';ga.style.display='none';j(fa.body).appendChild(ga);ga.contentWindow.addEventListener('error',function(event){m(event.message);},false);var ha=ga.contentDocument.createElement('script');ha.src=e;ha.async=true;j(ga.contentDocument.body).appendChild(ha);ea.sdkLoaded=true;},t=function(ea){var fa=/^https?:\\\\/\\\\/www\\\\.google(\\\\.com?)?.\\\\w{2,3}$/;return !!ea.match(fa);},u=function(ea){return ea.endsWith('cdn.ampproject.org');},v=function(){var ea=c.ancestorOrigins||[],fa=ea[ea.length-1]||c.origin,ga=ea[ea.length-2]||c.origin;if(t(fa)&&u(ga)){return q(ga);}else return q(fa);},w=function(ea){try{return JSON.parse(ea);}catch(fa){m(fa.message);return null;}},x=function(ea,fa,ga){if(!ea.iframe){var ha=ga.createElement('iframe');ha.src=d+'/audiencenetwork/iframe/';ha.style.display='none';j(ga.body).appendChild(ha);ea.iframe=ha;ea.iframeAppendedTime=l();ea.iframeData={};}fa.iframe=j(ea.iframe);fa.iframeData=ea.iframeData;fa.tagJsIframeAppendedTime=ea.iframeAppendedTime||0;},y=function(ea){var fa=d+'/audiencenetwork/xhr/?sdk=5.5.web';for(var ga in ea)if(typeof ea[ga]!=='function')fa+='&'+ga+'='+encodeURIComponent(ea[ga]);var ha=new XMLHttpRequest();ha.open('GET',fa,true);ha.withCredentials=true;ha.onreadystatechange=function(){if(ha.readyState===4){var ia=w(ha.response);if(ia)ea.events.push({name:'xhrLoaded',source:ea.iframe.contentWindow,data:ia,postMessageTimestamp:l(),receivedTimestamp:l()});}};ha.send();},z=function(ea,fa){var ga=d+'/audiencenetwork/xhriframe/?sdk=5.5.web';for(var ha in fa)if(typeof fa[ha]!=='function')ga+='&'+ha+'='+encodeURIComponent(fa[ha]);var ia=b.createElement('iframe');ia.src=ga;ia.style.display='none';j(b.body).appendChild(ia);fa.iframe=ia;fa.iframeData={};fa.tagJsIframeAppendedTime=l();},aa=function(ea){var fa=function(event){try{var ia=event.data;if(ia.name in f)ea.events.push({name:ia.name,source:event.source,data:ia.data});}catch(ha){}},ga=j(ea.iframe).contentWindow.parent;ga.addEventListener('message',fa,false);},ba=function(ea){if(ea.context)return true;try{return !!JSON.parse(decodeURI(ea.name)).ampcontextVersion;}catch(fa){return false;}},ca=function(ea){var fa=l(),ga=p(),ha=k(n().parentElement),ia=ga!=a.top,ja=ga.$sf&&ga.$sf.ext,ka=r(ga);ga.ADNW=ga.ADNW||{};ga.ADNW.v55=ga.ADNW.v55||{ads:[]};var la=ga.ADNW.v55;s(la,ga.document);var ma={amp:ba(ga),events:[],tagJsInitTime:fa,rootElement:ha,iframe:null,tagJsIframeAppendedTime:la.iframeAppendedTime||0,url:ka,domain:v(),channel:q(r(ga)),width:screen.width,height:screen.height,pixelratio:a.devicePixelRatio,placementindex:la.ads.length,crossdomain:ia,safeframe:!!ja,placementid:h.placementid,format:h.format||'300x250',testmode:!!h.testmode,onAdLoaded:h.onAdLoaded,onAdError:h.onAdError};if(h.bidid)ma.bidid=h.bidid;if(ia){z(la,ma);}else{x(la,ma,ga.document);y(ma);}aa(ma);ma.rootElement.dataset.placementid=ma.placementid;la.ads.push(ma);};try{ca();}catch(da){m(da.message||da);throw da;}})(window,document,location);\n</script>\n${nativeContainer}</div></body></html>`;\n};\n\n/**\n * Creates a \"good\" Bid object with the given bid ID and CPM.\n * @param {String} placementId\n * @param {String} bidId\n * @param {String} size\n * @param {Number} cpmCents\n * @returns {Object} Bid\n */\nconst createSuccessBidResponse = (placementId, size, bidId, cpmCents) => {\n  const bid = createBid(STATUS.GOOD, { bidId });\n  // Prebid attributes\n  bid.bidderCode = getBidderCode();\n  bid.cpm = cpmCents / 100;\n  bid.ad = createAdHtml(placementId, size, bidId);\n  if (!isNative(size)) {\n    [bid.width, bid.height] = size.split('x').map(Number);\n  }\n  // Audience Network attributes\n  bid.hb_bidder = 'fan';\n  bid.fb_bidid = bidId;\n  bid.fb_format = size;\n  bid.fb_placementid = placementId;\n  return bid;\n};\n\n/**\n * Creates a \"no bid\" Bid object.\n * @returns {Object} Bid\n */\nconst createFailureBidResponse = () => {\n  const bid = createBid(STATUS.NO_BID);\n  bid.bidderCode = getBidderCode();\n  return bid;\n};\n\n/**\n * Fetch bids for given parameters.\n * @param {Object} bidRequest\n * @param {Array} params.bids - list of bids\n * @param {String} params.bids[].placementCode - Prebid placement identifier\n * @param {Object} params.bids[].params\n * @param {String} params.bids[].params.placementId - Audience Network placement identifier\n * @param {Array} params.bids[].sizes - list of accepted advert sizes\n * @param {Array|String} params.bids[].sizes[] - one of 'native', '300x250', '300x50', [300, 250], [300, 50]\n * @returns {void}\n */\nconst callBids = bidRequest => {\n  // Build lists of adUnitCodes, placementids and adformats\n  const adUnitCodes = [];\n  const placementids = [];\n  const adformats = [];\n  bidRequest.bids\n    .map(flattenBidRequestSizes)\n    .filter(validateBidRequest)\n    .forEach( bid => bid.sizes.forEach( size => {\n      adUnitCodes.push(bid.placementCode);\n      placementids.push(bid.params.placementId);\n      adformats.push(size);\n    }));\n\n  if (placementids.length) {\n    // Build URL\n    const testmode = isTestmode();\n    const url = format({\n      protocol: 'https',\n      host: 'an.facebook.com',\n      pathname: '/v2/placementbid.json',\n      search: {\n        sdk: '5.5.web',\n        testmode,\n        placementids,\n        adformats\n      }\n    });\n    // Request\n    ajax(url, res => {\n      // Handle response\n      const data = parseJson(res);\n      if (data.errors && data.errors.length) {\n        const noBid = createFailureBidResponse();\n        adUnitCodes.forEach( adUnitCode => addBidResponse(adUnitCode, noBid) );\n        data.errors.forEach(logError);\n      } else {\n        // For each placementId in bids Object\n        Object.keys(data.bids)\n          // extract Array of bid responses\n          .map( placementId => data.bids[placementId] )\n          // flatten\n          .reduce( (a, b) => a.concat(b), [] )\n          // call addBidResponse\n          .forEach( (bid, i) =>\n            addBidResponse(adUnitCodes[i], createSuccessBidResponse(\n              bid.placement_id, adformats[i], bid.bid_id, bid.bid_price_cents\n            ))\n          );\n      }\n    }, null, { withCredentials: true });\n  } else {\n    // No valid bids\n    logError('No valid bids requested');\n  }\n};\n\n/**\n * @class AudienceNetwork\n * @type {Object}\n * @property {Function} callBids - fetch bids for given parameters\n * @property {Function} setBidderCode - used for bidder aliasing\n * @property {Function} getBidderCode - unique 'audienceNetwork' identifier\n */\nconst AudienceNetwork = () => ({ callBids, setBidderCode, getBidderCode });\n\nmodule.exports = AudienceNetwork;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/audienceNetwork.js","'use strict';\nvar VERSION = '2.0.1',\n    CONSTANTS = require('../constants.json'),\n    utils = require('../utils.js'),\n    bidfactory = require('../bidfactory.js'),\n    bidmanager = require('../bidmanager.js'),\n    adloader = require('../adloader'),\n    ajax = require('../ajax').ajax;\n\n/**\n * Adapter for requesting bids from Conversant\n */\nvar ConversantAdapter = function () {\n  var w = window,\n    n = navigator;\n\n  // production endpoint\n  var conversantUrl = '//media.msg.dotomi.com/s2s/header?callback=pbjs.conversantResponse';\n\n  // SSAPI returns JSONP with window.pbjs.conversantResponse as the cb\n  var appendScript = function (code) {\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.className = 'cnvr-response';\n\n    try {\n      script.appendChild(document.createTextNode(code));\n      document.getElementsByTagName('head')[0].appendChild(script);\n    } catch (e) {\n      script.text = code;\n      document.getElementsByTagName('head')[0].appendChild(script);\n    }\n  };\n\n  var getDNT = function () {\n    return n.doNotTrack === '1' || w.doNotTrack === '1' || n.msDoNotTrack === '1' || n.doNotTrack === 'yes';\n  };\n\n  var getDevice = function () {\n    const language = n.language ? 'language' : 'userLanguage';\n    return {\n      h: screen.height,\n      w: screen.width,\n      dnt: getDNT() ? 1 : 0,\n      language: n[language].split('-')[0],\n      make: n.vendor ? n.vendor : '',\n      ua: n.userAgent\n    };\n  };\n\n  var callBids = function (params) {\n    var conversantBids = params.bids || [];\n    requestBids(conversantBids);\n  };\n\n  var requestBids = function (bidReqs) {\n    // build bid request object\n    var page = location.pathname + location.search + location.hash,\n      siteId = '',\n      conversantImps = [],\n      conversantBidReqs,\n      secure = 0;\n\n    //build impression array for conversant\n    utils._each(bidReqs, function (bid) {\n      var bidfloor = utils.getBidIdParameter('bidfloor', bid.params),\n        adW = 0,\n        adH = 0,\n        imp;\n\n      secure = utils.getBidIdParameter('secure', bid.params) ? 1 : secure;\n      siteId = utils.getBidIdParameter('site_id', bid.params) + '';\n\n      // Allow sizes to be overridden per placement\n      var bidSizes = Array.isArray(bid.params.sizes) ? bid.params.sizes : bid.sizes;\n\n      if (bidSizes.length === 2 && typeof bidSizes[0] === 'number' && typeof bidSizes[1] === 'number') {\n        adW = bidSizes[0];\n        adH = bidSizes[1];\n      } else {\n        adW = bidSizes[0][0];\n        adH = bidSizes[0][1];\n      }\n\n      imp = {\n        id: bid.bidId,\n        banner: {\n          w: adW,\n          h: adH\n        },\n        secure: secure,\n        bidfloor: bidfloor ? bidfloor : 0,\n        displaymanager: 'Prebid.js',\n        displaymanagerver: VERSION\n      };\n\n      conversantImps.push(imp);\n    });\n\n    conversantBidReqs = {\n      'id': utils.getUniqueIdentifierStr(),\n      'imp': conversantImps,\n\n      'site': {\n        'id': siteId,\n        'mobile': document.querySelector('meta[name=\"viewport\"][content*=\"width=device-width\"]') !== null ? 1 : 0,\n        'page': page\n      },\n\n      'device': getDevice(),\n      'at': 1\n    };\n\n    var url = secure ? 'https:' + conversantUrl : location.protocol + conversantUrl;\n    ajax(url, appendScript, JSON.stringify(conversantBidReqs), {\n      withCredentials : true\n    });\n  };\n\n  var addEmptyBidResponses = function (placementsWithBidsBack) {\n    var allConversantBidRequests = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'conversant');\n\n    if (allConversantBidRequests && allConversantBidRequests.bids){\n      utils._each(allConversantBidRequests.bids, function (conversantBid) {\n        if (!utils.contains(placementsWithBidsBack, conversantBid.placementCode)) {\n          // Add a no-bid response for this placement.\n          var bid = bidfactory.createBid(2, conversantBid);\n          bid.bidderCode = 'conversant';\n          bidmanager.addBidResponse(conversantBid.placementCode, bid);\n        }\n      });\n    }\n  };\n\n  var parseSeatbid = function (bidResponse) {\n    var placementsWithBidsBack = [];\n    utils._each(bidResponse.bid, function (conversantBid) {\n      var responseCPM,\n        placementCode = '',\n        id = conversantBid.impid,\n        bid = {},\n        responseAd,\n        responseNurl,\n        sizeArrayLength;\n\n      // Bid request we sent Conversant\n      var bidRequested = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'conversant').bids.find(bid => bid.bidId === id);\n\n      if (bidRequested) {\n        placementCode = bidRequested.placementCode;\n        bidRequested.status = CONSTANTS.STATUS.GOOD;\n        responseCPM = parseFloat(conversantBid.price);\n\n        if (responseCPM !== 0.0) {\n          conversantBid.placementCode = placementCode;\n          placementsWithBidsBack.push(placementCode);\n          conversantBid.size = bidRequested.sizes;\n          responseAd = conversantBid.adm || '';\n          responseNurl = conversantBid.nurl || '';\n\n          // Our bid!\n          bid = bidfactory.createBid(1, bidRequested);\n          bid.creative_id = conversantBid.id || '';\n          bid.bidderCode = 'conversant';\n\n          bid.cpm = responseCPM;\n\n          // Track impression image onto returned html\n          bid.ad = responseAd + '<img src=\\\"' + responseNurl + '\\\" />';\n\n          sizeArrayLength = bidRequested.sizes.length;\n          if (sizeArrayLength === 2 && typeof bidRequested.sizes[0] === 'number' && typeof bidRequested.sizes[1] === 'number') {\n            bid.width = bidRequested.sizes[0];\n            bid.height = bidRequested.sizes[1];\n          } else {\n            bid.width = bidRequested.sizes[0][0];\n            bid.height = bidRequested.sizes[0][1];\n          }\n\n          bidmanager.addBidResponse(placementCode, bid);\n        }\n      }\n    });\n    addEmptyBidResponses(placementsWithBidsBack);\n  };\n\n  // Register our callback to the global object:\n  pbjs.conversantResponse = function (conversantResponseObj, path) {\n    // valid object?\n    if (conversantResponseObj && conversantResponseObj.id) {\n      if (conversantResponseObj.seatbid && conversantResponseObj.seatbid.length > 0 && conversantResponseObj.seatbid[0].bid && conversantResponseObj.seatbid[0].bid.length > 0) {\n        utils._each(conversantResponseObj.seatbid, parseSeatbid);\n      } else {\n        //no response data for any placements\n        addEmptyBidResponses([]);\n      }\n    } else {\n      //no response data for any placements\n      addEmptyBidResponses([]);\n    }\n    // for debugging purposes\n    if (path){\n      adloader.loadScript(path, function () {\n        var allConversantBidRequests = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'conversant');\n\n        if (pbjs.conversantDebugResponse){\n          pbjs.conversantDebugResponse(allConversantBidRequests);\n        }\n      });\n    }\n  }; // conversantResponse\n\n  return {\n    callBids: callBids\n  };\n};\n\nmodule.exports = ConversantAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/conversant.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adLoader = require('../adloader');\n\nvar DistrictmAdaptor = function districtmAdaptor(){\n  let districtmUrl = window.location.protocol + '//prebid.districtm.ca/lib.js';\n  this.callBids = params =>{\n    if(!window.hb_dmx_res){\n      adLoader.loadScript(districtmUrl,()=>{\n        this.sendBids(params);\n      });\n    }else{\n      this.sendBids(params);\n    }\n    return params;\n  };\n\n\n  this.handlerRes = function(response, bidObject){\n    let bid;\n    if(parseFloat(response.result.cpm) > 0){\n      bid = bidfactory.createBid(1);\n      bid.bidderCode = bidObject.bidder;\n      bid.cpm = response.result.cpm;\n      bid.width = response.result.width;\n      bid.height = response.result.height;\n      bid.ad = response.result.banner;\n      bidmanager.addBidResponse(bidObject.placementCode, bid);\n    }else{\n      bid = bidfactory.createBid(2);\n      bid.bidderCode = bidObject.bidder;\n      bidmanager.addBidResponse(bidObject.placementCode, bid);\n    }\n\n    return bid;\n  };\n\n\n  this.sendBids = function(params){\n    var bids = params.bids;\n    for(var i = 0; i < bids.length; i++){\n      bids[i].params.sizes = window.hb_dmx_res.auction.fixSize(bids[i].sizes);\n    }\n    window.hb_dmx_res.auction.run(window.hb_dmx_res.ssp, bids, this.handlerRes);\n    return bids;\n  };\n\n\n  return {\n    callBids: this.callBids,\n    sendBids: this.sendBids,\n    handlerRes: this.handlerRes\n  };\n};\n\nmodule.exports = DistrictmAdaptor;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/districtmDMX.js","var utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\nvar STATUS = require('../constants').STATUS;\n\nvar FidelityAdapter = function FidelityAdapter() {\n  var FIDELITY_BIDDER_NAME = 'fidelity';\n  var FIDELITY_SERVER_NAME = 'x.fidelity-media.com';\n\n  function _callBids(params) {\n    var bids = params.bids || [];\n    bids.forEach(function (currentBid) {\n      var server = currentBid.params.server || FIDELITY_SERVER_NAME;\n      var m3_u = window.location.protocol + '//'+server+'/delivery/hb.php?';\n      m3_u += 'callback=window.pbjs.fidelityResponse';\n      m3_u += '&requestid='+utils.getUniqueIdentifierStr();\n      m3_u += '&impid='+currentBid.bidId;\n      m3_u += '&zoneid='+currentBid.params.zoneid;\n      m3_u += '&cb='+Math.floor(Math.random()*99999999999);\n      m3_u += document.charset ? '&charset='+document.charset : (document.characterSet ? '&charset='+document.characterSet : '');\n\n      var loc;\n      try {\n        loc = window.top !== window ? document.referrer : window.location.href;\n      } catch (e) {\n        loc = document.referrer;\n      }\n      loc = currentBid.params.loc || loc;\n      m3_u += '&loc=' + encodeURIComponent(loc);\n\n      var subid = currentBid.params.subid || 'hb';\n      m3_u += '&subid=' + subid;\n      if (document.referrer) m3_u += '&referer=' + encodeURIComponent(document.referrer);\n      if (currentBid.params.click) m3_u += '&ct0=' + encodeURIComponent(currentBid.params.click);\n      m3_u += '&flashver=' + encodeURIComponent(getFlashVersion());\n\n      adloader.loadScript(m3_u);\n    });\n  }\n\n  function getFlashVersion(){\n    var plugins, plugin, result;\n\n    if (navigator.plugins && navigator.plugins.length > 0) {\n      plugins = navigator.plugins;\n      for (var i = 0; i < plugins.length && !result; i++) {\n        plugin = plugins[i];\n        if (plugin.name.indexOf(\"Shockwave Flash\") > -1) {\n          result = plugin.description.split(\"Shockwave Flash \")[1];\n        }\n      }\n    }\n    return result ? result : \"\";\n  }\n\n  function addBlankBidResponses(placementsWithBidsBack) {\n    var allFidelityBidRequests = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === FIDELITY_BIDDER_NAME);\n\n    if (allFidelityBidRequests && allFidelityBidRequests.bids){\n      utils._each(allFidelityBidRequests.bids, function (fidelityBid) {\n        if (!utils.contains(placementsWithBidsBack, fidelityBid.placementCode)) {\n          // Add a no-bid response for this placement.\n          var bid = bidfactory.createBid(STATUS.NO_BID, fidelityBid);\n          bid.bidderCode = FIDELITY_BIDDER_NAME;\n          bidmanager.addBidResponse(fidelityBid.placementCode, bid);\n        }\n      });\n    }\n  }\n  \n  pbjs.fidelityResponse = function(responseObj) {\n\n    if (!responseObj || !responseObj.seatbid || responseObj.seatbid.length === 0 || !responseObj.seatbid[0].bid || responseObj.seatbid[0].bid.length === 0) {\n      addBlankBidResponses([]); \n      return;\n    }\n\n    var bid = responseObj.seatbid[0].bid[0];\n    var status = bid.adm ? STATUS.GOOD : STATUS.NO_BID;\n    var requestObj = utils.getBidRequest(bid.impid);\n\n    var bidResponse = bidfactory.createBid(status);\n    bidResponse.bidderCode = FIDELITY_BIDDER_NAME;\n    if (status === STATUS.GOOD) {\n      bidResponse.cpm = parseFloat(bid.price);\n      bidResponse.ad = bid.adm;\n      bidResponse.width = parseInt(bid.width);\n      bidResponse.height = parseInt(bid.height);\n    }\n    var placementCode = requestObj && requestObj.placementCode;\n    bidmanager.addBidResponse(placementCode, bidResponse);\n  };\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = FidelityAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/fidelity.js","const bidfactory = require('../bidfactory');\nconst bidmanager = require('../bidmanager');\nconst utils      = require('../utils');\nconst adloader   = require('../adloader');\n\nconst BIDDER_CODE = 'gumgum';\nconst CALLBACKS = {};\n\nconst GumgumAdapter = function GumgumAdapter() {\n\n  const bidEndpoint = `https://g2.gumgum.com/hbid/imp`;\n\n  let topWindow;\n  let topScreen;\n  let pageViewId;\n  const requestCache = {};\n  const throttleTable = {};\n  const defaultThrottle = 3e4;\n\n  try {\n    topWindow = global.top;\n    topScreen = topWindow.screen;\n  } catch (error) {\n    return utils.logError(error);\n  }\n\n  function _getTimeStamp() {\n    return new Date().getTime();\n  }\n\n  function _callBids({ bids }) {\n    const browserParams = {\n      vw: topWindow.innerWidth,\n      vh: topWindow.innerHeight,\n      sw: topScreen.width,\n      sh: topScreen.height,\n      pu: topWindow.location.href,\n      ce: navigator.cookieEnabled,\n      dpr: topWindow.devicePixelRatio || 1\n    };\n    utils._each(bids, bidRequest => {\n      const { bidId\n            , params = {}\n            , placementCode\n            } = bidRequest;\n      const timestamp  = _getTimeStamp();\n      const trackingId = params.inScreen;\n      const nativeId   = params.native;\n      const slotId     = params.inSlot;\n      const bid        = { tmax: pbjs.cbTimeout };\n\n      /* slot/native ads need the placement id */\n      switch (true) {\n        case !!(params.inImage):  bid.pi = 1; break;\n        case !!(params.inScreen): bid.pi = 2; break;\n        case !!(params.inSlot):   bid.pi = 3; break;\n        case !!(params.native):   bid.pi = 5; break;\n        default: return utils.logWarn(\n          `[GumGum] No product selected for the placement ${placementCode}` +\n          ', please check your implementation.'\n        );\n      }\n\n      /* throttle based on the latest request for this product */\n      const productId     = bid.pi;\n      const requestKey    = productId + '|' + placementCode;\n      const throttle      = throttleTable[productId];\n      const latestRequest = requestCache[requestKey];\n      if (latestRequest && throttle && (timestamp - latestRequest) < throttle) {\n        return utils.logWarn(\n          `[GumGum] The refreshes for \"${ placementCode }\" with the params ` +\n          `${ JSON.stringify(params) } should be at least ${ throttle / 1e3 }s apart.`\n        );\n      }\n      /* update the last request */\n      requestCache[requestKey] = timestamp;\n\n      /* tracking id is required for in-image and in-screen */\n      if (trackingId) bid.t = trackingId;\n      /* native ads require a native placement id */\n      if (nativeId) bid.ni = nativeId;\n      /* slot ads require a slot id */\n      if (slotId) bid.si = slotId;\n\n      /* include the pageViewId, if any */\n      if (pageViewId) bid.pv = pageViewId;\n\n      const cachedBid = Object.assign({\n        placementCode,\n        id: bidId\n      }, bid);\n\n      const callback = { jsonp: `pbjs.handleGumGumCB['${ bidId }']` };\n      CALLBACKS[bidId] = _handleGumGumResponse(cachedBid);\n      const query = Object.assign(callback, browserParams, bid);\n      const bidCall = `${bidEndpoint}?${utils.parseQueryStringParameters(query)}`;\n      adloader.loadScript(bidCall);\n    });\n  }\n\n  const _handleGumGumResponse = cachedBidRequest => (bidResponse = {}) => {\n    const { pi: productId\n          } = cachedBidRequest;\n    const { ad = {}\n          , pag = {}\n          , thms: throttle\n          } = bidResponse;\n    /* cache the pageViewId */\n    if (pag && pag.pvid) pageViewId = pag.pvid;\n    if (ad && ad.id) {\n      /* set the new throttle */\n      throttleTable[productId] = throttle || defaultThrottle;\n      /* create the bid */\n      const bid = bidfactory.createBid(1);\n      const { t: trackingId\n            } = pag;\n      bidResponse.request = cachedBidRequest;\n      const encodedResponse = encodeURIComponent(JSON.stringify(bidResponse));\n      const gumgumAdLoader = `<script>\n        (function (context, topWindow, d, s, G) {\n          G = topWindow.GUMGUM;\n          d = topWindow.document;\n          function loadAd() {\n            topWindow.GUMGUM.pbjs(\"${ trackingId }\", ${ productId }, \"${ encodedResponse }\" , context);\n          }\n          if (G) {\n            loadAd();\n          } else {\n            topWindow.pbjs.loadScript(\"https://g2.gumgum.com/javascripts/ggv2.js\", loadAd);\n          }\n        }(window, top));\n      </script>`;\n      Object.assign(bid, {\n        cpm: ad.price,\n        ad: gumgumAdLoader,\n        width: ad.width,\n        height: ad.height,\n        bidderCode: BIDDER_CODE\n      });\n      bidmanager.addBidResponse(cachedBidRequest.placementCode, bid);\n    } else {\n      const noBid = bidfactory.createBid(2);\n      noBid.bidderCode = BIDDER_CODE;\n      bidmanager.addBidResponse(cachedBidRequest.placementCode, noBid);\n    }\n    delete CALLBACKS[cachedBidRequest.id];\n  };\n\n  window.pbjs.handleGumGumCB = CALLBACKS;\n\n  return {\n    callBids: _callBids\n  };\n\n};\n\nmodule.exports = GumgumAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/gumgum.js","/*jslint white:true, browser:true, single: true*/\r\n/*global pbjs, require, module*/\r\n\r\n/**\r\n * Adapter for HIRO Media\r\n *\r\n * @module HiroMediaAdapter\r\n *\r\n * @requires src/adloader\r\n * @requires src/bidfactory\r\n * @requires src/bidmanager\r\n * @requires src/constants\r\n * @requires src/utils\r\n */\r\nvar adloader = require('src/adloader');\r\nvar bidfactory = require('src/bidfactory');\r\nvar bidmanager = require('src/bidmanager');\r\nvar utils = require('src/utils');\r\nvar STATUS = require('src/constants').STATUS;\r\n\r\nvar HiroMediaAdapter = function HiroMediaAdapter() {\r\n\r\n  'use strict';\r\n\r\n  /**\r\n   * Bidder code\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @constant {string}\r\n   * @private\r\n   */\r\n  var BIDDER_CODE = 'hiromedia';\r\n\r\n  /**\r\n   * Adapter version\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @constant {number}\r\n   * @private\r\n   */\r\n  var ADAPTER_VERSION = 3;\r\n\r\n  /**\r\n   * Default bid param values\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @constant {module:HiroMediaAdapter~bidParams}\r\n   * @private\r\n   */\r\n  var REQUIRED_BID_PARAMS = ['accountId'];\r\n\r\n  /**\r\n   * Default bid param values\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @constant {module:HiroMediaAdapter~bidParams}\r\n   * @private\r\n   */\r\n  var DEFAULT_BID_PARAMS = {\r\n    bidUrl: 'https://hb-rtb.ktdpublishers.com/bid/get'\r\n  };\r\n\r\n  /**\r\n   * Storage for bid objects.\r\n   *\r\n   * Bids need to be stored between requests and response since the response\r\n   * is a global callback.\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @var {array.<module:HiroMediaAdapter~bidInfo>}\r\n   * @private\r\n   */\r\n  var _bidStorage = [];\r\n\r\n  /**\r\n   * Call bidmanager.addBidResponse\r\n   *\r\n   * Simple wrapper that will create a bid object with the correct status\r\n   * and add the response for the placement.\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @param  {module:HiroMediaAdapter~bidInfo} bidInfo bid object wrapper to respond for\r\n   * @param  {object|boolean} [bidResponse] response object for bid, if not\r\n   * set the response will be an empty bid response.\r\n   */\r\n  function addBidResponse(bidInfo, bidResponse) {\r\n\r\n    var placementCode = bidInfo.bid.placementCode;\r\n    var bidStatus = bidResponse ? STATUS.GOOD : STATUS.NO_BID;\r\n    var bidObject = bidfactory.createBid(bidStatus, bidInfo.bid);\r\n\r\n    bidObject.bidderCode = BIDDER_CODE;\r\n\r\n    if (bidResponse) {\r\n      bidObject.cpm = bidResponse.cpm;\r\n      bidObject.ad = bidResponse.ad;\r\n      bidObject.width = bidResponse.width;\r\n      bidObject.height = bidResponse.height;\r\n    }\r\n\r\n    utils.logMessage('hiromedia.callBids, addBidResponse for ' + placementCode + ' status: ' + bidStatus);\r\n    bidmanager.addBidResponse(placementCode, bidObject);\r\n\r\n  }\r\n\r\n  /**\r\n   * Return `true` if sampling is larger than a newly created random value\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @param  {number} sampling the value to check\r\n   * @return {boolean}  `true` if the sampling is larger, `false` otherwise\r\n   */\r\n  function checkChance(sampling) {\r\n    return Math.random() < sampling;\r\n  }\r\n\r\n  /**\r\n   * Apply a response for all pending bids that have the same response batch key\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @param  {object} response [description]\r\n   */\r\n  function handleResponse(response) {\r\n\r\n    _bidStorage.filter(function (bidInfo) {\r\n      return bidInfo.batchKey === response.batchKey;\r\n    }).forEach(function (bidInfo) {\r\n\r\n      // Sample the bid responses according to `response.chance`,\r\n      // if `response.chance` is not provided, sample at 100%.\r\n      if (response.chance === undefined || checkChance(response.chance)) {\r\n        addBidResponse(bidInfo, response);\r\n      } else {\r\n        addBidResponse(bidInfo, false);\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Call {@linkcode module:HiroMediaAdapter~handleResponse} for valid responses\r\n   *\r\n   * @global\r\n   *\r\n   * @param  {object} [response] the response from the server\r\n   */\r\n  pbjs.hiromedia_callback = function (response) {\r\n\r\n    if (response && response.batchKey) {\r\n      handleResponse(response);\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Find browser name and version\r\n   *\r\n   * Super basic UA parser for the major browser configurations.\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @return {module:HiroMediaAdapter~browserInfo} object containing name and version of browser\r\n   * or empty strings.\r\n   */\r\n  function getBrowser() {\r\n\r\n    var ua = navigator.userAgent;\r\n    var browsers = [{\r\n      name: 'Mobile',\r\n      stringSearch: 'Mobi'\r\n    }, {\r\n      name: 'Edge'\r\n    }, {\r\n      name: 'Chrome'\r\n    }, {\r\n      name: 'Firefox'\r\n    }, {\r\n      name: 'IE',\r\n      versionSearch: /MSIE\\s(\\d+)/\r\n    }, {\r\n      name: 'IE',\r\n      stringSearch: 'Trident',\r\n      versionSearch: /rv:(\\d+)/\r\n    }];\r\n\r\n    var name = '';\r\n    var version = '';\r\n\r\n    browsers.some(function (browser) {\r\n\r\n      var nameSearch = browser.stringSearch || browser.name;\r\n      var defaultVersionSearch = nameSearch + '\\\\/(\\\\d+)';\r\n      var versionSearch = browser.versionSearch || defaultVersionSearch;\r\n      var versionMatch;\r\n\r\n      if (ua.indexOf(nameSearch) !== -1) {\r\n        name = browser.name;\r\n        versionMatch = ua.match(versionSearch);\r\n        if (versionMatch) {\r\n          version = versionMatch && versionMatch[1];\r\n        }\r\n        return true;\r\n      }\r\n\r\n    });\r\n\r\n    return {\r\n      name: name,\r\n      version: version\r\n    };\r\n\r\n  }\r\n\r\n  /**\r\n   * Return top context domain\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @return {string}  domain of top context url.\r\n   */\r\n  function getDomain() {\r\n\r\n    var a = document.createElement('a');\r\n    a.href = utils.getTopWindowUrl();\r\n    return a.hostname;\r\n\r\n  }\r\n\r\n  /**\r\n   * Apply default parameters to an object if the parameters are not set\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @param  {module:HiroMediaAdapter~bidParams} bidParams custom parameters for bid\r\n   * @return {module:HiroMediaAdapter~bidParams} `bidParams` shallow merged with\r\n   * {@linkcode module:HiroMediaAdapter~DEFAULT_BID_PARAMS|DEFAULT_BID_PARAMS}\r\n   */\r\n  function defaultParams(bidParams) {\r\n    return Object.assign({}, DEFAULT_BID_PARAMS, bidParams);\r\n  }\r\n\r\n  /**\r\n   * Calculate and return a batchKey key for a bid\r\n   *\r\n   * Bid of similar placement can have similar responses,\r\n   * we can calculate a key based on the variant properties\r\n   * of a bid which can share the same response\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @param  {module:HiroMediaAdapter~bidInfo} bidInfo bid information\r\n   * @return {string}  batch key for bid\r\n   */\r\n  function getBatchKey(bidInfo) {\r\n\r\n    var bidParams = bidInfo.bidParams;\r\n    var batchParams = [\r\n      bidParams.bidUrl,\r\n      bidParams.accountId,\r\n      bidInfo.selectedSize,\r\n      bidInfo.additionalSizes\r\n    ];\r\n\r\n    return batchParams.join('-');\r\n\r\n  }\r\n\r\n  /**\r\n   * Build a set of {@linkcode module:HiroMediaAdapter~bidInfo|bidInfo} objects based on the\r\n   * bids sent to {@linkcode module:HiroMediaAdapter#callBids|callBids}\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @param  {object} bids bids sent from `Prebid.js`\r\n   * @return {array.<module:HiroMediaAdapter~bidInfo>} wrapped bids\r\n   */\r\n  function processBids(bids) {\r\n\r\n    var result = [];\r\n\r\n    if (bids) {\r\n\r\n      utils.logMessage('hiromedia.processBids, processing ' + bids.length + ' bids');\r\n\r\n      bids.forEach(function (bid) {\r\n\r\n        var sizes = utils.parseSizesInput(bid.sizes);\r\n        var bidParams = defaultParams(bid.params);\r\n        var hasValidBidRequest = utils.hasValidBidRequest(bidParams, REQUIRED_BID_PARAMS, BIDDER_CODE);\r\n        var shouldBid = hasValidBidRequest;\r\n        var bidInfo = {\r\n          bid: bid,\r\n          bidParams: bidParams,\r\n          shouldBid: shouldBid,\r\n          selectedSize: sizes[0],\r\n          additionalSizes: sizes.slice(1).join(',')\r\n        };\r\n\r\n        if (shouldBid) {\r\n          bidInfo.batchKey = getBatchKey(bidInfo);\r\n        }\r\n\r\n        result.push(bidInfo);\r\n\r\n      });\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  }\r\n\r\n  /**\r\n   * Send a bid request to the bid server endpoint\r\n   *\r\n   * Calls `adLoader.loadScript`\r\n   *\r\n   * @memberof module:HiroMediaAdapter~\r\n   * @private\r\n   *\r\n   * @param  {string} url base url, can already contain query parameters\r\n   * @param  {object} requestParams parameters to add to query\r\n   */\r\n  function sendBidRequest(url,requestParams) {\r\n\r\n    if (requestParams) {\r\n\r\n      if (url.indexOf('?') !== -1) {\r\n        url = url + '&';\r\n      } else {\r\n        url = url + '?';\r\n      }\r\n\r\n      Object.keys(requestParams).forEach(function (key) {\r\n        url = utils.tryAppendQueryString(url, key, requestParams[key]);\r\n      });\r\n\r\n    }\r\n\r\n    utils.logMessage('hiromedia.callBids, url:' + url);\r\n\r\n    adloader.loadScript(url);\r\n\r\n  }\r\n\r\n  /**\r\n   * Receive a set of bid placements and create bid requests and responses accordingly\r\n   *\r\n   * @alias module:HiroMediaAdapter#callBids\r\n   *\r\n   * @param  {object} params placement and bid data from `Prebid.js`\r\n   */\r\n  function _callBids(params) {\r\n\r\n    var browser = getBrowser();\r\n    var domain = getDomain();\r\n    var bidsRequested = {};\r\n\r\n    utils.logMessage('hiromedia.callBids');\r\n\r\n    if (params) {\r\n\r\n      // Processed bids are stored in the adapter scope\r\n      _bidStorage = processBids(params.bids);\r\n\r\n    } else {\r\n\r\n      // Ensure we don't run on stale data\r\n      _bidStorage = [];\r\n\r\n    }\r\n\r\n    if (_bidStorage.length) {\r\n\r\n      // Loop over processed bids and send a request if a request for the bid\r\n      // batchKey has not been sent.\r\n      _bidStorage.forEach(function (bidInfo) {\r\n\r\n        var bid = bidInfo.bid;\r\n        var batchKey = bidInfo.batchKey;\r\n        var bidParams = bidInfo.bidParams;\r\n\r\n        utils.logMessage('hiromedia.callBids, bidInfo ' + bid.placementCode + ' ' + bidInfo.shouldBid);\r\n\r\n        if (bidInfo.shouldBid) {\r\n\r\n          var url = bidParams.bidUrl;\r\n\r\n          if (!bidsRequested[batchKey]) {\r\n\r\n            bidsRequested[batchKey] = true;\r\n\r\n            sendBidRequest(url,{\r\n              adapterVersion: ADAPTER_VERSION,\r\n              callback: 'pbjs.hiromedia_callback',\r\n              batchKey: batchKey,\r\n              placementCode: bid.placementCode,\r\n              accountId: bidParams.accountId,\r\n              browser: browser.name,\r\n              browserVersion: browser.version,\r\n              domain: domain,\r\n              selectedSize: bidInfo.selectedSize,\r\n              additionalSizes: bidInfo.additionalSizes\r\n            });\r\n\r\n          }\r\n\r\n        } else {\r\n\r\n          // No bid\r\n          addBidResponse(bidInfo, false);\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n\r\n  return {\r\n    callBids: _callBids\r\n  };\r\n\r\n\r\n  // JSDoc typedefs\r\n\r\n  /**\r\n   * Parameters for bids to HIRO Media adapter\r\n   *\r\n   * @typedef {object} module:HiroMediaAdapter~bidParams\r\n   * @private\r\n   *\r\n   * @property {string} bidUrl the bid server endpoint url\r\n   */\r\n\r\n  /**\r\n   * Bid object wrapper\r\n   *\r\n   * @typedef {object} module:HiroMediaAdapter~bidInfo\r\n   * @private\r\n   *\r\n   * @property {object} bid original bid passed to #callBids\r\n   * @property {string} selectedSize the first size in the the placement sizes array\r\n   * @property {string} additionalSizes list of sizes in the placement sizes array besides the first\r\n   * @property {string} batchKey key used for batching requests which have the same basic properties\r\n   * @property {module:HiroMediaAdapter~bidParams} bidParams original params passed for bid in #callBids\r\n   * @property {boolean} shouldBid flag to determine if the bid is valid for bidding or not\r\n   */\r\n\r\n  /**\r\n   * browserInfo\r\n   *\r\n   * @typedef {object} module:HiroMediaAdapter~browserInfo\r\n   * @private\r\n   *\r\n   * @property {string} name browser name (e.g. `'Chrome'` or `'Firefox'`)\r\n   * @property {string} version browser major version (e.g. `'53'`)\r\n   */\r\n\r\n};\r\n\r\nmodule.exports = HiroMediaAdapter;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/hiromedia.js","//Factory for creating the bidderAdaptor\n// jshint ignore:start\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\n\nvar ADAPTER_NAME = 'INDEXEXCHANGE';\nvar ADAPTER_CODE = 'indexExchange';\n\nvar CONSTANTS = {\n  \"INDEX_DEBUG_MODE\": {\n    \"queryParam\": \"pbjs_ix_debug\",\n    \"mode\": {\n      \"sandbox\": {\n        \"topFrameLimit\": 10,\n        \"queryValue\": \"sandbox\",\n        \"siteID\": \"999990\"\n      }\n    }\n  }\n};\n\nvar OPEN_MARKET = 'IOM';\nvar PRIVATE_MARKET = 'IPM';\n\nwindow.cygnus_index_parse_res = function(response) {\n  try {\n    if (response) {\n      if (typeof _IndexRequestData !== \"object\" || typeof _IndexRequestData.impIDToSlotID !== \"object\" || typeof _IndexRequestData.impIDToSlotID[response.id] === \"undefined\") {\n        return;\n      }\n      var targetMode = 1;\n      var callbackFn;\n      if (typeof _IndexRequestData.reqOptions === 'object' && typeof _IndexRequestData.reqOptions[response.id] === 'object') {\n        if (typeof _IndexRequestData.reqOptions[response.id].callback === \"function\") {\n          callbackFn = _IndexRequestData.reqOptions[response.id].callback;\n        }\n        if (typeof _IndexRequestData.reqOptions[response.id].targetMode === \"number\") {\n          targetMode = _IndexRequestData.reqOptions[response.id].targetMode;\n        }\n      }\n\n      _IndexRequestData.lastRequestID = response.id;\n      _IndexRequestData.targetIDToBid = {};\n      _IndexRequestData.targetIDToResp = {};\n      _IndexRequestData.targetIDToCreative = {};\n\n      var allBids = [];\n      var seatbidLength = typeof response.seatbid === \"undefined\" ? 0 : response.seatbid.length;\n      for (var i = 0; i < seatbidLength; i++) {\n        for (var j = 0; j < response.seatbid[i].bid.length; j++) {\n          var bid = response.seatbid[i].bid[j];\n          if (typeof bid.ext !== \"object\" || typeof bid.ext.pricelevel !== \"string\") {\n            continue;\n          }\n          if (typeof _IndexRequestData.impIDToSlotID[response.id][bid.impid] === \"undefined\") {\n            continue;\n          }\n          var slotID = _IndexRequestData.impIDToSlotID[response.id][bid.impid];\n          var targetID;\n          var noTargetModeTargetID;\n          var targetPrefix;\n          if (typeof bid.ext.dealid === \"string\") {\n            if (targetMode === 1) {\n              targetID = slotID + bid.ext.pricelevel;\n            } else {\n              targetID = slotID + \"_\" + bid.ext.dealid;\n            }\n            noTargetModeTargetID = slotID + '_' + bid.ext.dealid;\n            targetPrefix = PRIVATE_MARKET + '_';\n          } else {\n            targetID = slotID + bid.ext.pricelevel;\n            noTargetModeTargetID = slotID + bid.ext.pricelevel;\n            targetPrefix = OPEN_MARKET + '_';\n          }\n          if (_IndexRequestData.targetIDToBid[targetID] === undefined) {\n            _IndexRequestData.targetIDToBid[targetID] = [bid.adm];\n          } else {\n            _IndexRequestData.targetIDToBid[targetID].push(bid.adm);\n          }\n          if (_IndexRequestData.targetIDToCreative[noTargetModeTargetID] === undefined) {\n            _IndexRequestData.targetIDToCreative[noTargetModeTargetID] = [bid.adm];\n          } else {\n            _IndexRequestData.targetIDToCreative[noTargetModeTargetID].push(bid.adm);\n          }\n          var impBid = {};\n          impBid.impressionID = bid.impid;\n          if (typeof bid.ext.dealid !== 'undefined') {\n            impBid.dealID = bid.ext.dealid;\n          }\n          impBid.bid = bid.price;\n          impBid.slotID = slotID;\n          impBid.priceLevel = bid.ext.pricelevel;\n          impBid.target = targetPrefix + targetID;\n          _IndexRequestData.targetIDToResp[targetID] = impBid;\n          allBids.push(impBid);\n        }\n      }\n      if (typeof callbackFn === \"function\") {\n        if (allBids.length === 0) {\n          callbackFn(response.id);\n        } else {\n          callbackFn(response.id, allBids);\n        }\n      }\n\n    }\n  } catch (e) {}\n\n  if (typeof window.cygnus_index_ready_state === 'function') {\n    window.cygnus_index_ready_state();\n  }\n}\n\nwindow.index_render = function(doc, targetID) {\n  try {\n    var ad = _IndexRequestData.targetIDToCreative[targetID].pop();\n    if (ad != null) {\n      doc.write(ad);\n    } else {\n      var url = window.location.protocol === 'https:' ? 'https://as-sec.casalemedia.com' : 'http://as.casalemedia.com';\n      url += '/headerstats?type=RT&s=' + cygnus_index_args.siteID + '&u=' + encodeURIComponent(location.href) + '&r=' + _IndexRequestData.lastRequestID;\n      var px_call = new Image();\n      px_call.src = url + '&blank=' + targetID;\n    }\n  } catch (e) {}\n}\n\nwindow.headertag_render = function(doc, targetID, slotID) {\n  var index_slot = slotID;\n  var index_ary = targetID.split(',');\n  for (var i = 0; i < index_ary.length; i++) {\n    var unpack = index_ary[i].split('_');\n    if (unpack[0] == index_slot) {\n      index_render(doc, index_ary[i]);\n      return;\n    }\n  }\n}\n\nwindow.cygnus_index_args = {};\n\nvar cygnus_index_adunits =  [[728, 90], [120, 600], [300, 250], [160, 600], [336, 280], [234, 60], [300, 600], [300, 50], [320, 50], [970, 250], [300, 1050], [970, 90], [180, 150]]; // jshint ignore:line\n\nvar getIndexDebugMode = function() {\n  return getParameterByName(CONSTANTS.INDEX_DEBUG_MODE.queryParam).toUpperCase();\n}\n\nvar getParameterByName = function (name) {\n  var wdw = window;\n  var childsReferrer = '';\n  for (var x = 0; x < CONSTANTS.INDEX_DEBUG_MODE.mode.sandbox.topFrameLimit; x++) {\n    if (wdw.parent == wdw) {\n      break;\n    }\n    try {\n      childsReferrer = wdw.document.referrer;\n    } catch (err) {}\n    wdw = wdw.parent;\n  }\n  var topURL = top === self ? location.href : childsReferrer;\n  var regexS = '[\\\\?&]' + name + '=([^&#]*)';\n  var regex = new RegExp(regexS);\n  var results = regex.exec(topURL);\n  if (results === null) {\n    return '';\n  }\n  return decodeURIComponent(results[1].replace(/\\+/g, ' '));\n};\n\nvar cygnus_index_start = function () {\n  window.cygnus_index_args.parseFn = cygnus_index_parse_res;\n  var escapable = /[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\n  var meta = {\n    '\\b': '\\\\b',\n    '\\t': '\\\\t',\n    '\\n': '\\\\n',\n    '\\f': '\\\\f',\n    '\\r': '\\\\r',\n    '\"': '\\\\\"',\n    '\\\\': '\\\\\\\\'\n  };\n\n  function escapeCharacter(character) {\n    var escaped = meta[character];\n    if (typeof escaped === 'string') {\n      return escaped;\n    } else {\n      return '\\\\u' + ('0000' + character.charCodeAt(0).toString(16)).slice(-4);\n    }\n  }\n\n  function quote(string) {\n    escapable.lastIndex = 0;\n    if (escapable.test(string)) {\n      return string.replace(escapable, escapeCharacter);\n    } else {\n      return string;\n    }\n  }\n\n  function OpenRTBRequest(siteID, parseFn, timeoutDelay) {\n    this.initialized = false;\n    if (typeof siteID !== 'number' || siteID % 1 !== 0 || siteID < 0) {\n      throw 'Invalid Site ID';\n    }\n\n    timeoutDelay = Number(timeoutDelay);\n    if (typeof timeoutDelay === 'number' && timeoutDelay % 1 === 0 && timeoutDelay >= 0) {\n      this.timeoutDelay = timeoutDelay;\n    }\n\n    this.siteID = siteID;\n    this.impressions = [];\n    this._parseFnName = undefined;\n    if (top === self) {\n      this.sitePage = location.href;\n      this.topframe = 1;\n    } else {\n      this.sitePage = document.referrer;\n      this.topframe = 0;\n    }\n\n    if (typeof parseFn !== 'undefined') {\n      if (typeof parseFn === 'function') {\n        this._parseFnName = 'cygnus_index_args.parseFn';\n      } else {\n        throw 'Invalid jsonp target function';\n      }\n    }\n\n    if (typeof _IndexRequestData.requestCounter === 'undefined') {\n      _IndexRequestData.requestCounter = Math.floor(Math.random() * 256);\n    } else {\n      _IndexRequestData.requestCounter = (_IndexRequestData.requestCounter + 1) % 256;\n    }\n\n    this.requestID = String((new Date().getTime() % 2592000) * 256 + _IndexRequestData.requestCounter + 256);\n    this.initialized = true;\n  }\n\n  OpenRTBRequest.prototype.serialize = function () {\n    var json = '{\"id\":\"' + this.requestID + '\",\"site\":{\"page\":\"' + quote(this.sitePage) + '\"';\n    if (typeof document.referrer === 'string' && document.referrer !== \"\") {\n      json += ',\"ref\":\"' + quote(document.referrer) + '\"';\n    }\n\n    json += '},\"imp\":[';\n    for (var i = 0; i < this.impressions.length; i++) {\n      var impObj = this.impressions[i];\n      var ext = [];\n      json += '{\"id\":\"' + impObj.id + '\", \"banner\":{\"w\":' + impObj.w + ',\"h\":' + impObj.h + ',\"topframe\":' + String(this.topframe) + '}';\n      if (typeof impObj.bidfloor === 'number') {\n        json += ',\"bidfloor\":' + impObj.bidfloor;\n        if (typeof impObj.bidfloorcur === 'string') {\n          json += ',\"bidfloorcur\":\"' + quote(impObj.bidfloorcur) + '\"';\n        }\n      }\n\n      if (typeof impObj.slotID === 'string' && (!impObj.slotID.match(/^\\s*$/))) {\n        ext.push('\"sid\":\"' + quote(impObj.slotID) + '\"');\n      }\n\n      if (typeof impObj.siteID === 'number') {\n        ext.push('\"siteID\":' + impObj.siteID);\n      }\n\n      if (ext.length > 0) {\n        json += ',\"ext\": {' + ext.join() + '}';\n      }\n\n      if (i + 1 === this.impressions.length) {\n        json += '}';\n      } else {\n        json += '},';\n      }\n    }\n\n    json += ']}';\n    return json;\n  };\n\n  OpenRTBRequest.prototype.setPageOverride = function (sitePageOverride) {\n    if (typeof sitePageOverride === 'string' && (!sitePageOverride.match(/^\\s*$/))) {\n      this.sitePage = sitePageOverride;\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  OpenRTBRequest.prototype.addImpression = function (width, height, bidFloor, bidFloorCurrency, slotID, siteID) {\n    var impObj = {\n      id: String(this.impressions.length + 1)\n    };\n    if (typeof width !== 'number' || width <= 1) {\n      return null;\n    }\n\n    if (typeof height !== 'number' || height <= 1) {\n      return null;\n    }\n\n    if ((typeof slotID === 'string' || typeof slotID === 'number') && String(slotID).length <= 50) {\n      impObj.slotID = String(slotID);\n    }\n\n    impObj.w = width;\n    impObj.h = height;\n    if (bidFloor !== undefined && typeof bidFloor !== 'number') {\n      return null;\n    }\n\n    if (typeof bidFloor === 'number') {\n      if (bidFloor < 0) {\n        return null;\n      }\n\n      impObj.bidfloor = bidFloor;\n      if (bidFloorCurrency !== undefined && typeof bidFloorCurrency !== 'string') {\n        return null;\n      }\n\n      impObj.bidfloorcur = bidFloorCurrency;\n    }\n\n    if (typeof siteID !== 'undefined') {\n      if (typeof siteID === 'number' && siteID % 1 === 0 && siteID >= 0) {\n        impObj.siteID = siteID;\n      } else {\n        return null;\n      }\n    }\n\n    this.impressions.push(impObj);\n    return impObj.id;\n  };\n\n  OpenRTBRequest.prototype.buildRequest = function () {\n    if (this.impressions.length === 0 || this.initialized !== true) {\n      return;\n    }\n\n    var jsonURI = encodeURIComponent(this.serialize());\n\n    var scriptSrc;\n    if (getIndexDebugMode() == CONSTANTS.INDEX_DEBUG_MODE.mode.sandbox.queryValue.toUpperCase()) {\n      this.siteID = CONSTANTS.INDEX_DEBUG_MODE.mode.sandbox.siteID;\n      scriptSrc = window.location.protocol === 'https:' ? 'https://sandbox.ht.indexexchange.com' : 'http://sandbox.ht.indexexchange.com';\n      utils.logMessage('IX DEBUG: Sandbox mode activated');\n    } else {\n      scriptSrc = window.location.protocol === 'https:' ? 'https://as-sec.casalemedia.com' : 'http://as.casalemedia.com';\n    }\n    var prebidVersion = encodeURIComponent(\"0.24.0-pre\");\n    scriptSrc += '/cygnus?v=7&fn=cygnus_index_parse_res&s=' + this.siteID + '&r=' + jsonURI + '&pid=pb' + prebidVersion;\n    if (typeof this.timeoutDelay === 'number' && this.timeoutDelay % 1 === 0 && this.timeoutDelay >= 0) {\n      scriptSrc += '&t=' + this.timeoutDelay;\n    }\n\n    return scriptSrc;\n  };\n\n  try {\n    if (typeof cygnus_index_args === 'undefined' || typeof cygnus_index_args.siteID === 'undefined' || typeof cygnus_index_args.slots === 'undefined') {\n      return;\n    }\n\n    var req = new OpenRTBRequest(cygnus_index_args.siteID, cygnus_index_args.parseFn, cygnus_index_args.timeout);\n    if (cygnus_index_args.url && typeof cygnus_index_args.url === 'string') {\n      req.setPageOverride(cygnus_index_args.url);\n    }\n\n    _IndexRequestData.impIDToSlotID[req.requestID] = {};\n    _IndexRequestData.reqOptions[req.requestID] = {};\n    var slotDef, impID;\n\n    for (var i = 0; i < cygnus_index_args.slots.length; i++) {\n      slotDef = cygnus_index_args.slots[i];\n\n      impID = req.addImpression(slotDef.width, slotDef.height, slotDef.bidfloor, slotDef.bidfloorcur, slotDef.id, slotDef.siteID);\n      if (impID) {\n        _IndexRequestData.impIDToSlotID[req.requestID][impID] = String(slotDef.id);\n      }\n    }\n\n    if (typeof cygnus_index_args.targetMode === 'number') {\n      _IndexRequestData.reqOptions[req.requestID].targetMode = cygnus_index_args.targetMode;\n    }\n\n    if (typeof cygnus_index_args.callback === 'function') {\n      _IndexRequestData.reqOptions[req.requestID].callback = cygnus_index_args.callback;\n    }\n\n    return req.buildRequest();\n  } catch (e) {\n    utils.logError('Error calling index adapter', ADAPTER_NAME, e);\n  }\n};\n\nvar IndexExchangeAdapter = function IndexExchangeAdapter() {\n  var slotIdMap = {};\n  var requiredParams = [\n    /* 0 */\n    'id',\n    /* 1 */\n    'siteID'\n  ];\n  var firstAdUnitCode = '';\n\n  function _callBids(request) {\n    var bidArr = request.bids;\n\n    if (typeof window._IndexRequestData === 'undefined') {\n      window._IndexRequestData = {};\n      window._IndexRequestData.impIDToSlotID = {};\n      window._IndexRequestData.reqOptions = {};\n    }\n    // clear custom targets at the beginning of every request\n    _IndexRequestData.targetAggregate = {'open':{},'private':{}};\n\n    if (!utils.hasValidBidRequest(bidArr[0].params, requiredParams, ADAPTER_NAME)) {\n      return;\n    }\n\n    //Our standard is to always bid for all known slots.\n    cygnus_index_args.slots = [];\n\n    var expectedBids = 0;\n\n    //Grab the slot level data for cygnus_index_args\n    for (var i = 0; i < bidArr.length; i++) {\n      var bid = bidArr[i];\n      var sizeID = 0;\n\n      expectedBids++;\n\n      // Expecting nested arrays for sizes\n      if (!(bid.sizes[0] instanceof Array)) {\n        bid.sizes = [bid.sizes];\n      }\n\n      // Create index slots for all bids and sizes\n      for (var j = 0; j < bid.sizes.length; j++) {\n        var validSize = false;\n        for (var k = 0; k < cygnus_index_adunits.length; k++) {\n          if (bid.sizes[j][0] == cygnus_index_adunits[k][0] &&\n              bid.sizes[j][1] == cygnus_index_adunits[k][1]) {\n            bid.sizes[j][0] = Number(bid.sizes[j][0]);\n            bid.sizes[j][1] = Number(bid.sizes[j][1]);\n            validSize = true;\n            break;\n          }\n        }\n\n        if (!validSize) {\n          utils.logMessage(ADAPTER_NAME + \" slot excluded from request due to no valid sizes\");\n          continue;\n        }\n\n        var usingSizeSpecificSiteID = false;\n        // Check for size defined in bidder params \n        if (bid.params.size && bid.params.size instanceof Array) {\n          if (!(bid.sizes[j][0] == bid.params.size[0] && bid.sizes[j][1] == bid.params.size[1]))\n            continue;\n          usingSizeSpecificSiteID = true;\n        }\n\n        if (bid.params.timeout && typeof cygnus_index_args.timeout === 'undefined') {\n          cygnus_index_args.timeout = bid.params.timeout;\n        }\n\n\n        var siteID = Number(bid.params.siteID);\n        if (typeof siteID !== \"number\" || siteID % 1 != 0 || siteID <= 0) {\n          utils.logMessage(ADAPTER_NAME + \" slot excluded from request due to invalid siteID\");\n          continue;\n        }\n        if (siteID && typeof cygnus_index_args.siteID === 'undefined') {\n          cygnus_index_args.siteID = siteID;\n        }\n\n        if (utils.hasValidBidRequest(bid.params, requiredParams, ADAPTER_NAME)) {\n          firstAdUnitCode = bid.placementCode;\n          var slotID = bid.params[requiredParams[0]];\n          if ( typeof slotID !== 'string' && typeof slotID !== 'number' ){\n            utils.logError(ADAPTER_NAME + \" bid contains invalid slot ID from \" + bid.placementCode + \". Discarding slot\");\n            continue\n          }\n\n          sizeID++;\n          var size = {\n            width: bid.sizes[j][0],\n            height: bid.sizes[j][1]\n          };\n\n          var slotName = usingSizeSpecificSiteID ? String(slotID) : slotID + '_' + sizeID;\n          slotIdMap[slotName] = bid;\n\n          //Doesn't need the if(primary_request) conditional since we are using the mergeSlotInto function which is safe\n          cygnus_index_args.slots = mergeSlotInto({\n            id: slotName,\n            width: size.width,\n            height: size.height,\n            siteID: siteID || cygnus_index_args.siteID\n          }, cygnus_index_args.slots);\n\n          if (bid.params.tier2SiteID) {\n            var tier2SiteID = Number(bid.params.tier2SiteID);\n            if (typeof tier2SiteID !== 'undefined' && !tier2SiteID) {\n              continue;\n            }\n\n            cygnus_index_args.slots = mergeSlotInto({\n              id: 'T1_' + slotName,\n              width: size.width,\n              height: size.height,\n              siteID: tier2SiteID\n            }, cygnus_index_args.slots);\n          }\n\n          if (bid.params.tier3SiteID) {\n            var tier3SiteID = Number(bid.params.tier3SiteID);\n            if (typeof tier3SiteID !== 'undefined' && !tier3SiteID) {\n              continue;\n            }\n\n            cygnus_index_args.slots = mergeSlotInto({\n              id: 'T2_' + slotName,\n              width: size.width,\n              height: size.height,\n              siteID: tier3SiteID\n            }, cygnus_index_args.slots);\n          }\n        }\n      }\n    }\n\n    if (cygnus_index_args.slots.length > 20) {\n      utils.logError('Too many unique sizes on slots, will use the first 20.', ADAPTER_NAME);\n    }\n\n    //bidmanager.setExpectedBidsCount(ADAPTER_CODE, expectedBids);\n    adloader.loadScript(cygnus_index_start());\n\n    var responded = false;\n\n    // Handle response\n    window.cygnus_index_ready_state = function () {\n      if (responded) {\n        return;\n      }\n      responded = true;\n\n      try {\n        var indexObj = _IndexRequestData.targetIDToBid;\n        var lookupObj = cygnus_index_args;\n\n        // Grab all the bids for each slot\n        for (var adSlotId in slotIdMap) {\n          var bidObj = slotIdMap[adSlotId];\n          var adUnitCode = bidObj.placementCode;\n\n          var bids = [];\n\n          // Grab the bid for current slot\n          for (var cpmAndSlotId in indexObj) {\n            var match = /^(T\\d_)?(.+)_(\\d+)$/.exec(cpmAndSlotId);\n            // if parse fail, move to next bid\n            if (!(match)){\n              utils.logError(\"Unable to parse \" + cpmAndSlotId + \", skipping slot\", ADAPTER_NAME);\n              continue;\n            }\n            var tier = match[1] || '';\n            var slotID = match[2];\n            var currentCPM = match[3];\n\n            var slotObj = getSlotObj(cygnus_index_args, tier + slotID);\n            // Bid is for the current slot\n            if (slotID === adSlotId) {\n              var bid = bidfactory.createBid(1);\n              bid.cpm = currentCPM / 100;\n              bid.ad = indexObj[cpmAndSlotId][0];\n              bid.bidderCode = ADAPTER_CODE;\n              bid.width = slotObj.width;\n              bid.height = slotObj.height;\n              bid.siteID = slotObj.siteID;\n              if ( typeof _IndexRequestData.targetIDToResp === 'object' && typeof _IndexRequestData.targetIDToResp[cpmAndSlotId] === 'object' && typeof _IndexRequestData.targetIDToResp[cpmAndSlotId].dealID !== 'undefined' ) {\n                if (typeof _IndexRequestData.targetAggregate['private'][adUnitCode] === 'undefined')\n                  _IndexRequestData.targetAggregate['private'][adUnitCode] = [];\n                bid.dealId = _IndexRequestData.targetIDToResp[cpmAndSlotId].dealID;\n                _IndexRequestData.targetAggregate['private'][adUnitCode].push( slotID + \"_\" + _IndexRequestData.targetIDToResp[cpmAndSlotId].dealID );\n              } else {\n                if (typeof _IndexRequestData.targetAggregate['open'][adUnitCode] === 'undefined')\n                  _IndexRequestData.targetAggregate['open'][adUnitCode] = [];\n                _IndexRequestData.targetAggregate['open'][adUnitCode].push( slotID + \"_\" + currentCPM );\n              }\n              bids.push(bid);\n            }\n          }\n\n          var currentBid = undefined;\n\n          if (bids.length > 0) {\n            // Add all bid responses\n            for (var i = 0; i < bids.length; i++) {\n              bidmanager.addBidResponse(adUnitCode, bids[i]);\n            }\n          // No bids for expected bid, pass bid\n          } else {\n            var bid = bidfactory.createBid(2);\n            bid.bidderCode = ADAPTER_CODE;\n            currentBid = bid;\n            bidmanager.addBidResponse(adUnitCode, currentBid);\n          }\n\n        }\n      } catch (e) {\n        utils.logError('Error calling index adapter', ADAPTER_NAME, e);\n        logErrorBidResponse();\n      }\n      finally {\n        // ensure that previous targeting mapping is cleared\n        _IndexRequestData.targetIDToBid = {};\n      }\n\n      //slotIdMap is used to determine which slots will be bid on in a given request.\n      //Therefore it needs to be blanked after the request is handled, else we will submit 'bids' for the wrong ads.\n      slotIdMap={};\n    };\n  }\n\n  /*\n  Function in order to add a slot into the list if it hasn't been created yet, else it returns the same list.\n  */\n  function mergeSlotInto(slot,slotList){\n    for(var i = 0; i < slotList.length; i++){\n      if(slot.id === slotList[i].id){\n        return slotList;\n      }\n    }\n    slotList.push(slot);\n    return slotList;\n  }\n\n  function getSlotObj(obj, id) {\n    var arr = obj.slots;\n    var returnObj = {};\n    utils._each(arr, function (value) {\n      if (value.id === id) {\n        returnObj = value;\n      }\n    });\n\n    return returnObj;\n  }\n\n  function logErrorBidResponse() {\n    //no bid response\n    var bid = bidfactory.createBid(2);\n    bid.bidderCode = ADAPTER_CODE;\n\n    //log error to first add unit\n    bidmanager.addBidResponse(firstAdUnitCode, bid);\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = IndexExchangeAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/indexExchange.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\nvar utils = require('../utils.js');\nvar CONSTANTS = require('../constants.json');\n\nvar InnityAdapter = function InnityAdapter() {\n\n  function _callBids(params) {\n    var bidURL, bids = params.bids || [], requestURL = window.location.protocol + '//as.innity.com/synd/?cb=' + new Date().getTime() + '&ver=2&hb=1&output=js&';    \n    for (var i = 0; i < bids.length; i++) {\n      var requestParams = {}, bid = bids[i];\n      requestParams.pub = bid.params.pub;\n      requestParams.zone = bid.params.zone;\n      // Page URL\n      requestParams.url = utils.getTopWindowUrl();\n      // Sizes\n      var parseSized = utils.parseSizesInput(bid.sizes), arrSize = parseSized[0].split('x');\n      requestParams.width = arrSize[0];\n      requestParams.height = arrSize[1];\n      // Callback function\n      requestParams.callback = \"pbjs._doInnityCallback\";\n      // Callback ID\n      requestParams.callback_uid = bid.bidId;\n      // Load Bidder URL\n      bidURL = requestURL + utils.parseQueryStringParameters(requestParams);\n      utils.logMessage('Innity.prebid, Bid ID: ' + bid.bidId + ', Pub ID: ' + bid.params.pub + ', Zone ID: ' + bid.params.zone + ', URL: ' + bidURL);\n      adloader.loadScript(bidURL);\n    }\n  }\n\t\n  pbjs._doInnityCallback = function(response) {\n    var bidObject, bidRequest, callbackID, libURL = window.location.protocol + \"//cdn.innity.net/frame_util.js\";\n    callbackID = response.callback_uid;\n    bidRequest = utils.getBidRequest(callbackID);\n    if (response.cpm > 0) {\n      bidObject = bidfactory.createBid(CONSTANTS.STATUS.GOOD, bidRequest);\n      bidObject.bidderCode = 'innity';\n      bidObject.cpm = parseFloat(response.cpm) / 100;\n      bidObject.ad = '<script src=\"' + libURL + '\"></script>' + response.tag;\n      bidObject.width = response.width;\n      bidObject.height = response.height;\n    } else {\n      bidObject = bidfactory.createBid(CONSTANTS.STATUS.NO_BID, bidRequest);\n      bidObject.bidderCode = 'innity';\n      utils.logMessage('No Bid response from Innity request: ' + callbackID);\n    }\n    bidmanager.addBidResponse(bidRequest.placementCode, bidObject);\n  };\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = InnityAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/innity.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\n\nfunction _qs(key, value) {\n  return encodeURIComponent(key) + '=' + encodeURIComponent(value);\n}\n\nfunction _makeBidResponse(placementCode, bid) {\n  var bidResponse = bidfactory.createBid(bid !== undefined ? 1 : 2);\n  bidResponse.bidderCode = 'kruxlink';\n  if (bid !== undefined) {\n    bidResponse.cpm = bid.price;\n    bidResponse.ad = bid.adm;\n    bidResponse.width = bid.w;\n    bidResponse.height = bid.h;\n  }\n  bidmanager.addBidResponse(placementCode, bidResponse);\n}\n\nfunction _makeCallback(id, placements) {\n  var callback = '_kruxlink_' + id;\n  pbjs[callback] = function(response) {\n    // Clean up our callback\n    delete pbjs[callback];\n\n    // Add in the bid respones\n    if (response.seatbid !== undefined) {\n      for (var i = 0; i < response.seatbid.length; i++) {\n        var seatbid = response.seatbid[i];\n        if (seatbid.bid !== undefined) {\n          for (var j = 0; j < seatbid.bid.length; j++) {\n            var bid = seatbid.bid[j];\n            if (bid.impid !== undefined) {\n              _makeBidResponse(placements[bid.impid], bid);\n              delete placements[bid.impid];\n            }\n          }\n        }\n      }\n    }\n\n    // Add any no-bids remaining\n    for (var impid in placements) {\n      if (placements.hasOwnProperty(impid)) {\n        _makeBidResponse(placements[impid]);\n      }\n    }\n  };\n\n  return 'pbjs.' + callback;\n}\n\nfunction _callBids(params) {\n  var impids = [];\n  var placements = {};\n\n  var bids = params.bids || [];\n  for (var i = 0; i < bids.length; i++) {\n    var bidRequest = bids[i];\n    var bidRequestParams = bidRequest.params || {};\n    var impid = bidRequestParams.impid;\n    placements[impid] = bidRequest.placementCode;\n\n    impids.push(impid);\n  }\n\n  var callback = _makeCallback(params.bidderRequestId, placements);\n  var qs = [\n    _qs('id', params.bidderRequestId),\n    _qs('u', window.location.href),\n    _qs('impid', impids.join(',')),\n    _qs('calltype', 'pbd'),\n    _qs('callback', callback)\n  ];\n  var url = 'https://link.krxd.net/hb?' + qs.join('&');\n\n  adloader.loadScript(url);\n}\n\nmodule.exports = function KruxAdapter() {\n  return {\n    callBids: _callBids\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/kruxlink.js","/*jshint loopfunc: true */\n\nimport { STATUS } from 'src/constants';\n\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\n\nvar GetIntentAdapter = function GetIntentAdapter() {\n  var headerBiddingStaticJS = window.location.protocol + '//cdn.adhigh.net/adserver/hb.js';\n\n  function _callBids(params) {\n    if (typeof window.gi_hb === 'undefined') {\n      adloader.loadScript(headerBiddingStaticJS, function() {\n        bid(params);\n      }, true);\n    } else {\n      bid(params);\n    }\n  }\n\n  function addOptional(params, request, props) {\n    for (var i = 0; i < props.length; i++) {\n      if (params.hasOwnProperty(props[i])) {\n        request[props[i]] = params[props[i]];\n      }\n    }\n  }\n\n  function bid(params) {\n    var bids = params.bids || [];\n    for (var i = 0; i < bids.length; i++) {\n      var bidRequest = bids[i];\n      var request = {\n        pid: bidRequest.params.pid, // required\n        tid: bidRequest.params.tid, // required\n        known: bidRequest.params.known || 1,\n        is_video: bidRequest.mediaType === 'video',\n        video: bidRequest.params.video || {},\n        size: bidRequest.sizes[0].join(\"x\"),\n      };\n      addOptional(bidRequest.params, request, ['cur', 'floor']);\n      (function (r, br) {\n        window.gi_hb.makeBid(r, function(bidResponse) {\n          if (bidResponse.no_bid === 1) {\n            var nobid = bidfactory.createBid(STATUS.NO_BID);\n            nobid.bidderCode = br.bidder;\n            bidmanager.addBidResponse(br.placementCode, nobid);\n          } else {\n            var bid = bidfactory.createBid(STATUS.GOOD);\n            var size = bidResponse.size.split('x');\n            bid.bidderCode = br.bidder;\n            bid.cpm = bidResponse.cpm;\n            bid.width = size[0];\n            bid.height = size[1];\n            if (br.mediaType === 'video') {\n              bid.vastUrl = bidResponse.vast_url;\n              bid.descriptionUrl = bidResponse.vast_url;\n            } else {\n              bid.ad = bidResponse.ad;\n            }\n            bidmanager.addBidResponse(br.placementCode, bid);\n          }\n        });\n      })(request, bidRequest);\n    }\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = GetIntentAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/getintent.js","import * as utils from '../utils';\nimport Adapter from './adapter';\nimport {ajax} from '../ajax';\nimport bidManager from 'src/bidmanager';\nimport bidFactory from 'src/bidfactory';\nimport {STATUS} from 'src/constants';\nimport {formatQS} from '../url';\n\n/**\n * @type {{IA_JS: string, ADAPTER_NAME: string, V: string, RECTANGLE_SIZE: {W: number, H: number}, SPOT_TYPES: {INTERSTITIAL: string, RECTANGLE: string, FLOATING: string, BANNER: string}, DISPLAY_AD: number, ENDPOINT_URL: string, EVENTS_ENDPOINT_URL: string, RESPONSE_HEADERS_NAME: {PRICING_VALUE: string, AD_H: string, AD_W: string}}}\n */\nconst CONSTANTS = {\n  ADAPTER_NAME: 'inneractive',\n  V: 'IA-JS-HB-PBJS-1.0',\n  RECTANGLE_SIZE:{W: 300, H: 250},\n\n  SPOT_TYPES: {\n    INTERSTITIAL: 'interstitial',\n    RECTANGLE: 'rectangle',\n    FLOATING: 'floating',\n    BANNER: 'banner'\n  },\n\n  DISPLAY_AD: 20,\n  ENDPOINT_URL: '//ad-tag.inner-active.mobi/simpleM2M/requestJsonAd',\n  EVENTS_ENDPOINT_URL: '//vast-events.inner-active.mobi/Event',\n  RESPONSE_HEADERS_NAME: {\n    PRICING_VALUE: 'X-IA-Pricing-Value',\n    AD_H: 'X-IA-Ad-Height',\n    AD_W: 'X-IA-Ad-Width'\n  }\n};\n\nlet iaRef;\ntry{\n  iaRef = window.top.document.referrer;\n}catch(e){\n  iaRef = window.document.referrer;\n}\n\n/**\n * gloable util functions\n * @type {{defaultsQsParams: {v: (string|string), page: string, mw: boolean, hb: string}, stringToCamel: (function(*)), objectToCamel: (function(*=))}}\n */\nconst Helpers = {\n  defaultsQsParams: {v: CONSTANTS.V,page: encodeURIComponent(utils.getTopWindowUrl()),mw: true, hb: 'prebidjs'},\n  /**\n   * Change string format from underscore to camelcase (e.g., APP_ID to appId)\n   * @param str: string\n   * @returns string\n   */\n  stringToCamel(str){\n    if(str.indexOf('_') === -1){\n      const first = str.charAt(0);\n      if(first !== first.toLowerCase()){\n        str = str.toLowerCase();\n      }\n      return str;\n    }\n\n    str = str.toLowerCase();\n    return str.replace(/(\\_[a-z])/g, $1 => $1.toUpperCase().replace('_',''));\n  },\n\n  /**\n   * Change all object keys string format from underscore to camelcase (e.g., {'APP_ID' : ...} to {'appId' : ...})\n   * @param params: object\n   * @returns object\n   */\n  objectToCamel(params){\n    Object.keys(params).forEach(key => {\n      const keyCamelCase = this.stringToCamel(key);\n      if(keyCamelCase !== key){\n        params[keyCamelCase] = params[key];\n        delete params[key];\n      }\n    });\n    return params;\n  }\n};\n\n/**\n * Tracking pixels for events\n * @type {{fire: (function(*=))}}\n */\nconst Tracker = {\n  /**\n   * Creates a tracking pixel\n   * @param urls: Array<String>\n   */\n  fire(urls){\n    urls.forEach(url => url && ((new Image(1,1)).src = encodeURI(url)));\n  }\n};\n\n/**\n * Analytics\n * @type {{errorEventName: string, pageProtocol: string, getPageProtocol: (function(): string), getEventUrl: (function(*, *=)), reportEvent: (function(string, Object)), defaults: {v: (string|string), page: string, mw: boolean, hb: string}, eventQueryStringParams: (function(Object): string), createTrackingPixel: (function(string))}}\n */\nconst Reporter = {\n  /**\n   * @private\n   */\n  errorEventName: 'HBPreBidError',\n  pageProtocol: '',\n\n  /**\n   * Gets the page protocol based on the <code>document.location.protocol</code>\n   * The returned string is either <code>http://</code> or <code>https://</code>\n   * @returns {string}\n   */\n  getPageProtocol(){\n    if(!this.pageProtocol){\n      this.pageProtocol = ('http:' === utils.getTopWindowLocation().protocol ? 'http:' : 'https:');\n    }\n    return this.pageProtocol;\n  },\n\n  getEventUrl(evtName, extraDetails){\n    let eventsEndpoint = CONSTANTS.EVENTS_ENDPOINT_URL + '?table=' + ((evtName === this.errorEventName) ? 'mbwError' : 'mbwEvent');\n    let queryStringParams = this.eventQueryStringParams(extraDetails);\n    const appId = extraDetails && extraDetails.appId;\n    let queryStringParamsWithAID = `${queryStringParams}&aid=${appId}_${evtName}_other&evtName=${evtName}`;\n    return eventsEndpoint + '&' + queryStringParamsWithAID;\n  },\n\n  /**\n   * Reports an event to IA's servers.\n   * @param {string} evtName - event name as string.\n   * @param {object} extraDetails - e.g., a JS exception JSON object.\n   * @param shouldSendOnlyToNewEndpoint\n   */\n  reportEvent(evtName, extraDetails) {\n    const url = this.getEventUrl(evtName, extraDetails);\n    this.createTrackingPixel(url);\n  },\n  defaults: Helpers.defaultsQsParams,\n\n  /**\n   * Ia Event Reporting Query String Parameters, not including App Id.\n   * @param {object} extraDetails - e.g., a JS exception JSON object.\n   * @return {string} IA event contcatenated queryString parameters.\n   */\n  eventQueryStringParams(extraDetails) {\n    const toQS = Object.assign({}, this.defaults, {realAppId: extraDetails && extraDetails.appId, timestamp: Date.now()});\n    return formatQS(toQS);\n  },\n\n  /**\n   * Creates a tracking pixel by prepending the page's protocol to the URL sent as the param.\n   * @param {string} urlWithoutProtocol - the URL to send the tracking pixel to, without the protocol as a prefix.\n   */\n  createTrackingPixel(urlWithoutProtocol) {\n    Tracker.fire([this.getPageProtocol() + urlWithoutProtocol]);\n  }\n};\n\n/**\n * Url generator - generates a request URL\n * @type {{defaultsParams: *, serverParamNameBySettingParamName: {referrer: string, keywords: string, appId: string, portal: string, age: string, gender: string, isSecured: (boolean|null)}, toServerParams: (function(*)), unwantedValues: *[], getUrlParams: (function(*=))}}\n */\nconst Url = {\n  defaultsParams: Object.assign({}, Helpers.defaultsQsParams, {f: CONSTANTS.DISPLAY_AD,fs: false,ref: iaRef}),\n  serverParamNameBySettingParamName: {\n    referrer: 'ref',\n    keywords: 'k',\n    appId: 'aid',\n    portal: 'po',\n    age: 'a',\n    gender: 'g',\n  },\n  unwantedValues: ['', null, undefined],\n\n  /**\n   * Maps publisher params to server params\n   * @param params: object {k:v}\n   * @returns object {k:v}\n   */\n  toServerParams(params){\n    const serverParams = {};\n    for(const paramName in params){\n      if(params.hasOwnProperty(paramName) && this.serverParamNameBySettingParamName.hasOwnProperty(paramName)){\n        serverParams[this.serverParamNameBySettingParamName[paramName]] = params[paramName];\n      }else{\n        serverParams[paramName] = params[paramName];\n      }\n    }\n\n    serverParams.isSecured = Reporter.getPageProtocol() === 'https:' || null;\n    return serverParams;\n  },\n\n  /**\n   * Prepare querty string to ad server\n   * @param params: object {k:v}\n   * @returns : object {k:v}\n   */\n  getUrlParams(params){\n    const serverParams = this.toServerParams(params);\n    const toQueryString = Object.assign({}, this.defaultsParams, serverParams);\n    for(const paramName in toQueryString){\n      if(toQueryString.hasOwnProperty(paramName) && this.unwantedValues.indexOf(toQueryString[paramName]) !== -1){\n        delete toQueryString[paramName];\n      }\n    }\n    toQueryString.fs = params.spotType === CONSTANTS.SPOT_TYPES.INTERSTITIAL;\n\n    if(params.spotType === CONSTANTS.SPOT_TYPES.RECTANGLE){\n      toQueryString.rw = CONSTANTS.RECTANGLE_SIZE.W;\n      toQueryString.rh = CONSTANTS.RECTANGLE_SIZE.H;\n    }\n\n    if (typeof pbjs !== 'undefined') {\n      toQueryString.bco = pbjs.cbTimeout || pbjs.bidderTimeout;\n    }\n\n    toQueryString.timestamp = Date.now();\n    delete toQueryString.qa;\n    return toQueryString;\n  }\n};\n\n/**\n * Http helper to extract metadata\n * @type {{headers: *[], getBidHeaders: (function(*))}}\n */\nconst Http = {\n  headers: [\n    CONSTANTS.RESPONSE_HEADERS_NAME.PRICING_VALUE,\n    CONSTANTS.RESPONSE_HEADERS_NAME.AD_H,\n    CONSTANTS.RESPONSE_HEADERS_NAME.AD_W\n  ],\n\n  /**\n   * Extract headers data\n   * @param xhr: XMLHttpRequest\n   * @returns {}\n   */\n  getBidHeaders(xhr){\n    const headersData = {};\n    this.headers.forEach(headerName => headersData[headerName] = xhr.getResponseHeader(headerName));\n    return headersData;\n  }\n};\n\n\n/**\n * InnerActiveAdapter for requesting bids\n * @class\n */\nclass InnerActiveAdapter{\n  constructor(){\n    this.iaAdapter = Adapter.createNew(CONSTANTS.ADAPTER_NAME);\n    this.bidByBidId = {};\n  }\n\n  /**\n   * validate if bid request is valid\n   * @param adSettings: object\n   * @returns {boolean}\n   * @private\n   */\n  _isValidRequest(adSettings){\n    if(adSettings && adSettings.appId && adSettings.spotType){\n      return true;\n    }\n    utils.logError('bid requires appId');\n    return false;\n  }\n\n  /**\n   * Store the bids in a Map object (k: bidId, v: bid)to check later if won\n   * @param bid\n   * @returns bid object\n   * @private\n   */\n  _storeBidRequestDetails(bid){\n    this.bidByBidId[bid.bidId] = bid;\n    return bid;\n  }\n\n  /**\n   * @param bidStatus: int (\"STATUS\": {\"GOOD\": 1,\"NO_BID\": 2})\n   * @param bidResponse: object\n   * @returns {type[]}\n   * @private\n   */\n  _getBidDetails(bidStatus, bidResponse, bidId){\n    let bid = bidFactory.createBid(bidStatus, bidResponse);\n    bid.code = CONSTANTS.ADAPTER_NAME;\n    bid.bidderCode = bid.code;\n    if (bidStatus === STATUS.GOOD) {\n      bid = Object.assign(bid, bidResponse);\n      this._setBidCpm(bid, bidId);\n    }\n    return bid;\n  }\n\n  _setBidCpm(bid, bidId){\n    const storedBid = this.bidByBidId[bidId];\n    if(storedBid){\n      bid.cpm = storedBid.params && storedBid.params.qa && storedBid.params.qa.cpm || bid.cpm;\n      bid.cpm = (bid.cpm !== null && !isNaN(bid.cpm)) ? parseFloat(bid.cpm) : 0.0;\n    }\n  }\n\n  /**\n   * Validate if response is valid\n   * @param responseAsJson : object\n   * @param headersData: {}\n   * @returns {boolean}\n   * @private\n   */\n  _isValidBidResponse(responseAsJson, headersData){\n    return (responseAsJson && responseAsJson.ad && responseAsJson.ad.html && headersData && headersData[CONSTANTS.RESPONSE_HEADERS_NAME.PRICING_VALUE] > 0);\n  }\n\n  /**\n   * When response is received\n   * @param response: string(json format)\n   * @param xhr: XMLHttpRequest\n   * @param bidId: string\n   * @private\n   */\n  _onResponse(response, xhr, bidId){\n    const bid = this.bidByBidId[bidId];\n    const [w, h] = bid.sizes[0];\n    const size = {w, h};\n    let responseAsJson;\n    const headersData = Http.getBidHeaders(xhr);\n    try {\n      responseAsJson = JSON.parse(response);\n    } catch (error) {\n      utils.logError(error);\n    }\n\n    if (!this._isValidBidResponse(responseAsJson, headersData)) {\n      let errorMessage = `response failed for ${CONSTANTS.ADAPTER_NAME} adapter`;\n      utils.logError(errorMessage);\n      const passback = responseAsJson && responseAsJson.config && responseAsJson.config.passback;\n      if(passback) {\n        Tracker.fire([passback]);\n      }\n      Reporter.reportEvent('HBPreBidNoAd', bid.params);\n      return bidManager.addBidResponse(bid.placementCode, this._getBidDetails(STATUS.NO_BID));\n    }\n    const bidResponse = {\n      cpm: headersData[CONSTANTS.RESPONSE_HEADERS_NAME.PRICING_VALUE]*1000,\n      width: parseFloat(headersData[CONSTANTS.RESPONSE_HEADERS_NAME.AD_W]) || size.w,\n      ad: this._getAd(responseAsJson.ad.html, responseAsJson.config.tracking, bid.params),\n      height: parseFloat(headersData[CONSTANTS.RESPONSE_HEADERS_NAME.AD_H]) || size.h\n    };\n    const auctionBid = this._getBidDetails(STATUS.GOOD, bidResponse, bidId);\n    bid.adId = auctionBid.adId;\n    this.bidByBidId[bidId] = bid;\n    bidManager.addBidResponse(bid.placementCode, auctionBid);\n  }\n\n  /**\n   * Returns the ad HTML template\n   * @param adHtml: string {ad server creative}\n   * @param tracking: object {impressions, clicks}\n   * @param bidParams: object\n   * @returns {string}: create template\n   * @private\n   */\n  _getAd(adHtml, tracking, bidParams){\n\n    let impressionsHtml = '';\n    if(tracking && Array.isArray(tracking.impressions)){\n      let impressions = tracking.impressions;\n      impressions.push(Reporter.getEventUrl('HBPreBidImpression', bidParams, false));\n      impressions.forEach(impression => impression && (impressionsHtml += utils.createTrackPixelHtml(impression)));\n    }\n    adHtml = impressionsHtml + adHtml.replace(/<a /g, '<a target=\"_blank\" ');\n    let clicks = tracking && Array.isArray(tracking.clicks) && tracking.clicks;\n    if(clicks && Array.isArray(clicks)){\n      clicks.push(Reporter.getEventUrl('HBPreBidClick', bidParams, false));\n    }\n    const adTemplate = `\n      <html>\n        <head>\n            <script type='text/javascript'>inDapIF=true;</script>\n        </head>\n        <body style='margin : 0; padding: 0;'>\n            <div id=\"iaAdContainer\">${adHtml}</div>\n            <script type='text/javascript'>\n                var iaAdContainer = document.getElementById('iaAdContainer');\n                if(iaAdContainer){\n                    var clicks = '${clicks}';\n                    if(clicks){\n                      clicks = clicks.split(',');\n                      iaAdContainer.addEventListener('click', function onIaContainerClick(){\n                          clicks.forEach(function forEachClick(click){\n                              if(click){\n                                  (new Image(1,1)).src = encodeURI(click);\n                              }\n                          });\n                      });\n                    }\n                }\n            </script>\n        </body>\n      </html>`;\n    return adTemplate;\n  }\n  /**\n   * Adjust bid params to ia-ad-server params\n   * @param bid: object\n   * @private\n   */\n  _toIaBidParams(bid){\n    const bidParamsWithCustomParams = Object.assign({}, bid.params, bid.params.customParams);\n    delete bidParamsWithCustomParams.customParams;\n    bid.params = Helpers.objectToCamel(bidParamsWithCustomParams);\n  }\n  \n  /**\n   * Prebid executes for stating an auction\n   * @param bidRequest: object\n   */\n  callBids(bidRequest){\n    const bids = bidRequest.bids || [];\n    bids.forEach(bid => this._toIaBidParams(bid));\n    bids\n      .filter(bid => this._isValidRequest(bid.params))\n      .map(bid => this._storeBidRequestDetails(bid))\n      .forEach(bid => ajax(this._getEndpointUrl(bid.params), (response, xhr) => this._onResponse(response, xhr, bid.bidId), Url.getUrlParams(bid.params), {method: 'GET'}));\n  }\n\n  _getEndpointUrl(params){\n    return params && params.qa && params.qa.url || Reporter.getPageProtocol() + CONSTANTS.ENDPOINT_URL;\n  }\n\n  _getStoredBids(){\n    const storedBids = [];\n    for(const bidId in this.bidByBidId){\n      if(this.bidByBidId.hasOwnProperty(bidId)) {\n        storedBids.push(this.bidByBidId[bidId]);\n      }\n    }\n    return storedBids;\n  }\n\n  /**\n   * Return internal object - testing\n   * @returns {{Reporter: {errorEventName: string, pageProtocol: string, getPageProtocol: (function(): string), getEventUrl: (function(*, *=)), reportEvent: (function(string, Object)), defaults: {v: (string|string), page: string, mw: boolean, hb: string}, eventQueryStringParams: (function(Object): string), createTrackingPixel: (function(string))}}}\n   * @private\n   */\n  static _getUtils(){\n    return {Reporter};\n  }\n\n  /**\n   * Creates new instance of InnerActiveAdapter for prebid auction\n   * @returns {InnerActiveAdapter}\n   */\n  static createNew(){\n    return new InnerActiveAdapter();\n  }\n}\nmodule.exports = InnerActiveAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/inneractive.js","import Adapter from 'src/adapters/adapter';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport { ajax } from 'src/ajax';\nimport { STATUS } from 'src/constants';\n\nconst ENDPOINT = '//bidder.komoona.com/v1/GetSBids';\n\nfunction KomoonaAdapter() {\n\n  let baseAdapter = Adapter.createNew('komoona');\n  let bidRequests = {};\n\n  /* Prebid executes this function when the page asks to send out bid requests */\n  baseAdapter.callBids = function(bidRequest) {\n    const bids = bidRequest.bids || [];\n    const tags = bids\n      .filter(bid => valid(bid))\n      .map(bid => {\n        // map request id to bid object to retrieve adUnit code in callback\n        bidRequests[bid.bidId] = bid;\n\n        let tag = {};\n        tag.sizes = bid.sizes;\n        tag.uuid = bid.bidId;\n        tag.placementid = bid.params.placementId;\n        tag.hbid = bid.params.hbid;\n\n        return tag;\n      });\n\n    if (!utils.isEmpty(tags)) {\n      const payload = JSON.stringify({bids: [...tags]});\n\n      ajax(ENDPOINT, handleResponse, payload, {\n        contentType: 'text/plain',\n        withCredentials : true\n      });\n    }\n  };\n\n  /* Notify Prebid of bid responses so bids can get in the auction */\n  function handleResponse(response) {\n    let parsed;\n\n    try {\n      parsed = JSON.parse(response);\n    } catch (error) {\n      utils.logError(error);\n    }\n\n    if (!parsed || parsed.error) {\n      let errorMessage = `in response for ${baseAdapter.getBidderCode()} adapter`;\n      if (parsed && parsed.error) {errorMessage += `: ${parsed.error}`;}\n      utils.logError(errorMessage);\n\n      // signal this response is complete\n      Object.keys(bidRequests)\n        .map(bidId => bidRequests[bidId].placementCode)\n        .forEach(placementCode => {\n          bidmanager.addBidResponse(placementCode, createBid(STATUS.NO_BID));\n        });\n\n      return;\n    }\n\n    parsed.bids.forEach(tag => {\n      let status;\n      if (tag.cpm > 0 && tag.creative) {\n        status = STATUS.GOOD;\n      } else {\n        status = STATUS.NO_BID;\n      }\n\n      tag.bidId = tag.uuid;  // bidfactory looks for bidId on requested bid\n      const bid = createBid(status, tag);\n      const placement = bidRequests[bid.adId].placementCode;\n\n      bidmanager.addBidResponse(placement, bid);\n    });\n  }\n\n  /* Check that a bid has required paramters */\n  function valid(bid) {\n    if (bid.params.placementId && bid.params.hbid) {\n      return bid;\n    } else {\n      utils.logError('bid requires placementId and hbid params');\n    }\n  }\n\n  /* Create and return a bid object based on status and tag */\n  function createBid(status, tag) {\n    let bid = bidfactory.createBid(status, tag);\n    bid.code = baseAdapter.getBidderCode();\n    bid.bidderCode = baseAdapter.getBidderCode();\n\n    if (status === STATUS.GOOD) {\n      bid.cpm = tag.cpm;\n      bid.width = tag.width;\n      bid.height = tag.height;\n      bid.ad = tag.creative;\n    }\n\n    return bid;\n  }\n\n  return {\n    createNew: KomoonaAdapter.createNew,\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode,\n  };\n}\n\nKomoonaAdapter.createNew = function() {\n  return new KomoonaAdapter();\n};\n\nmodule.exports = KomoonaAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/komoona.js","const bidfactory = require('../bidfactory.js');\nconst bidmanager = require('../bidmanager');\nconst utils = require('../utils.js');\nconst adloader = require('../adloader');\n\nconst LifestreetAdapter = function LifestreetAdapter() {\n  const BIDDER_CODE = 'lifestreet';\n  const ADAPTER_VERSION = 'prebidJS-1.0';\n  const SLOTS_LOAD_MAP = {};\n  const PREBID_REQUEST_MESSAGE = 'LSMPrebid Request';\n  const PREBID_RESPONSE_MESSAGE = 'LSMPrebid Response';\n\n  function _callBids(params) {\n    utils._each(params.bids, bid => {\n      const jstagUrl = bid.params.jstag_url;\n      const slot = bid.params.slot;\n      const adkey = bid.params.adkey;\n      const adSize = bid.params.ad_size;\n      let timeout = 700;\n      if (bid.params.timeout) {\n        timeout = bid.params.timeout;\n      }\n      let shouldRequest = false;\n      if (jstagUrl && jstagUrl.length > 0 && slot && slot.length > 0 &&\n          adkey && adkey.length > 0 && adSize && adSize.length > 0) {\n        let adSizeArray = adSize.split('x');\n        for (let i = 0; i < adSizeArray.length; ++i) {\n          adSizeArray[i] = +adSizeArray[i];\n        }\n        if (bid.sizes && (bid.sizes instanceof Array) && bid.sizes.length > 0 && adSizeArray.length > 1) {\n          bid.sizes = !(bid.sizes[0] instanceof Array) ? [ bid.sizes ] : bid.sizes;\n          for (let i = 0; i < bid.sizes.length; ++i) {\n            let size = bid.sizes[i];\n            if (size.length > 1) {\n              if (size[0] === adSizeArray[0] && size[1] === adSizeArray[1]) {\n                shouldRequest = true;\n                break;\n              }\n            }\n          }\n        } else {\n          shouldRequest = true;\n        }\n      }\n      if (shouldRequest) {\n        _callJSTag(bid, jstagUrl, timeout);\n      } else {\n        _addSlotBidResponse(bid, 0, null, 0, 0);\n      }\n    });\n  }\n\n  function _callJSTag(bid, jstagUrl, timeout) {\n    adloader.loadScript(jstagUrl, () => {\n      /*global LSM_Slot */\n      if (LSM_Slot && typeof LSM_Slot === 'function') {\n        let slotTagParams = {\n          _preload: 'wait',\n          _hb_request: ADAPTER_VERSION,\n          _timeout: timeout,\n          _onload: (slot, action, cpm, width, height) => {\n            if (slot.state() !== 'error') {\n              let slotName = slot.getSlotObjectName();\n              pbjs[slotName] = slot;\n              if (slotName && !SLOTS_LOAD_MAP[slotName]) {\n                SLOTS_LOAD_MAP[slotName] = true;\n                let ad = _constructLSMAd(jstagUrl, slotName);\n                _addSlotBidResponse(bid, cpm, ad, width, height);\n              } else {\n                slot.show();\n              }\n            } else {\n              _addSlotBidResponse(bid, 0, null, 0, 0);\n            }\n          }\n        };\n        for (let property in bid.params) {\n          if (property === 'jstag_url' || property === 'timeout') {\n            continue;\n          }\n          if (bid.params.hasOwnProperty(property)) {\n            slotTagParams[property] = bid.params[property];\n          }\n        }\n        /*jshint newcap: false */\n        LSM_Slot(slotTagParams);\n        window.addEventListener('message', (ev) => {\n          let key = ev.message ? 'message' : 'data';\n          let object = {};\n          try {\n            object = JSON.parse(ev[key]);\n          } catch (e) {\n            return;\n          }\n          if (object.message && object.message === PREBID_REQUEST_MESSAGE && object.slotName &&\n              window.pbjs[object.slotName]) {\n            ev.source.postMessage(JSON.stringify({\n              message: PREBID_RESPONSE_MESSAGE,\n              slotObject: window.pbjs[object.slotName]\n            }), '*');\n            window.pbjs[object.slotName].destroy();\n            window.pbjs[object.slotName] = null;\n          }\n        }, false);\n      } else {\n        _addSlotBidResponse(bid, 0, null, 0, 0);\n      }\n    });\n  }\n\n  function _addSlotBidResponse(bid, cpm, ad, width, height) {\n    let hasResponse = cpm && ad && ad.length > 0;\n    let bidObject = bidfactory.createBid(hasResponse ? 1 : 2, bid);\n    bidObject.bidderCode = BIDDER_CODE;\n    if (hasResponse) {\n      bidObject.cpm = cpm;\n      bidObject.ad = ad;\n      bidObject.width = width;\n      bidObject.height = height;\n    }\n    bidmanager.addBidResponse(bid.placementCode, bidObject);\n  }\n\n  function _constructLSMAd(jsTagUrl, slotName) {\n    if (jsTagUrl && slotName) {\n      return `<div id=\"LSM_AD\"></div>\n             <script type=\"text/javascript\" src='` + jsTagUrl + `'></script>\n             <script>\n              function receivedLSMMessage(ev) {\n                var key = ev.message ? 'message' : 'data';\n                var object = {};\n                try {\n                  object = JSON.parse(ev[key]);\n                } catch (e) {\n                  return;\n                }\n                if (object.message === '` + PREBID_RESPONSE_MESSAGE + `' && object.slotObject) {\n                  var slot  = object.slotObject;\n                  slot.__proto__ = slotapi.Slot.prototype;\n                  slot.getProperties()['_onload'] = function(slot) {\n                    if (slot.state() !== 'error') {\n                      slot.show();\n                    }\n                  };\n                  window[slot.getSlotObjectName()] = slot;\n                  slot.showInContainer(document.getElementById(\"LSM_AD\"));\n                }\n              }\n              window.addEventListener('message', receivedLSMMessage, false);\n              window.parent.postMessage(JSON.stringify({\n                message: '` + PREBID_REQUEST_MESSAGE + `',\n                slotName: '` + slotName +`'\n              }), '*');\n            </script>`;\n    }\n    return null;\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = LifestreetAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/lifestreet.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\nvar constants = require('../constants.json');\n\nmodule.exports = function () {\n  function inIframe() {\n    try {\n      return window.self !== window.top && !window.mantis_link;\n    } catch (e) {\n      return true;\n    }\n  }\n\n  function isDesktop(ignoreTouch) {\n    var scope = function (win) {\n      var width = win.innerWidth || win.document.documentElement.clientWidth || win.document.body.clientWidth;\n      var supportsTouch = !ignoreTouch && ('ontouchstart' in window || navigator.msMaxTouchPoints);\n\n      return !supportsTouch && (!width || width >= (window.mantis_breakpoint || 768));\n    };\n\n    if (inIframe()) {\n      try {\n        return scope(window.top);\n      } catch (ex) {\n      }\n    }\n\n    return scope(window);\n  }\n\n  function isSendable(val) {\n    if (val === null || val === undefined) {\n      return false;\n    }\n\n    if (typeof val === 'string') {\n      return !(!val || /^\\s*$/.test(val));\n    }\n\n    if (typeof val === 'number') {\n      return !isNaN(val);\n    }\n\n    return true;\n  }\n\n  function isObject(value) {\n    return Object.prototype.toString.call(value) === '[object Object]';\n  }\n\n  function isAmp() {\n    return typeof window.context === \"object\" && (window.context.tagName === \"AMP-AD\" || window.context.tagName === \"AMP-EMBED\");\n  }\n\n  function isSecure() {\n    return document.location.protocol === \"https:\";\n  }\n\n  function isArray(value) {\n    return Object.prototype.toString.call(value) === '[object Array]';\n  }\n\n  function jsonp(callback) {\n    if (!window.mantis_jsonp) {\n      window.mantis_jsonp = [];\n    }\n\n    window.mantis_jsonp.push(callback);\n\n    return 'mantis_jsonp[' + (window.mantis_jsonp.length - 1) + ']';\n  }\n\n  function jsonToQuery(data, chain, form) {\n    if (!data) {\n      return null;\n    }\n\n    var parts = form || [];\n\n    for (var key in data) {\n      var queryKey = key;\n\n      if (chain) {\n        queryKey = chain + '[' + key + ']';\n      }\n\n      var val = data[key];\n\n      if (isArray(val)) {\n        for (var index = 0; index < val.length; index++) {\n          var akey = queryKey + '[' + index + ']';\n          var aval = val[index];\n\n          if (isObject(aval)) {\n            jsonToQuery(aval, akey, parts);\n          } else if (isSendable(aval)) {\n            parts.push(akey + '=' + encodeURIComponent(aval));\n          }\n        }\n      } else if (isObject(val)) {\n        jsonToQuery(val, queryKey, parts);\n      } else if (isSendable(val)) {\n        parts.push(queryKey + '=' + encodeURIComponent(val));\n      }\n    }\n\n    return parts.join('&');\n  }\n\n\n  function buildMantisUrl(path, data, domain) {\n    var params = {\n      referrer: document.referrer,\n      tz: new Date().getTimezoneOffset(),\n      buster: new Date().getTime(),\n      secure: isSecure()\n    };\n\n    if (!inIframe() || isAmp()) {\n      params.mobile = !isAmp() && isDesktop(true) ? 'false' : 'true';\n    }\n\n    if (window.mantis_uuid) {\n      params.uuid = window.mantis_uuid;\n    } else if (window.localStorage) {\n      var localUuid = window.localStorage.getItem('mantis:uuid');\n\n      if (localUuid) {\n        params.uuid = localUuid;\n      }\n    }\n\n    if (!inIframe()) {\n      try {\n        params.title = window.top.document.title;\n        params.referrer = window.top.document.referrer;\n        params.url = window.top.document.location.href;\n      } catch (ex) {\n\n      }\n    } else {\n      params.iframe = true;\n    }\n\n    if (isAmp()) {\n      if (!params.url && window.context.canonicalUrl) {\n        params.url = window.context.canonicalUrl;\n      }\n\n      if (!params.url && window.context.location) {\n        params.url = window.context.location.href;\n      }\n\n      if (!params.referrer && window.context.referrer) {\n        params.referrer = window.context.referrer;\n      }\n    }\n\n    Object.keys(data || {}).forEach(function (key) {\n      params[key] = data[key];\n    });\n\n    var query = jsonToQuery(params);\n\n    return (window.mantis_domain === undefined ? domain || 'https://mantodea.mantisadnetwork.com' : window.mantis_domain) + path + '?' + query;\n  }\n\n  var Prebid = function (bidfactory, bidmanager, adloader, constants) {\n    return {\n      callBids: function (params) {\n        var property = null;\n\n        params.bids.some(function (bid) {\n          if (bid.params.property) {\n            property = bid.params.property;\n\n            return true;\n          }\n        });\n\n        var url = {\n          jsonp: jsonp(function (resp) {\n            params.bids.forEach(function (bid) {\n              var ad = resp.ads[bid.bidId];\n\n              var bidObject;\n\n              if (ad) {\n                bidObject = bidfactory.createBid(constants.STATUS.GOOD);\n                bidObject.bidderCode = 'mantis';\n                bidObject.cpm = ad.cpm;\n                bidObject.ad = ad.html;\n                bidObject.width = ad.width;\n                bidObject.height = ad.height;\n              } else {\n                bidObject = bidfactory.createBid(constants.STATUS.NO_BID);\n                bidObject.bidderCode = 'mantis';\n              }\n\n              bidmanager.addBidResponse(bid.placementCode, bidObject);\n            });\n          }),\n          property: property,\n          bids: params.bids.map(function (bid) {\n            return {\n              bidId: bid.bidId,\n              config: bid.params,\n              sizes: bid.sizes.map(function (size) {\n                return {width: size[0], height: size[1]};\n              })\n            };\n          }),\n          version: 1\n        };\n\n        adloader.loadScript(buildMantisUrl('/website/prebid', url));\n      }\n    };\n  };\n\n  return new Prebid(bidfactory, bidmanager, adloader, constants);\n};\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/mantis.js","const bidfactory = require('../bidfactory.js');\nconst bidmanager = require('../bidmanager.js');\nconst adloader = require('../adloader');\nconst CONSTANTS = require('../constants.json');\nconst utils = require('../utils.js');\n\nconst OpenxAdapter = function OpenxAdapter() {\n  const BIDDER_CODE = 'openx';\n  const BIDDER_CONFIG = 'hb_pb';\n  let startTime;\n\n  let pdNode = null;\n\n  pbjs.oxARJResponse = function (oxResponseObj) {\n    let adUnits = oxResponseObj.ads.ad;\n    if (oxResponseObj.ads && oxResponseObj.ads.pixels) {\n      makePDCall(oxResponseObj.ads.pixels);\n    }\n\n    if (!adUnits) {\n      adUnits = [];\n    }\n\n    let bids = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'openx').bids;\n    for (let i = 0; i < bids.length; i++) {\n      let bid = bids[i];\n      let auid = null;\n      let adUnit = null;\n      // find the adunit in the response\n      for (let j = 0; j < adUnits.length; j++) {\n        adUnit = adUnits[j];\n        if (String(bid.params.unit) === String(adUnit.adunitid) && adUnitHasValidSizeFromBid(adUnit,bid) && !adUnit.used) {\n          auid = adUnit.adunitid;\n          break;\n        }\n      }\n\n      let beaconParams = {\n        bd: +(new Date()) - startTime,\n        br: '0', // maybe 0, t, or p\n        bt: pbjs.cbTimeout || pbjs.bidderTimeout , // For the timeout per bid request\n        bs: window.location.hostname\n      };\n\n      // no fill :(\n      if (!auid || !adUnit.pub_rev) {\n        addBidResponse(null, bid);\n        continue;\n      }\n      adUnit.used = true;\n\n      beaconParams.br = beaconParams.bt < beaconParams.bd ? 't' : 'p';\n      beaconParams.bp = adUnit.pub_rev;\n      beaconParams.ts = adUnit.ts;\n      addBidResponse(adUnit, bid);\n      buildBoPixel(adUnit.creative[0], beaconParams);\n    }\n  };\n\n  function getViewportDimensions(isIfr) {\n    let width,\n      height,\n      tWin = window,\n      tDoc = document,\n      docEl = tDoc.documentElement,\n      body;\n\n    if (isIfr) {\n      try {\n        tWin = window.top;\n        tDoc = window.top.document;\n      }\n      catch (e) {\n        return;\n      }\n      docEl = tDoc.documentElement;\n      body = tDoc.body;\n\n      width = tWin.innerWidth || docEl.clientWidth || body.clientWidth;\n      height = tWin.innerHeight || docEl.clientHeight || body.clientHeight;\n    } else {\n      docEl = tDoc.documentElement;\n      width = tWin.innerWidth || docEl.clientWidth;\n      height = tWin.innerHeight || docEl.clientHeight;\n    }\n\n    return `${width}x${height}`;\n  }\n\n  function makePDCall(pixelsUrl) {\n    let pdFrame = utils.createInvisibleIframe();\n    let name = 'openx-pd';\n    pdFrame.setAttribute(\"id\", name);\n    pdFrame.setAttribute(\"name\", name);\n    let rootNode = document.body;\n\n    if (!rootNode) {\n      return;\n    }\n\n    pdFrame.src = pixelsUrl;\n\n    if (pdNode) {\n      pdNode.parentNode.replaceChild(pdFrame, pdNode);\n      pdNode = pdFrame;\n    } else {\n      pdNode = rootNode.appendChild(pdFrame);\n    }\n  }\n\n  function addBidResponse(adUnit, bid) {\n    let bidResponse = bidfactory.createBid(adUnit ? CONSTANTS.STATUS.GOOD : CONSTANTS.STATUS.NO_BID, bid);\n    bidResponse.bidderCode = BIDDER_CODE;\n\n    if (adUnit) {\n      let creative = adUnit.creative[0];\n      bidResponse.ad = adUnit.html;\n      bidResponse.cpm = Number(adUnit.pub_rev) / 1000;\n      bidResponse.ad_id = adUnit.adid;\n      if (adUnit.deal_id) {\n        bidResponse.dealId = adUnit.deal_id;\n      }\n      if (creative) {\n        bidResponse.width = creative.width;\n        bidResponse.height = creative.height;\n      }\n    }\n    bidmanager.addBidResponse(bid.placementCode, bidResponse);\n  }\n\n  function buildQueryStringFromParams(params) {\n    for (let key in params) {\n      if (params.hasOwnProperty(key)) {\n        if (!params[key]) {\n          delete params[key];\n        }\n      }\n    }\n    return utils._map(Object.keys(params), key => `${key}=${params[key]}`)\n      .join('&');\n  }\n\n  function buildBoPixel(creative, params) {\n    let img = new Image();\n    let recordPixel = creative.tracking.impression;\n    let boBase = recordPixel.match(/([^?]+\\/)ri\\?/);\n\n    if (boBase) {\n      img.src = `${boBase[1]}bo?${buildQueryStringFromParams(params)}`;\n    }\n  }\n\n  function adUnitHasValidSizeFromBid(adUnit, bid) {\n    let sizes = utils.parseSizesInput(bid.sizes);\n    let sizeLength = sizes && sizes.length || 0;\n    let found = false;\n    let creative = adUnit.creative && adUnit.creative[0];\n    let creative_size = String(creative.width) + 'x' + String(creative.height);\n\n    if (utils.isArray(sizes)) {\n      for (let i = 0; i < sizeLength; i++) {\n        let size = sizes[i];\n        if (String(size) === String(creative_size)) {\n          found = true;\n          break;\n        }\n      }\n    }\n    return found;\n  }\n\n  function buildRequest(bids, params, delDomain) {\n    if (!utils.isArray(bids)) {\n      return;\n    }\n\n    params.auid = utils._map(bids, bid => bid.params.unit).join('%2C');\n    params.aus = utils._map(bids, bid => {\n      return utils.parseSizesInput(bid.sizes).join(',');\n    }).join('|');\n\n    bids.forEach(function (bid) {\n      for (let customParam in bid.params.customParams) {\n        if (bid.params.customParams.hasOwnProperty(customParam)) {\n          params[\"c.\" + customParam] = bid.params.customParams[customParam];\n        }\n      }\n    });\n\n    params.callback = 'window.pbjs.oxARJResponse';\n    let queryString = buildQueryStringFromParams(params);\n\n    adloader.loadScript(`//${delDomain}/w/1.0/arj?${queryString}`);\n  }\n\n  function callBids(params) {\n    let isIfr,\n      bids = params.bids || [],\n      currentURL = (window.parent !== window) ? document.referrer : window.location.href;\n    currentURL = currentURL && encodeURIComponent(currentURL);\n    try {\n      isIfr = window.self !== window.top;\n    }\n    catch (e) {\n      isIfr = false;\n    }\n    if (bids.length === 0) {\n      return;\n    }\n\n    let delDomain = bids[0].params.delDomain;\n\n    startTime = new Date(params.start);\n\n    buildRequest(bids, {\n      ju: currentURL,\n      jr: currentURL,\n      ch: document.charSet || document.characterSet,\n      res: `${screen.width}x${screen.height}x${screen.colorDepth}`,\n      ifr: isIfr,\n      tz: startTime.getTimezoneOffset(),\n      tws: getViewportDimensions(isIfr),\n      ee: 'api_sync_write',\n      ef: 'bt%2Cdb',\n      be: 1,\n      bc: BIDDER_CONFIG\n    },\n      delDomain);\n  }\n\n  return {\n    callBids: callBids\n  };\n};\n\nmodule.exports = OpenxAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/openx.js","var CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidmanager = require('../bidmanager.js');\nvar bidfactory = require('../bidfactory.js');\nvar adloader = require('../adloader.js');\nvar Adapter = require('./adapter.js');\n\nvar PiximediaAdapter = function PiximediaAdapter() {\n  var PREBID_URL = '//static.adserver.pm/prebid';\n  var baseAdapter = Adapter.createNew('piximedia');\n  var bidStash = {};\n\n  var tryAppendPixiQueryString = function(url, name, value) {\n    return url + \"/\" + encodeURIComponent(name) + \"=\" + value;\n  };\n\n  baseAdapter.callBids = function callBidsPiximedia(params) {\n    utils._each(params.bids, function(bid) {\n\n      // valid bids must include a siteId and an placementId\n      if (bid.placementCode && bid.sizes && bid.params && bid.params.siteId && bid.params.placementId) {\n\n        var sizes = bid.params.hasOwnProperty('sizes')? bid.params.sizes: bid.sizes;\n        sizes = utils.parseSizesInput(sizes);\n\n        var cbid = utils.getUniqueIdentifierStr();\n\n        // we allow overriding the URL in the params\n        var url = bid.params.prebidUrl || PREBID_URL;\n\n        // params are passed to the Piximedia endpoint, including custom params\n        for(var key in bid.params) {\n          /* istanbul ignore else */\n          if(bid.params.hasOwnProperty(key)) {\n            var value = bid.params[key];\n            switch(key) {\n              case \"siteId\":\n                url = tryAppendPixiQueryString(url, 'site_id', encodeURIComponent(value));\n                break;\n\n              case \"placementId\":\n                url = tryAppendPixiQueryString(url, 'placement_id', encodeURIComponent(value));\n                break;\n\n              case \"dealId\":\n                url = tryAppendPixiQueryString(url, 'l_id', encodeURIComponent(value));\n                break;\n\n              case \"sizes\":\n              case \"prebidUrl\":\n                break;\n\n              default:\n                if(typeof value === \"function\") {\n                  url = tryAppendPixiQueryString(url, key, encodeURIComponent((value(baseAdapter, params, bid) || \"\").toString()));\n                } else {\n                  url = tryAppendPixiQueryString(url, key, encodeURIComponent((value || \"\").toString()));\n                }\n                break;\n            }\n          }\n        }\n\n        url = tryAppendPixiQueryString(url, 'jsonp', 'pbjs.handlePiximediaCallback');\n        url = tryAppendPixiQueryString(url, 'sizes', encodeURIComponent(sizes.join(\",\")));\n        url = tryAppendPixiQueryString(url, 'cbid', encodeURIComponent(cbid));\n        url = tryAppendPixiQueryString(url, 'rand', String(Math.floor(Math.random() * 1000000000)));\n\n        bidStash[cbid] = {\n          'bidObj': bid,\n          'url': url,\n          'start': new Date().getTime()\n        };\n        utils.logMessage('[Piximedia] Dispatching header Piximedia to URL ' + url);\n        adloader.loadScript(url);\n      }\n    });\n  };\n\n  /*\n   * Piximedia's bidResponse should look like:\n   *\n   * {\n   *   'foundbypm': true,            // a Boolean, indicating if an ad was found\n   *   'currency': 'EUR',        // the currency, as a String\n   *   'cpm': 1.99,              // the win price as a Number, in currency\n   *   'dealId': null,           // or string value of winning deal ID\n   *   'width': 300,             // width in pixels of winning ad\n   *   'height': 250,            // height in pixels of winning ad\n   *   'html': 'tag_here'        // HTML tag to load if we are picked\n   * }\n   *\n   */\n  pbjs.handlePiximediaCallback = function(bidResponse) {\n    if (bidResponse && bidResponse.hasOwnProperty(\"foundbypm\")) {\n      var stash = bidStash[bidResponse.cbid]; // retrieve our stashed data, by using the cbid\n      var bid;\n\n      if (stash) {\n        var bidObj = stash.bidObj;\n        var timelapsed = new Date().getTime();\n        timelapsed = timelapsed - stash.start;\n\n        if (bidResponse.foundbypm && bidResponse.width && bidResponse.height && bidResponse.html && bidResponse.cpm && bidResponse.currency) {\n          \n          /* we have a valid ad to display */\n          bid = bidfactory.createBid(CONSTANTS.STATUS.GOOD);\n          bid.bidderCode = bidObj.bidder;\n          bid.width = bidResponse.width;\n          bid.height = bidResponse.height;\n          bid.ad = bidResponse.html;\n          bid.cpm = bidResponse.cpm;\n          bid.currency = bidResponse.currency;\n\n          if (bidResponse.dealId) {\n            bid.dealId = bidResponse.dealId;\n          } else {\n            bid.dealId = null;\n          }\n\n          bidmanager.addBidResponse(bidObj.placementCode, bid);\n\n          utils.logMessage('[Piximedia] Registered bidresponse from URL ' + stash.url +\n                           ' (time: ' + String(timelapsed) + ')');\n          utils.logMessage('[Piximedia] ======> BID placementCode: ' + bidObj.placementCode +\n                           ' CPM: ' + String(bid.cpm) + ' ' + bid.currency +\n                           ' Format: ' + String(bid.width) + 'x' + String(bid.height));\n        } else {\n\n          /* we have no ads to display */\n          bid = bidfactory.createBid(CONSTANTS.STATUS.NO_BID);\n          bid.bidderCode = bidObj.bidder;\n          bidmanager.addBidResponse(bidObj.placementCode, bid);\n\n          utils.logMessage('[Piximedia] Registered BLANK bidresponse from URL ' + stash.url +\n                           ' (time: ' + String(timelapsed) + ')');\n          utils.logMessage('[Piximedia] ======> NOBID placementCode: ' + bidObj.placementCode);\n        }\n\n        // We should no longer need this stashed object, so drop reference:\n        bidStash[bidResponse.cbid] = null;\n\n      } else {\n        utils.logMessage(\"[Piximedia] Couldn't find stash for cbid=\" + bidResponse.cbid);\n      }\n    }\n  };\n\n  // return an object with PiximediaAdapter methods\n  return {\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode,\n    getBidderCode: baseAdapter.getBidderCode\n  };\n};\n\nmodule.exports = PiximediaAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/piximedia.js","var utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\n\n/**\n * Adapter for requesting bids from Pubmatic.\n *\n * @returns {{callBids: _callBids}}\n * @constructor\n */\nvar PubmaticAdapter = function PubmaticAdapter() {\n\n  var bids;\n  var _pm_pub_id;\n  var _pm_optimize_adslots = [];\n  let iframe;\n\n  function _callBids(params) {\n    bids = params.bids;\n    _pm_optimize_adslots = [];\n    for (var i = 0; i < bids.length; i++) {\n      var bid = bids[i];\n      //bidmanager.pbCallbackMap['' + bid.params.adSlot] = bid;\n      _pm_pub_id = _pm_pub_id || bid.params.publisherId;\n      _pm_optimize_adslots.push(bid.params.adSlot);\n    }\n\n    // Load pubmatic script in an iframe, because they call document.write\n    _getBids();\n  }\n\n  function _getBids() {\n\n\n    //create the iframe\n    iframe = utils.createInvisibleIframe();\n\n    var elToAppend = document.getElementsByTagName('head')[0];\n\n    //insert the iframe into document\n    elToAppend.insertBefore(iframe, elToAppend.firstChild);\n\n    var iframeDoc = utils.getIframeDocument(iframe);\n    iframeDoc.write(_createRequestContent());\n    iframeDoc.close();\n  }\n\n  function _createRequestContent() {\n    var content = '<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"' +\n      ' \"http://www.w3.org/TR/html4/loose.dtd\"><html><head><base target=\"_top\" /><scr' +\n      'ipt>inDapIF=true;</scr' + 'ipt></head>';\n    content += '<body>';\n    content += '<scr' + 'ipt>';\n    content += '' +\n      'window.pm_pub_id  = \"%%PM_PUB_ID%%\";' +\n      'window.pm_optimize_adslots     = [%%PM_OPTIMIZE_ADSLOTS%%];' +\n      'window.pm_async_callback_fn = \"window.parent.pbjs.handlePubmaticCallback\";';\n    content += '</scr' + 'ipt>';\n\n    var map = {};\n    map.PM_PUB_ID = _pm_pub_id;\n    map.PM_OPTIMIZE_ADSLOTS = _pm_optimize_adslots.map(function (adSlot) {\n      return \"'\" + adSlot + \"'\";\n    }).join(',');\n\n    content += '<scr' + 'ipt src=\"https://ads.pubmatic.com/AdServer/js/gshowad.js\"></scr' + 'ipt>';\n    content += '<scr' + 'ipt>';\n    content += '</scr' + 'ipt>';\n    content += '</body></html>';\n    content = utils.replaceTokenInString(content, map, '%%');\n\n    return content;\n  }\n\n  pbjs.handlePubmaticCallback = function () {\n    let bidDetailsMap = {};\n    let progKeyValueMap = {};\n    try {\n      bidDetailsMap = iframe.contentWindow.bidDetailsMap;\n      progKeyValueMap = iframe.contentWindow.progKeyValueMap;\n    }\n    catch(e) {\n      utils.logError(e, 'Error parsing Pubmatic response');\n    }\n\n    var i;\n    var adUnit;\n    var adUnitInfo;\n    var bid;\n    var bidResponseMap = bidDetailsMap || {};\n    var bidInfoMap = progKeyValueMap || {};\n    var dimensions;\n\n    for (i = 0; i < bids.length; i++) {\n      var adResponse;\n      bid = bids[i].params;\n\n      adUnit = bidResponseMap[bid.adSlot] || {};\n\n      // adUnitInfo example: bidstatus=0;bid=0.0000;bidid=39620189@320x50;wdeal=\n\n      // if using DFP GPT, the params string comes in the format:\n      // \"bidstatus;1;bid;5.0000;bidid;hb_test@468x60;wdeal;\"\n      // the code below detects and handles this.\n      if (bidInfoMap[bid.adSlot] && bidInfoMap[bid.adSlot].indexOf('=') === -1) {\n        bidInfoMap[bid.adSlot] = bidInfoMap[bid.adSlot].replace(/([a-z]+);(.[^;]*)/ig, '$1=$2');\n      }\n\n      adUnitInfo = (bidInfoMap[bid.adSlot] || '').split(';').reduce(function (result, pair) {\n        var parts = pair.split('=');\n        result[parts[0]] = parts[1];\n        return result;\n      }, {});\n\n      if (adUnitInfo.bidstatus === '1') {\n        dimensions = adUnitInfo.bidid.split('@')[1].split('x');\n        adResponse = bidfactory.createBid(1);\n        adResponse.bidderCode = 'pubmatic';\n        adResponse.adSlot = bid.adSlot;\n        adResponse.cpm = Number(adUnitInfo.bid);\n        adResponse.ad = unescape(adUnit.creative_tag);  // jshint ignore:line\n        adResponse.ad += utils.createTrackPixelIframeHtml(decodeURIComponent(adUnit.tracking_url));\n        adResponse.width = dimensions[0];\n        adResponse.height = dimensions[1];\n        adResponse.dealId = adUnitInfo.wdeal;\n\n        bidmanager.addBidResponse(bids[i].placementCode, adResponse);\n      } else {\n        // Indicate an ad was not returned\n        adResponse = bidfactory.createBid(2);\n        adResponse.bidderCode = 'pubmatic';\n        bidmanager.addBidResponse(bids[i].placementCode, adResponse);\n      }\n    }\n  };\n\n  return {\n    callBids: _callBids\n  };\n\n};\n\nmodule.exports = PubmaticAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/pubmatic.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar consts = require('../constants.json');\nvar utils = require('../utils.js');\nvar d = document;\nvar SCRIPT = 'script';\nvar PARAMS = 'params';\nvar SIZES = 'sizes';\nvar SIZE = 'size';\nvar CPM = 'cpm';\nvar AD = 'ad';\nvar WIDTH = 'width';\nvar HEIGHT = 'height';\nvar PUB_ZONE = 'pub_zone';\nvar GROSS_PRICE = 'gross_price';\nvar RESOURCE = 'resource';\nvar DETAIL = 'detail';\nvar BIDDER_CODE_RESPONSE_KEY = 'bidderCode';\nvar BIDDER_CODE = 'pubgears';\nvar SCRIPT_ID = 'pg-header-tag';\nvar ATTRIBUTE_PREFIX = 'data-bsm-';\nvar SLOT_LIST_ATTRIBUTE = 'slot-list';\nvar PUBLISHER_ATTRIBUTE = 'pub';\nvar FLAG_ATTRIBUTE = 'flag';\nvar PLACEMENT_CODE = 'placementCode';\nvar BID_ID = 'bidId';\nvar PUBLISHER_PARAM = 'publisherName';\nvar PUB_ZONE_PARAM = 'pubZone';\nvar BID_RECEIVED_EVENT_NAME = 'onBidResponse';\nvar SLOT_READY_EVENT_NAME = 'onResourceComplete';\nvar CREATIVE_TEMPLATE = decodeURIComponent(\"%3Cscript%3E%0A(function(define)%7B%0Adefine(function(a)%7B%0A%09var%20id%3D%20%22pg-ad-%22%20%2B%20Math.floor(Math.random()%20*%201e10)%2C%20d%3D%20document%0A%09d.write(\\'%3Cdiv%20id%3D%22\\'%2Bid%2B\\'%22%3E%3C%2Fdiv%3E\\')%0A%09a.push(%7B%0A%09%09pub%3A%20\\'%25%25PUBLISHER_NAME%25%25\\'%2C%0A%09%09pub_zone%3A%20\\'%25%25PUB_ZONE%25%25\\'%2C%0A%09%09sizes%3A%20%5B\\'%25%25SIZE%25%25\\'%5D%2C%0A%09%09flag%3A%20true%2C%0A%09%09container%3A%20d.getElementById(id)%2C%0A%09%7D)%3B%0A%7D)%7D)(function(f)%7Bvar%20key%3D\\'uber_imps\\'%2Ca%3Dthis%5Bkey%5D%3Dthis%5Bkey%5D%7C%7C%5B%5D%3Bf(a)%3B%7D)%3B%0A%3C%2Fscript%3E%0A%3Cscript%20src%3D%22%2F%2Fc.pubgears.com%2Ftags%2Fb%22%3E%3C%2Fscript%3E%0A\");\nvar TAG_URL = '//c.pubgears.com/tags/h';\nvar publisher = '';\n\nmodule.exports = PubGearsAdapter;\n\nfunction PubGearsAdapter() {\n  var proxy = null;\n  var pendingSlots = {};\n  var initialized = false;\n\n  this.callBids = callBids;\n\n  function callBids(params) {\n    var bids = params[consts.JSON_MAPPING.PL_BIDS];\n    var slots = bids.map(getSlotFromBidParam) ;\n    if(slots.length <= 0)\n      return;\n    publisher = bids[0][PARAMS][PUBLISHER_PARAM];\n\n    bids.forEach(function(bid) {\n\n      var name = getSlotFromBidParam(bid);\n      pendingSlots[ name ] = bid;\n    });\n\n    proxy = proxy || getScript(SCRIPT_ID) || makeScript(slots, publisher, SCRIPT_ID, TAG_URL);\n    if(!initialized)\n        registerEventListeners(proxy);\n    initialized = true;\n  }\n  function loadScript(script) {\n    var anchor = (function(scripts) {\n      return scripts[ scripts.length - 1 ];\n    })(d.getElementsByTagName(SCRIPT));\n\n    return anchor.parentNode.insertBefore(script, anchor);\n  }\n  function getSlotFromBidParam(bid) {\n    var size = getSize(bid);\n    var params = bid[PARAMS];\n    var slotName = params[PUB_ZONE_PARAM];\n    return [ slotName, size ].join('@');\n  }\n  function getSlotFromResource(resource) {\n    var size = resource[SIZE];\n    var key = [ resource[PUB_ZONE],  size ].join('@');\n    return key;\n  }\n  function getSize(bid) {\n    var sizes = bid[SIZES];\n    var size = Array.isArray(sizes[0]) ? sizes[0] : sizes;\n    return size.join('x');\n  }\n  function makeScript(slots, publisher, id, url) {\n    var script = d.createElement(SCRIPT);\n    script.src = url;\n    script.id = id ;\n    script.setAttribute(ATTRIBUTE_PREFIX + SLOT_LIST_ATTRIBUTE, slots.join(' '));\n    script.setAttribute(ATTRIBUTE_PREFIX + FLAG_ATTRIBUTE, 'true');\n    script.setAttribute(ATTRIBUTE_PREFIX + PUBLISHER_ATTRIBUTE, publisher);\n\n    return loadScript(script);\n  }\n  function getScript(id) {\n    return d.getElementById(id);\n  }\n  function registerEventListeners(script) {\n    script.addEventListener(BID_RECEIVED_EVENT_NAME, onBid, true);\n    script.addEventListener(SLOT_READY_EVENT_NAME, onComplete, true);\n  }\n  function onBid(event) {\n    var data = event[DETAIL];\n    var slotKey = getSlotFromResource(data[RESOURCE]);\n    var bidRequest = pendingSlots[slotKey];\n    var adUnitCode = bidRequest[PLACEMENT_CODE];\n    var bid = null;\n\n    if(bidRequest) {\n      bid = buildResponse(data, bidRequest);\n      bidmanager.addBidResponse(adUnitCode, bid);\n      utils.logMessage('adding bid respoonse to \"' + adUnitCode + '\" for bid request \"' + bidRequest[BID_ID] + '\"');\n    }else {\n      utils.logError('Cannot get placement id for slot \"' + slotKey + '\"');\n    }\n  }\n  function buildResponse(eventData, bidRequest) {\n    var resource = eventData[RESOURCE];\n    var dims = resource[SIZE].split('x');\n    var price = Number(eventData[GROSS_PRICE]);\n    var status = isNaN(price) || price <= 0 ? 2 : 1;\n\n    var response = bidfactory.createBid(status, bidRequest);\n    response[BIDDER_CODE_RESPONSE_KEY] = BIDDER_CODE;\n\n    if(status !== 1)\n      return response;\n\n    response[AD] = getCreative(resource);\n\n    response[CPM] = price / 1e3 ;\n    response[WIDTH] = dims[0];\n    response[HEIGHT] = dims[1];\n    return response;\n  }\n  function getCreative(resource) {\n    var token = '%%';\n    var creative = CREATIVE_TEMPLATE;\n    var replacementValues = {\n      publisher_name: publisher,\n      pub_zone: resource[PUB_ZONE],\n      size: resource[SIZE]\n    };\n    return utils.replaceTokenInString(creative, replacementValues, token);\n  }\n  function onComplete(event) {\n    var data = event[DETAIL];\n    var slotKey = getSlotFromResource(data[RESOURCE]);\n    delete pendingSlots[slotKey];\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/pubgears.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\nvar utils = require('../utils.js');\n\nvar PulsePointAdapter = function PulsePointAdapter() {\n\n  var getJsStaticUrl = window.location.protocol + '//tag-st.contextweb.com/getjs.static.js';\n  var bidUrl = window.location.protocol + '//bid.contextweb.com/header/tag';\n\n  function _callBids(params) {\n    if (typeof window.pp === 'undefined') {\n      adloader.loadScript(getJsStaticUrl, function () { bid(params); }, true);\n    } else {\n      bid(params);\n    }\n  }\n\n  function bid(params) {\n    var bids = params.bids;\n    for (var i = 0; i < bids.length; i++) {\n      var bidRequest = bids[i];\n      requestBid(bidRequest);\n    }\n  }\n\n  function requestBid(bidRequest) {\n    try {\n      var ppBidRequest = new window.pp.Ad(bidRequestOptions(bidRequest));\n      ppBidRequest.display();\n    } catch(e) {\n      //register passback on any exceptions while attempting to fetch response.\n      utils.logError('pulsepoint.requestBid', 'ERROR', e);\n      bidResponseAvailable(bidRequest);\n    }\n  }\n\n  function bidRequestOptions(bidRequest) {\n    var callback = bidResponseCallback(bidRequest);\n    var options = {\n      cn: 1,\n      ca: window.pp.requestActions.BID,\n      cu: bidUrl,\n      adUnitId: bidRequest.placementCode,\n      callback: callback\n    };\n    for(var param in bidRequest.params) {\n      if(bidRequest.params.hasOwnProperty(param)) {\n        options[param] = bidRequest.params[param];\n      }\n    }\n    return options;\n  }\n\n  function bidResponseCallback(bid) {\n    return function (bidResponse) {\n      bidResponseAvailable(bid, bidResponse);\n    };\n  }\n\n  function bidResponseAvailable(bidRequest, bidResponse) {\n    if (bidResponse) {\n      var adSize = bidRequest.params.cf.toUpperCase().split('X');\n      var bid = bidfactory.createBid(1, bidRequest);\n      bid.bidderCode = bidRequest.bidder;\n      bid.cpm = bidResponse.bidCpm;\n      bid.ad = bidResponse.html;\n      bid.width = adSize[0];\n      bid.height = adSize[1];\n      bidmanager.addBidResponse(bidRequest.placementCode, bid);\n    } else {\n      var passback = bidfactory.createBid(2, bidRequest);\n      passback.bidderCode = bidRequest.bidder;\n      bidmanager.addBidResponse(bidRequest.placementCode, passback);\n    }\n  }\n\n  return {\n    callBids: _callBids\n  };\n\n};\n\nmodule.exports = PulsePointAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/pulsepoint.js","import {createBid} from 'src/bidfactory';\nimport {addBidResponse} from 'src/bidmanager';\nimport {logError,getTopWindowLocation} from 'src/utils';\nimport {ajax} from 'src/ajax';\nimport {STATUS} from 'src/constants';\n\nfunction PulsePointLiteAdapter() {\n\n  const bidUrl = window.location.protocol + '//bid.contextweb.com/header/tag?';\n  const ajaxOptions = {\n    method: 'GET',\n    withCredentials: true,\n    contentType: 'text/plain'\n  };\n\n  function _callBids(bidderRequest) {\n    bidderRequest.bids.forEach(bidRequest => {\n      try {\n        var params = Object.assign({}, environment(), bidRequest.params);\n        var url = bidUrl + Object.keys(params).map(k => k + '=' + encodeURIComponent(params[k])).join('&');\n        ajax(url, (bidResponse) => {\n          bidResponseAvailable(bidRequest, bidResponse);\n        }, null, ajaxOptions);\n      } catch(e) {\n        //register passback on any exceptions while attempting to fetch response.\n        logError('pulsepoint.requestBid', 'ERROR', e);\n        bidResponseAvailable(bidRequest);\n      }\n    });\n  }\n\n  function environment() {\n    return {\n      cn: 1,\n      ca: 'BID',\n      tl: 1,\n      'if': 0,\n      cwu: getTopWindowLocation().href,\n      cwr: referrer(),\n      dw: document.documentElement.clientWidth,\n      cxy: document.documentElement.clientWidth + ',' + document.documentElement.clientHeight,\n      tz: new Date().getTimezoneOffset(),\n      ln: (navigator.language || navigator.browserLanguage || navigator.userLanguage || navigator.systemLanguage)\n    };\n  }\n\n  function referrer() {\n    try {\n      return window.top.document.referrer;\n    } catch (e) {\n      return document.referrer;\n    }\n  }\n\n  function bidResponseAvailable(bidRequest, rawResponse) {\n    if (rawResponse) {\n      var bidResponse = parse(rawResponse);\n      if(bidResponse) {\n        var adSize = bidRequest.params.cf.toUpperCase().split('X');\n        var bid = createBid(STATUS.GOOD, bidRequest);\n        bid.bidderCode = bidRequest.bidder;\n        bid.cpm = bidResponse.bidCpm;\n        bid.ad = bidResponse.html;\n        bid.width = adSize[0];\n        bid.height = adSize[1];\n        addBidResponse(bidRequest.placementCode, bid);\n        return;\n      }\n    }\n    var passback = createBid(STATUS.NO_BID, bidRequest);\n    passback.bidderCode = bidRequest.bidder;\n    addBidResponse(bidRequest.placementCode, passback);\n  }\n\n  function parse(rawResponse) {\n    try {\n      return JSON.parse(rawResponse);\n    } catch (ex) {\n      logError('pulsepoint.safeParse', 'ERROR', ex);\n      return null;\n    }\n  }\n\n  return {\n    callBids: _callBids\n  };\n\n}\n\nmodule.exports = PulsePointLiteAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/pulsepointLite.js","const utils = require('../utils.js');\nconst bidfactory = require('../bidfactory.js');\nconst bidmanager = require('../bidmanager.js');\nconst ajax = require('../ajax.js');\nconst CONSTANTS = require('../constants.json');\nconst QUANTCAST_CALLBACK_URL = 'http://global.qc.rtb.quantserve.com:8080/qchb';\n\nvar QuantcastAdapter = function QuantcastAdapter() {\n\n  const BIDDER_CODE = 'quantcast';\n\n  const DEFAULT_BID_FLOOR = 0.0000000001;\n  let bidRequests = {};\n\n  let returnEmptyBid = function(bidId) {\n      var bidRequested = utils.getBidRequest(bidId);\n      if (!utils.isEmpty(bidRequested)) {\n        let bid = bidfactory.createBid(CONSTANTS.STATUS.NO_BID, bidRequested);\n        bid.bidderCode = BIDDER_CODE;\n        bidmanager.addBidResponse(bidRequested.placementCode, bid);\n      }\n      return;\n    };\n\n\n  //expose the callback to the global object:\n  pbjs.handleQuantcastCB = function (responseText) {\n    if(utils.isEmpty(responseText)) {\n      return;\n    }\n    let response = null;\n    try {\n      response = JSON.parse(responseText);\n    } catch(e) {\n      // Malformed JSON\n      utils.logError(\"Malformed JSON received from server - can't do anything here\");\n      return;\n    }\n\n    if(response === null || !response.hasOwnProperty('bids') || utils.isEmpty(response.bids)) {\n      utils.logError(\"Sub-optimal JSON received from server - can't do anything here\");\n      return;\n    }\n\n    for(let i = 0; i < response.bids.length; i++) {\n      let seatbid = response.bids[i];\n      let key = seatbid.placementCode;\n      var request = bidRequests[key];\n      if(request === null || request === undefined) {\n        return returnEmptyBid(seatbid.placementCode);\n      }\n      // This line is required since this is the field\n      // that bidfactory.createBid looks for\n      request.bidId = request.imp[0].placementCode;\n      let responseBid = bidfactory.createBid(CONSTANTS.STATUS.GOOD, request);\n\n      responseBid.cpm = seatbid.cpm;\n      responseBid.ad = seatbid.ad;\n      responseBid.height = seatbid.height;\n      responseBid.width = seatbid.width;\n      responseBid.bidderCode = response.bidderCode;\n      responseBid.requestId = request.requestId;\n      responseBid.bidderCode = BIDDER_CODE;\n\n      bidmanager.addBidResponse(request.bidId, responseBid);\n    }\n\n  };\n\n  function callBids(params) {\n    let bids = params.bids || [];\n    if (bids.length === 0) {\n      return;\n    }\n\n    let referrer = utils.getTopWindowUrl();\n    let loc = utils.getTopWindowLocation();\n    let domain = loc.hostname;\n    let publisherId = 0;\n\n    publisherId = '' + bids[0].params.publisherId;\n    utils._each(bids, function(bid) {\n      let key = bid.placementCode;\n      var bidSizes = [];\n      utils._each(bid.sizes, function (size) {\n        bidSizes.push({\n          'width' : size[0],\n          'height' : size[1]\n        });\n      });\n\n      bidRequests[key] = bidRequests[key] || {\n        'publisherId' : publisherId,\n        'requestId' : bid.bidId,\n        'bidId' : bid.bidId,\n        'site' : {\n          'page' : loc.href,\n          'referrer' : referrer,\n          'domain' : domain,\n        },\n        'imp' : [{\n\n          'banner' : {\n            'battr' : bid.params.battr,\n            'sizes' : bidSizes,\n          },\n          'placementCode' : bid.placementCode,\n          'bidFloor' : bid.params.bidFloor || DEFAULT_BID_FLOOR,\n        }]\n      };\n\n      utils._each(bidRequests, function (bidRequest) {\n        ajax.ajax(QUANTCAST_CALLBACK_URL, pbjs.handleQuantcastCB, JSON.stringify(bidRequest), {\n          method : 'POST',\n          withCredentials: true\n        });\n      });\n    });\n  }\n\n\n  // Export the `callBids` function, so that Prebid.js can execute\n  // this function when the page asks to send out bid requests.\n  return {\n    callBids: callBids,\n    QUANTCAST_CALLBACK_URL: QUANTCAST_CALLBACK_URL\n  };\n};\n\nexports.createNew = function() {\n  return new QuantcastAdapter();\n};\n\n\nmodule.exports = QuantcastAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/quantcast.js","var bidmanager = require('../bidmanager.js'),\n  bidfactory = require('../bidfactory.js'),\n  CONSTANTS = require('../constants.json');\n\nimport {ajax as ajax} from '../ajax';\n\nmodule.exports = function(bidManager, global, loader){\n\n  var version = \"0.9.0.0\",\n    defaultZone = \"1r\",\n    defaultPath = \"mvo\",\n    debug = false,\n    requestCompleted = false,\n    placementCodes = {},\n  loadStart,\n  configuredPlacements = [],\n  fat = /(^v|(\\.0)+$)/gi;\n\n  if(typeof global === \"undefined\")\n    global = window;\n\n  if(typeof bidManager === \"undefined\")\n    bidManager = bidmanager;\n\n  if(typeof loader === \"undefined\")\n    loader = ajax;\n\n  function applyMacros(txt, values){\n    return txt.replace(/\\{([^\\}]+)\\}/g, function(match){\n      var v = values[match.replace(/[\\{\\}]/g, \"\").toLowerCase()];\n      if(typeof v !== \"undefined\") return v;\n      return match;\n    });\n  }\n\n  function load(bidParams, url, callback){\n    loader(url, function(responseText, response){\n      if(response.status === 200)\n        callback(200, \"success\", response.responseText);\n      else\n        callback(-1, \"http error \"+response.status, response.responseText);\n    }, false, {method:\"GET\", withCredentials: true});\n  }\n\n  function flashInstalled(){\n    var n = global.navigator,\n      p = n.plugins,\n      m = n.mimeTypes,\n      t = \"application/x-shockwave-flash\",\n      x = global.ActiveXObject;\n\n    if(p &&\n      p[\"Shockwave Flash\"] &&\n      m &&\n      m[t] &&\n      m[t].enabledPlugin)\n        return true;\n\n    if(x){\n      try{if((new global.ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\"))) return true;}\n      catch(e){}\n    }\n\n    return false;\n  }\n\n  var bidderCode = \"rhythmone\";\n\n  function attempt(valueFunction, defaultValue){\n    try{\n      return valueFunction();\n    }catch(ex){}\n    return defaultValue;\n  }\n\n  function logToConsole(txt){\n    if(debug)\n      console.log(txt);\n  }\n\n  function getBidParameters(bids){\n    for(var i=0;i<bids.length;i++)\n      if(typeof bids[i].params === \"object\" && bids[i].params.placementId)\n        return bids[i].params;\n    return null;\n  }\n\n  function noBids(params){\n    for(var i=0; i<params.bids.length; i++){\n      if(params.bids[i].success !== 1){\n        logToConsole(\"registering nobid for slot \"+params.bids[i].placementCode);\n        var bid = bidfactory.createBid(CONSTANTS.STATUS.NO_BID);\n        bid.bidderCode = bidderCode;\n        bidmanager.addBidResponse(params.bids[i].placementCode, bid);\n      }\n    }\n  }\n\n  function getRMPURL(bidParams, bids){\n    var endpoint = \"//tag.1rx.io/rmp/{placementId}/0/{path}?z={zone}\",\n      query = [];\n\n    if(typeof bidParams.endpoint === \"string\")\n      endpoint = bidParams.endpoint;\n\n    if(typeof bidParams.zone === \"string\")\n      defaultZone = bidParams.zone;\n\n    if(typeof bidParams.path === \"string\")\n      defaultPath = bidParams.path;\n\n    if(bidParams.debug === true)\n      debug = true;\n\n    if(bidParams.trace === true)\n      query.push(\"trace=true\");\n\n    endpoint = applyMacros(endpoint, {\n      placementid:bidParams.placementId,\n      zone: defaultZone,\n      path: defaultPath\n    });\n\n    function p(k,v){\n      if(v instanceof Array)\n        v = v.join(\",\");\n      if(typeof v !== \"undefined\")\n        query.push(encodeURIComponent(k)+\"=\"+encodeURIComponent(v));\n    }\n\n    p(\"domain\", attempt(function(){\n        var d = global.document.location.ancestorOrigins;\n        if(d && d.length > 0)\n          return d[d.length-1];\n        return global.top.document.location.hostname; // try/catch is in the attempt function\n      },\"\"));\n    p(\"title\", attempt(function(){return global.top.document.title;},\"\")); // try/catch is in the attempt function\n    p(\"url\", attempt(function(){\n        var l;\n        try{l = global.top.document.location.href.toString();} // try/catch is in the attempt function\n        catch(ex){l = global.document.location.href.toString();}\n        return l;\n      },\"\"));\n    p(\"dsh\", (global.screen ? global.screen.height : \"\"));\n    p(\"dsw\", (global.screen ? global.screen.width : \"\"));\n    p(\"tz\", (new Date()).getTimezoneOffset());\n    p(\"dtype\", ((/(ios|ipod|ipad|iphone|android)/i).test(global.navigator.userAgent) ? 1 : ((/(smart[-]?tv|hbbtv|appletv|googletv|hdmi|netcast\\.tv|viera|nettv|roku|\\bdtv\\b|sonydtv|inettvbrowser|\\btv\\b)/i).test(global.navigator.userAgent) ? 3 : 2)));\n    p(\"flash\", (flashInstalled() ? 1 : 0));\n\n    var heights = [],\n      widths = [],\n      floors = [],\n      mediaTypes = [],\n      i=0;\n\n    configuredPlacements = [];\n\n    p(\"hbv\", global.pbjs.version.replace(fat,\"\")+\",\"+version.replace(fat,\"\"));\n\n    for(; i<bids.length; i++){\n\n      var th = [], tw = [];\n\n      if(bids[i].sizes.length > 0 && typeof bids[i].sizes[0] === \"number\")\n        bids[i].sizes = [bids[i].sizes];\n\n      for(var j = 0; j<bids[i].sizes.length; j++){\n        tw.push(bids[i].sizes[j][0]);\n        th.push(bids[i].sizes[j][1]);\n      }\n      configuredPlacements.push(bids[i].placementCode);\n      heights.push(th.join(\"|\"));\n      widths.push(tw.join(\"|\"));\n      mediaTypes.push(((/video/i).test(bids[i].mediaType) ? \"v\" : \"d\"));\n      floors.push(0);\n    }\n\n    p(\"imp\", configuredPlacements);\n    p(\"w\", widths);\n    p(\"h\", heights);\n    p(\"floor\", floors);\n    p(\"t\", mediaTypes);\n\n    endpoint += \"&\"+query.join(\"&\");\n\n    return endpoint;\n  }\n\n  function sendAuditBeacon(placementId){\n    var data = {\n        doc_version : 1,\n        doc_type : \"Prebid Audit\",\n        placement_id: placementId\n      },\n      ao = document.location.ancestorOrigins,\n      q = [],\n      u = \"//hbevents.1rx.io/audit?\",\n      i = new Image();\n\n    if(ao && ao.length > 0){\n      data.ancestor_origins = ao[ao.length-1];\n    }\n\n    data.popped = window.opener!==null?1:0;\n    data.framed = window.top===window?0:1;\n\n    try{\n      data.url = window.top.document.location.href.toString();\n    }catch(ex){\n      data.url = window.document.location.href.toString();\n    }\n\n    var prebid_instance = global.pbjs;\n\n    data.prebid_version = prebid_instance.version.replace(fat,\"\");\n    data.response_ms = (new Date()).getTime() - loadStart;\n    data.placement_codes = configuredPlacements.join(\",\");\n    data.bidder_version = version;\n    data.prebid_timeout = prebid_instance.cbTimeout || prebid_instance.bidderTimeout;\n\n    for(var k in data){\n      q.push(encodeURIComponent(k)+\"=\"+encodeURIComponent((typeof data[k] === \"object\" ? JSON.stringify(data[k]) : data[k])));\n    }\n\n    q.sort();\n    i.src = u+q.join(\"&\");\n  }\n\n  this.callBids = function(params){\n\n    var slotMap = {},\n      bidParams = getBidParameters(params.bids);\n\n    debug = (bidParams !== null && bidParams.debug === true);\n\n    if(bidParams === null){\n      noBids(params);\n      return;\n    }\n\n    for(var i = 0; i<params.bids.length; i++)\n      slotMap[params.bids[i].placementCode] = params.bids[i];\n\n    loadStart = (new Date()).getTime();\n    load(bidParams, getRMPURL(bidParams, params.bids), function(code, msg, txt){\n\n      // send quality control beacon here\n      sendAuditBeacon(bidParams.placementId);\n\n      requestCompleted = true;\n\n      logToConsole(\"response text: \"+txt);\n\n      if(code !== -1){\n        try{\n          var result = JSON.parse(txt),\n            registerBid = function(bid){\n\n              slotMap[bid.impid].success = 1;\n\n              var pbResponse = bidfactory.createBid(CONSTANTS.STATUS.GOOD),\n                placementCode = slotMap[bid.impid].placementCode;\n\n              placementCodes[placementCode] = false;\n\n              pbResponse.bidderCode = bidderCode;\n              pbResponse.cpm = parseFloat(bid.price);\n              pbResponse.width = bid.w;\n              pbResponse.height = bid.h;\n\n              if((/video/i).test(slotMap[bid.impid].mediaType)){\n                pbResponse.mediaType = \"video\";\n                pbResponse.vastUrl = bid.nurl;\n                pbResponse.descriptionUrl = bid.nurl;\n              }\n              else\n                pbResponse.ad = bid.adm;\n\n              logToConsole(\"registering bid \"+placementCode+\" \"+JSON.stringify(pbResponse));\n\n              bidManager.addBidResponse(placementCode, pbResponse);\n            };\n\n          for(i=0; result.seatbid && i<result.seatbid.length; i++)\n            for(var j=0; result.seatbid[i].bid && j<result.seatbid[i].bid.length; j++){\n              registerBid(result.seatbid[i].bid[j]);\n            }\n        }\n        catch(ex){}\n      }\n\n      // if no bids are successful, inform prebid\n      noBids(params);\n    });\n\n    logToConsole(\"version: \"+version);\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/rhythmone.js","import * as Adapter from './adapter.js';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport { ajax } from 'src/ajax';\nimport { STATUS } from 'src/constants';\n\nconst RUBICON_BIDDER_CODE = 'rubicon';\n\n// use deferred function call since version isn't defined yet at this point\nfunction getIntegration() {\n  return 'pbjs_lite_' + pbjs.version;\n}\n\nfunction isSecure() {\n  return location.protocol === 'https:';\n}\n\n// use protocol relative urls for http or https\nconst FASTLANE_ENDPOINT = '//fastlane.rubiconproject.com/a/api/fastlane.json';\nconst VIDEO_ENDPOINT = '//fastlane-adv.rubiconproject.com/v1/auction/video';\n\nconst TIMEOUT_BUFFER = 500;\n\nvar sizeMap = {\n  1:'468x60',\n  2:'728x90',\n  8:'120x600',\n  9:'160x600',\n  10:'300x600',\n  15:'300x250',\n  16:'336x280',\n  19:'300x100',\n  31:'980x120',\n  32:'250x360',\n  33:'180x500',\n  35:'980x150',\n  37:'468x400',\n  38:'930x180',\n  43:'320x50',\n  44:'300x50',\n  48:'300x300',\n  54:'300x1050',\n  55:'970x90',\n  57:'970x250',\n  58:'1000x90',\n  59:'320x80',\n  61:'1000x1000',\n  65:'640x480',\n  67:'320x480',\n  68:'1800x1000',\n  72:'320x320',\n  73:'320x160',\n  78:'980x240',\n  79:'980x300',\n  80:'980x400',\n  83:'480x300',\n  94:'970x310',\n  96:'970x210',\n  101:'480x320',\n  102:'768x1024',\n  103:'480x280',\n  113:'1000x300',\n  117:'320x100',\n  125:'800x250',\n  126:'200x600'\n};\nutils._each(sizeMap, (item, key) => sizeMap[item] = key);\n\nfunction RubiconAdapter() {\n\n  function _callBids(bidderRequest) {\n    var bids = bidderRequest.bids || [];\n\n    bids.forEach(bid => {\n      try {\n        // Video endpoint only accepts POST calls\n        if (bid.mediaType === 'video') {\n          ajax(\n            VIDEO_ENDPOINT,\n            {\n              success: bidCallback,\n              error: bidError\n            },\n            buildVideoRequestPayload(bid, bidderRequest),\n            {\n              withCredentials: true\n            }\n          );\n        } else {\n          ajax(\n            buildOptimizedCall(bid),\n            {\n              success: bidCallback,\n              error: bidError\n            },\n            undefined,\n            {\n              withCredentials: true\n            }\n          );\n        }\n      } catch(err) {\n        utils.logError('Error sending rubicon request for placement code ' + bid.placementCode, null, err);\n        addErrorBid();\n      }\n\n      function bidCallback(responseText) {\n        try {\n          utils.logMessage('XHR callback function called for ad ID: ' + bid.bidId);\n          handleRpCB(responseText, bid);\n        } catch (err) {\n          if (typeof err === 'string') {\n            utils.logWarn(`${err} when processing rubicon response for placement code ${bid.placementCode}`);\n          } else {\n            utils.logError('Error processing rubicon response for placement code ' + bid.placementCode, null, err);\n          }\n          addErrorBid();\n        }\n      }\n\n      function bidError(err, xhr) {\n        utils.logError('Request for rubicon responded with:', xhr.status, err);\n        addErrorBid();\n      }\n\n      function addErrorBid() {\n        let badBid = bidfactory.createBid(STATUS.NO_BID, bid);\n        badBid.bidderCode = bid.bidder;\n        bidmanager.addBidResponse(bid.placementCode, badBid);\n      }\n    });\n  }\n\n  function _getScreenResolution() {\n    return [window.screen.width, window.screen.height].join('x');\n  }\n\n  function buildVideoRequestPayload(bid, bidderRequest) {\n    bid.startTime = new Date().getTime();\n\n    let params = bid.params;\n\n    if(!params || typeof params.video !== 'object') {\n      throw 'Invalid Video Bid';\n    }\n\n    let size;\n    if(params.video.playerWidth && params.video.playerHeight) {\n      size = [\n        params.video.playerWidth,\n        params.video.playerHeight\n      ];\n    } else if(\n        Array.isArray(bid.sizes) && bid.sizes.length > 0 &&\n        Array.isArray(bid.sizes[0]) && bid.sizes[0].length > 1\n    ) {\n      size = bid.sizes[0];\n    } else {\n      throw 'Invalid Video Bid - No size provided';\n    }\n\n    let postData =  {\n      page_url: !params.referrer ? utils.getTopWindowUrl() : params.referrer,\n      resolution:  _getScreenResolution(),\n      account_id: params.accountId,\n      integration: getIntegration(),\n      timeout: bidderRequest.timeout - (Date.now() - bidderRequest.auctionStart + TIMEOUT_BUFFER),\n      stash_creatives: true,\n      ae_pass_through_parameters: params.video.aeParams,\n      slots: []\n    };\n\n    // Define the slot object\n    let slotData = {\n      site_id: params.siteId,\n      zone_id: params.zoneId,\n      position: params.position || 'btf',\n      floor: parseFloat(params.floor) > 0.01 ? params.floor : 0.01,\n      element_id: bid.placementCode,\n      name: bid.placementCode,\n      language: params.video.language,\n      width: size[0],\n      height: size[1]\n    };\n\n    // check and add inventory, keywords, visitor and size_id data\n    if(params.video.size_id) {\n      slotData.size_id = params.video.size_id;\n    } else {\n      throw 'Invalid Video Bid - Invalid Ad Type!';\n    }\n\n    if(params.inventory && typeof params.inventory === 'object') {\n      slotData.inventory = params.inventory;\n    }\n\n    if(params.keywords && Array.isArray(params.keywords)) {\n      slotData.keywords = params.keywords;\n    }\n\n    if(params.visitor && typeof params.visitor === 'object') {\n      slotData.visitor = params.visitor;\n    }\n\n    postData.slots.push(slotData);\n\n    return(JSON.stringify(postData));\n  }\n\n  function buildOptimizedCall(bid) {\n    bid.startTime = new Date().getTime();\n\n    var {\n      accountId,\n      siteId,\n      zoneId,\n      position,\n      floor,\n      keywords,\n      visitor,\n      inventory,\n      userId,\n      referrer: pageUrl\n    } = bid.params;\n\n    // defaults\n    floor = (floor = parseFloat(floor)) > 0.01 ? floor : 0.01;\n    position = position || 'btf';\n\n    // use rubicon sizes if provided, otherwise adUnit.sizes\n    var parsedSizes = RubiconAdapter.masSizeOrdering(Array.isArray(bid.params.sizes) ?\n      bid.params.sizes.map(size => (sizeMap[size] || '').split('x')) : bid.sizes\n    );\n\n    if(parsedSizes.length < 1) {\n      throw 'no valid sizes';\n    }\n\n    if(!/^\\d+$/.test(accountId)) {\n      throw 'invalid accountId provided';\n    }\n\n    // using array to honor ordering. if order isn't important (it shouldn't be), an object would probably be preferable\n    var queryString = [\n      'account_id', accountId,\n      'site_id', siteId,\n      'zone_id', zoneId,\n      'size_id', parsedSizes[0],\n      'alt_size_ids', parsedSizes.slice(1).join(',') || undefined,\n      'p_pos', position,\n      'rp_floor', floor,\n      'rp_secure', isSecure() ? '1' : '0',\n      'tk_flint', getIntegration(),\n      'p_screen_res', _getScreenResolution(),\n      'kw', keywords,\n      'tk_user_key', userId\n    ];\n\n    if(visitor !== null && typeof visitor === 'object') {\n      utils._each(visitor, (item, key) => queryString.push(`tg_v.${key}`, item));\n    }\n\n    if(inventory !== null && typeof inventory === 'object') {\n      utils._each(inventory, (item, key) => queryString.push(`tg_i.${key}`, item));\n    }\n\n    queryString.push(\n      'rand', Math.random(),\n      'rf', !pageUrl ? utils.getTopWindowUrl() : pageUrl\n    );\n\n    return queryString.reduce(\n      (memo, curr, index) =>\n        index % 2 === 0 && queryString[index + 1] !== undefined ?\n        memo + curr + '=' + encodeURIComponent(queryString[index + 1]) + '&' : memo,\n      FASTLANE_ENDPOINT + '?'\n    ).slice(0, -1); // remove trailing &\n  }\n\n  let _renderCreative = (script, impId) => `<html>\n<head><script type='text/javascript'>inDapIF=true;</script></head>\n<body style='margin : 0; padding: 0;'>\n<!-- Rubicon Project Ad Tag -->\n<div data-rp-impression-id='${impId}'>\n<script type='text/javascript'>${script}</script>\n</div>\n</body>\n</html>`;\n\n  function handleRpCB(responseText, bidRequest) {\n    var responseObj = JSON.parse(responseText), // can throw\n        ads = responseObj.ads,\n        adResponseKey = bidRequest.placementCode;\n\n    // check overall response\n    if(typeof responseObj !== 'object' || responseObj.status !== 'ok') {\n      throw 'bad response';\n    }\n\n    // video ads array is wrapped in an object\n    if (bidRequest.mediaType === 'video' && typeof ads === 'object') {\n      ads = ads[adResponseKey];\n    }\n\n    // check the ad response\n    if(!Array.isArray(ads) || ads.length < 1) {\n      throw 'invalid ad response';\n    }\n\n    // if there are multiple ads, sort by CPM\n    ads = ads.sort(_adCpmSort);\n\n    ads.forEach(ad => {\n      if(ad.status !== 'ok') {\n        throw 'bad ad status';\n      }\n\n      //store bid response\n      //bid status is good (indicating 1)\n      var bid = bidfactory.createBid(STATUS.GOOD, bidRequest);\n      bid.creative_id = ad.ad_id;\n      bid.bidderCode = bidRequest.bidder;\n      bid.cpm = ad.cpm || 0;\n      bid.dealId = ad.deal;\n      if (bidRequest.mediaType === 'video') {\n        bid.width = bidRequest.params.video.playerWidth;\n        bid.height = bidRequest.params.video.playerHeight;\n        bid.vastUrl = ad.creative_depot_url;\n        bid.descriptionUrl = ad.impression_id;\n        bid.impression_id = ad.impression_id;\n      } else {\n        bid.ad = _renderCreative(ad.script, ad.impression_id);\n        [bid.width, bid.height] = sizeMap[ad.size_id].split('x').map(num => Number(num));\n      }\n\n      // add server-side targeting\n      bid.rubiconTargeting = (Array.isArray(ad.targeting) ? ad.targeting : [])\n        .reduce((memo, item) => {\n          memo[item.key] = item.values[0];\n          return memo;\n        }, {'rpfl_elemid': bidRequest.placementCode});\n\n      try {\n        bidmanager.addBidResponse(bidRequest.placementCode, bid);\n      } catch (err) {\n        utils.logError('Error from addBidResponse', null, err);\n      }\n    });\n  }\n\n  function _adCpmSort(adA, adB) {\n    return (adB.cpm || 0.0) - (adA.cpm || 0.0);\n  }\n\n  return Object.assign(Adapter.createNew(RUBICON_BIDDER_CODE), {\n    callBids: _callBids,\n    createNew: RubiconAdapter.createNew\n  });\n}\n\nRubiconAdapter.masSizeOrdering = function(sizes) {\n  const MAS_SIZE_PRIORITY = [15, 2, 9];\n\n  return utils.parseSizesInput(sizes)\n    // map sizes while excluding non-matches\n    .reduce((result, size) => {\n      let mappedSize = parseInt(sizeMap[size], 10);\n      if(mappedSize) {\n        result.push(mappedSize);\n      }\n      return result;\n    }, [])\n    .sort((first, second) => {\n      // sort by MAS_SIZE_PRIORITY priority order\n      let firstPriority = MAS_SIZE_PRIORITY.indexOf(first),\n          secondPriority = MAS_SIZE_PRIORITY.indexOf(second);\n\n      if(firstPriority > -1 || secondPriority > -1) {\n        if(firstPriority === -1) {\n          return 1;\n        }\n        if(secondPriority === -1) {\n          return -1;\n        }\n        return firstPriority - secondPriority;\n      }\n\n      // and finally ascending order\n      return first - second;\n    });\n};\n\nRubiconAdapter.createNew = function() {\n  return new RubiconAdapter();\n};\n\nmodule.exports = RubiconAdapter;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/rubicon.js","import * as Adapter from './adapter.js';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport {ajax} from 'src/ajax';\nimport {STATUS} from 'src/constants';\n\nconst SMARTYADS_BIDDER_CODE = 'smartyads';\n\nvar sizeMap = {\n  1: '468x60',\n  2: '728x90',\n  8: '120x600',\n  9: '160x600',\n  10: '300x600',\n  15: '300x250',\n  16: '336x280',\n  19: '300x100',\n  43: '320x50',\n  44: '300x50',\n  48: '300x300',\n  54: '300x1050',\n  55: '970x90',\n  57: '970x250',\n  58: '1000x90',\n  59: '320x80',\n  61: '1000x1000',\n  65: '640x480',\n  67: '320x480',\n  68: '1800x1000',\n  72: '320x320',\n  73: '320x160',\n  83: '480x300',\n  94: '970x310',\n  96: '970x210',\n  101: '480x320',\n  102: '768x1024',\n  113: '1000x300',\n  117: '320x100',\n  125: '800x250',\n  126: '200x600'\n};\n\nutils._each(sizeMap, (item, key) => sizeMap[item] = key);\n\nfunction SmartyadsAdapter() {\n\n  function _callBids(bidderRequest) {\n\n    var bids = bidderRequest.bids || [];\n\n    bids.forEach((bid) => {\n      try {\n        ajax(buildOptimizedCall(bid), bidCallback, undefined, { withCredentials: true });\n      } catch (err) {\n        utils.logError('Error sending smartyads request for placement code ' + bid.placementCode, null, err);\n      }\n\n      function bidCallback(responseText) {\n\n        try {\n          utils.logMessage('XHR callback function called for ad ID: ' + bid.bidId);\n          handleRpCB(responseText, bid);\n        } catch (err) {\n          if (typeof err === \"string\") {\n            utils.logWarn(`${err} when processing smartyads response for placement code ${bid.placementCode}`);\n          } else {\n            utils.logError('Error processing smartyads response for placement code ' + bid.placementCode, null, err);\n          }\n\n          //indicate that there is no bid for this placement\n          let badBid = bidfactory.createBid(STATUS.NO_BID, bid);\n          badBid.bidderCode = bid.bidder;\n          badBid.error = err;\n          bidmanager.addBidResponse(bid.placementCode, badBid);\n        }\n      }\n    });\n  }\n\n  function buildOptimizedCall(bid) {\n\n    bid.startTime = new Date().getTime();\n\n    // use smartyads sizes if provided, otherwise adUnit.sizes\n    var parsedSizes = SmartyadsAdapter.masSizeOrdering(\n      Array.isArray(bid.params.sizes) ? bid.params.sizes.map(size => (sizeMap[size] || '').split('x')) : bid.sizes\n    );\n\n    if (parsedSizes.length < 1) {\n      throw \"no valid sizes\";\n    }\n\n    var secure;\n    if (window.location.protocol !== 'http:') {\n      secure = 1;\n    } else {\n      secure = 0;\n    }\n\n    var host = window.location.host,\n      page = window.location.pathname,\n      language = navigator.language,\n      deviceWidth = window.screen.width,\n      deviceHeight = window.screen.height;\n\n    var queryString = [\n      'banner_id', bid.params.banner_id,\n      'size_ad', parsedSizes[0],\n      'alt_size_ad', parsedSizes.slice(1).join(',') || undefined,\n      'host', host,\n      \"page\", page,\n      \"language\", language,\n      \"deviceWidth\", deviceWidth,\n      \"deviceHeight\", deviceHeight,\n      \"secure\", secure,\n      \"bidId\", bid.bidId,\n      \"checkOn\", 'rf'\n    ];\n\n    return queryString.reduce(\n      (memo, curr, index) =>\n        index % 2 === 0 && queryString[index + 1] !== undefined ?\n        memo + curr + '=' + encodeURIComponent(queryString[index + 1]) + '&'\n          : memo,\n      '//ssp-nj.webtradehub.com/?'\n    ).slice(0, -1);\n\n  }\n\n  function handleRpCB(responseText, bidRequest) {\n\n    let ad = JSON.parse(responseText); // can throw\n\n    var bid = bidfactory.createBid(STATUS.GOOD, bidRequest);\n    bid.creative_id = ad.ad_id;\n    bid.bidderCode = bidRequest.bidder;\n    bid.cpm = ad.cpm || 0;\n    bid.ad = ad.adm;\n    bid.width = ad.width;\n    bid.height = ad.height;\n    bid.dealId = ad.deal;\n\n    bidmanager.addBidResponse(bidRequest.placementCode, bid);\n  }\n\n  return Object.assign(Adapter.createNew(SMARTYADS_BIDDER_CODE), {      // SMARTYADS_BIDDER_CODE smartyads\n    callBids: _callBids,\n    createNew: SmartyadsAdapter.createNew\n  });\n}\n\nSmartyadsAdapter.masSizeOrdering = function (sizes) {\n\n  const MAS_SIZE_PRIORITY = [15, 2, 9];\n\n  return utils.parseSizesInput(sizes)\n  // map sizes while excluding non-matches\n    .reduce((result, size) => {\n      let mappedSize = parseInt(sizeMap[size], 10);\n      if (mappedSize) {\n        result.push(mappedSize);\n      }\n      return result;\n    }, [])\n    .sort((first, second) => {\n      // sort by MAS_SIZE_PRIORITY priority order\n      let firstPriority = MAS_SIZE_PRIORITY.indexOf(first),\n        secondPriority = MAS_SIZE_PRIORITY.indexOf(second);\n\n      if (firstPriority > -1 || secondPriority > -1) {\n        if (firstPriority === -1) {\n          return 1;\n        }\n        if (secondPriority === -1) {\n          return -1;\n        }\n        return firstPriority - secondPriority;\n      }\n\n      return first - second;\n    });\n};\n\nSmartyadsAdapter.createNew = function () {\n  return new SmartyadsAdapter();\n};\n\nmodule.exports = SmartyadsAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/smartyads.js","import * as Adapter from './adapter.js';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport {ajax} from 'src/ajax';\nimport {STATUS} from 'src/constants';\n\nvar BIDDER_CODE = 'huddledmasses';\n\nvar sizeObj = {\n  1: '468x60',\n  2: '728x90',\n  10: '300x600',\n  15: '300x250',\n  19: '300x100',\n  43: '320x50',\n  44: '300x50',\n  48: '300x300',\n  54: '300x1050',\n  55: '970x90',\n  57: '970x250',\n  58: '1000x90',\n  59: '320x80',\n  65: '640x480',\n  67: '320x480',\n  72: '320x320',\n  73: '320x160',\n  83: '480x300',\n  94: '970x310',\n  96: '970x210',\n  101: '480x320',\n  102: '768x1024',\n  113: '1000x300',\n  117: '320x100',\n  118: '800x250',\n  119: '200x600'\n};\n\nutils._each(sizeObj, (item, key) => sizeObj[item] = key);\n\nfunction HuddledMassesAdapter() {\n  function _callBids(bidderRequest) {\n    var bids = bidderRequest.bids || [];\n\n    bids.forEach((bid) => {\n      function bidCallback(responseText) {\n        try {\n          utils.logMessage('XHR callback function called for ad ID: ' + bid.bidId);\n          handleRpCB(responseText, bid);\n        } catch (err) {\n          if (typeof err === \"string\") {\n            utils.logWarn(`${err} when processing huddledmasses response for placement code ${bid.placementCode}`);\n          } else {\n            utils.logError('Error processing huddledmasses response for placement code ' + bid.placementCode, null, err);\n          }\n          var badBid = bidfactory.createBid(STATUS.NO_BID, bid);\n          badBid.bidderCode = bid.bidder;\n          badBid.error = err;\n          bidmanager.addBidResponse(bid.placementCode, badBid);\n        }\n      }\n\n      try {\n        ajax(buildOptimizedCall(bid), bidCallback, undefined, { withCredentials: true });\n      } catch (err) {\n        utils.logError('Error sending huddledmasses request for placement code ' + bid.placementCode, null, err);\n      }\n    });\n  }\n\n  function buildOptimizedCall(bid) {\n    bid.startTime = (new Date()).getTime();\n\n    var parsedSizes = HuddledMassesAdapter.masSizeOrdering(\n      Array.isArray(bid.params.sizes) ? bid.params.sizes.map(size => (sizeObj[size] || '').split('x')) : bid.sizes\n    );\n\n    if (parsedSizes.length < 1) {\n      throw \"no valid sizes\";\n    }\n\n    var secure = 0;\n    if (window.location.protocol !== 'http:') {\n      secure = 1;\n    }\n\n    var host = window.location.host;\n    var page = window.location.pathname;\n    var language = navigator.language;\n    var deviceWidth = window.screen.width;\n    var deviceHeight = window.screen.height;\n\n    var queryString = [\n            'banner_id', bid.params.placement_id,\n            'size_ad', parsedSizes[0],\n            'alt_size_ad', parsedSizes.slice(1).join(',') || [],\n            'host', host,\n            \"page\", page,\n            \"language\", language,\n            \"deviceWidth\", deviceWidth,\n            \"deviceHeight\", deviceHeight,\n            \"secure\", secure,\n            \"bidId\", bid.bidId,\n            \"checkOn\", 'rf'\n    ];\n\n    return queryString.reduce(\n            (memo, curr, index) =>\n                index % 2 === 0 && queryString[index + 1] !== undefined ?\n                memo + curr + '=' + encodeURIComponent(queryString[index + 1]) + '&'\n                    : memo,\n            '//huddledmassessupply.com/?'\n    ).slice(0, -1);\n  }\n\n  function handleRpCB(responseText, bidRequest) {\n    var ad = JSON.parse(responseText);\n\n    var bid = bidfactory.createBid(STATUS.GOOD, bidRequest);\n    bid.creative_id = ad.ad_id;\n    bid.bidderCode = bidRequest.bidder;\n    bid.cpm = ad.cpm || 0;\n    bid.ad = ad.adm;\n    bid.width = ad.width;\n    bid.height = ad.height;\n    bid.dealId = ad.deal;\n\n    bidmanager.addBidResponse(bidRequest.placementCode, bid);\n  }\n\n  return Object.assign(Adapter.createNew(BIDDER_CODE), {      // BIDDER_CODE huddledmasses\n    callBids: _callBids,\n    createNew: HuddledMassesAdapter.createNew\n  });\n}\n\nHuddledMassesAdapter.masSizeOrdering = function (sizes) {\n  var MAS_SIZE_PRIORITY = [15, 2, 9];\n  return utils.parseSizesInput(sizes)\n        .reduce((result, size) => {\n          var mappedSize = parseInt(sizeObj[size], 10);\n          if (mappedSize) {\n            result.push(mappedSize);\n          }\n          return result;\n        }, [])\n        .sort((first, second) => {\n          var firstPriority = MAS_SIZE_PRIORITY.indexOf(first);\n          var secondPriority = MAS_SIZE_PRIORITY.indexOf(second);\n\n          if (firstPriority > -1 || secondPriority > -1) {\n            if (firstPriority === -1) {\n              return 1;\n            }\n            if (secondPriority === -1) {\n              return -1;\n            }\n            return firstPriority - secondPriority;\n          }\n\n          return first - second;\n        });\n};\n\nHuddledMassesAdapter.createNew = function () {\n  return new HuddledMassesAdapter();\n};\n\nmodule.exports = HuddledMassesAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/huddledmasses.js","var utils = require(\"../utils.js\");\nvar bidfactory = require(\"../bidfactory.js\");\nvar bidmanager = require(\"../bidmanager.js\");\nvar adloader = require(\"src/adloader.js\");\nvar url = require(\"url\");\n\nvar SmartAdServer = function SmartAdServer() {\n  var generateCallback = function(bid) {\n    var callbackId = \"sas_\" + utils.getUniqueIdentifierStr();\n    pbjs[callbackId] = function(adUnit) {\n      var bidObject;\n      if (adUnit) {\n        utils.logMessage(`[SmartAdServer] bid response for placementCode ${bid.placementCode}`);\n        bidObject = bidfactory.createBid(1);\n        bidObject.bidderCode = 'smartadserver';\n        bidObject.cpm = adUnit.cpm;\n        bidObject.currency = adUnit.currency;\n        bidObject.ad = adUnit.ad;\n        bidObject.width = adUnit.width;\n        bidObject.height = adUnit.height;\n        bidObject.dealId = adUnit.dealId;\n        bidmanager.addBidResponse(bid.placementCode, bidObject);\n      } else {\n        utils.logMessage(`[SmartAdServer] no bid response for placementCode ${bid.placementCode}`);\n        bidObject = bidfactory.createBid(2);\n        bidObject.bidderCode = 'smartadserver';\n        bidmanager.addBidResponse(bid.placementCode, bidObject);\n      }\n    };\n    return callbackId;\n  };\n\n  return {\n    callBids: function(params) {\n      for (var i = 0; i < params.bids.length; i++) {\n        var bid = params.bids[i];\n        var adCall = url.parse(bid.params.domain);\n        adCall.pathname = \"/prebid\";\n        adCall.search = {\n          \"pbjscbk\": \"pbjs.\" + generateCallback(bid),\n          \"siteid\": bid.params.siteId,\n          \"pgid\": bid.params.pageId,\n          \"fmtid\": bid.params.formatId,\n          \"ccy\": bid.params.currency || \"USD\",\n          \"tgt\": encodeURIComponent(bid.params.target || ''),\n          \"tag\": bid.placementCode,\n          \"sizes\": bid.sizes.map(size => size[0] + \"x\" + size[1]).join(\",\"),\n          \"async\": 1\n        };\n        adloader.loadScript(url.format(adCall));\n      }\n    }\n  };\n};\n\nmodule.exports = SmartAdServer;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/smartadserver.js","import { getBidRequest } from '../utils.js';\nvar CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\n\nvar sekindoUMAdapter;\nsekindoUMAdapter = function sekindoUMAdapter() {\n\n  function _callBids(params) {\n    var bids = params.bids;\n    var bidsCount = bids.length;\n\n    var pubUrl = null;\n    if (parent !== window)\n      pubUrl = document.referrer;\n    else\n      pubUrl = window.location.href;\n\n    for (var i = 0; i < bidsCount; i++) {\n      var bidReqeust = bids[i];\n      var callbackId = bidReqeust.bidId;\n      _requestBids(bidReqeust, callbackId, pubUrl);\n      //store a reference to the bidRequest from the callback id\n      //bidmanager.pbCallbackMap[callbackId] = bidReqeust;\n    }\n  }\n\n  pbjs.sekindoCB = function(callbackId, response) {\n    var bidObj = getBidRequest(callbackId);\n    if (typeof (response) !== 'undefined' && typeof (response.cpm) !== 'undefined') {\n      var bid = [];\n      if (bidObj) {\n        var bidCode = bidObj.bidder;\n        var placementCode = bidObj.placementCode;\n\n        if (response.cpm !== undefined && response.cpm > 0) {\n\n          bid = bidfactory.createBid(CONSTANTS.STATUS.GOOD);\n          bid.callback_uid = callbackId;\n          bid.bidderCode = bidCode;\n          bid.creative_id = response.adId;\n          bid.cpm = parseFloat(response.cpm);\n          bid.ad = response.ad;\n          bid.width = response.width;\n          bid.height = response.height;\n\n          bidmanager.addBidResponse(placementCode, bid);\n        }\n\n        else {\n          bid = bidfactory.createBid(CONSTANTS.STATUS.NO_BID);\n          bid.callback_uid = callbackId;\n          bid.bidderCode = bidCode;\n          bidmanager.addBidResponse(placementCode, bid);\n        }\n      }\n    }\n\n    else {\n      if (bidObj) {\n        utils.logMessage('No prebid response for placement '+bidObj.placementCode);\n      }\n\n      else {\n        utils.logMessage('sekindoUM callback general error');\n      }\n    }\n  };\n\n  function _requestBids(bid, callbackId, pubUrl) {\n    //determine tag params\n    var spaceId = utils.getBidIdParameter('spaceId', bid.params);\n    var subId = utils.getBidIdParameter('subId', bid.params);\n    var bidfloor = utils.getBidIdParameter('bidfloor', bid.params);\n    var protocol = ('https:' === document.location.protocol ? 's' : '');\n    var scriptSrc = 'http'+protocol+'://hb.sekindo.com/live/liveView.php?';\n\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 's', spaceId);\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 'subId', subId);\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 'pubUrl', pubUrl);\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 'hbcb', callbackId);\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 'hbver', '3');\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 'hbobj', 'pbjs');\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 'dcpmflr', bidfloor);\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 'hbto', pbjs.bidderTimeout);\n    scriptSrc = utils.tryAppendQueryString(scriptSrc, 'protocol', protocol);\n\n    adloader.loadScript(scriptSrc);\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = sekindoUMAdapter;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/sekindoUM.js","import Adapter from 'src/adapters/adapter';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport { ajax } from 'src/ajax';\n\nconst ServerBidAdapter = function ServerBidAdapter() {\n\n  const baseAdapter = Adapter.createNew('serverbid');\n\n  const BASE_URI = '//e.serverbid.com/api/v2';\n\n  const sizeMap = [null,\n    \"120x90\",\n    \"120x90\",\n    \"468x60\",\n    \"728x90\",\n    \"300x250\",\n    \"160x600\",\n    \"120x600\",\n    \"300x100\",\n    \"180x150\",\n    \"336x280\",\n    \"240x400\",\n    \"234x60\",\n    \"88x31\",\n    \"120x60\",\n    \"120x240\",\n    \"125x125\",\n    \"220x250\",\n    \"250x250\",\n    \"250x90\",\n    \"0x0\",\n    \"200x90\",\n    \"300x50\",\n    \"320x50\",\n    \"320x480\",\n    \"185x185\",\n    \"620x45\",\n    \"300x125\",\n    \"800x250\"\n  ];\n\n  const bidIds = [];\n\n  baseAdapter.callBids = function(params) {\n\n    if (params && params.bids && utils.isArray(params.bids) && params.bids.length) {\n\n      const data = {\n        placements: [],\n        time: Date.now(),\n        user: {},\n        url: utils.getTopWindowUrl(),\n        referrer: document.referrer,\n        enableBotFiltering: true,\n        includePricingData: true\n      };\n\n      const bids = params.bids || [];\n      for (let i = 0; i < bids.length; i++) {\n        const bid = bids[i];\n\n        bidIds.push(bid.bidId);\n\n        const bid_data = {\n          networkId: bid.params.networkId,\n          siteId: bid.params.siteId,\n          zoneIds: bid.params.zoneIds,\n          campaignId: bid.params.campaignId,\n          flightId: bid.params.flightId,\n          adId: bid.params.adId,\n          divName: bid.bidId,\n          adTypes: bid.adTypes || getSize(bid.sizes)\n        };\n\n        if (bid_data.networkId && bid_data.siteId) {\n          data.placements.push(bid_data);\n        }\n\n      }\n\n      if (data.placements.length) {\n        ajax(BASE_URI, _responseCallback, JSON.stringify(data), { method: 'POST', withCredentials: true, contentType: 'application/json' });\n      }\n\n    }\n\n  };\n\n  function _responseCallback(result) {\n\n    let bid;\n    let bidId;\n    let bidObj;\n    let bidCode;\n    let placementCode;\n\n    try {\n      result = JSON.parse(result);\n    } catch (error) {\n      utils.logError(error);\n    }\n\n    for (let i = 0; i < bidIds.length; i++) {\n\n      bidId = bidIds[i];\n      bidObj = utils.getBidRequest(bidId);\n      bidCode = bidObj.bidder;\n      placementCode = bidObj.placementCode;\n\n      if (result) {\n        const decision = result.decisions && result.decisions[bidId];\n        const price = decision && decision.pricing && decision.pricing.clearPrice;\n\n        if (decision && price) {\n          bid = bidfactory.createBid(1, bidObj);\n          bid.bidderCode = bidCode;\n          bid.cpm = price;\n          bid.width = decision.width;\n          bid.height = decision.height;\n          bid.ad = retrieveAd(decision);\n        } else {\n          bid = bidfactory.createBid(2, bidObj);\n          bid.bidderCode = bidCode;\n        }\n\n      } else {\n        bid = bidfactory.createBid(2, bidObj);\n        bid.bidderCode = bidCode;\n      }\n      bidmanager.addBidResponse(placementCode, bid);\n    }\n  }\n\n  function retrieveAd(decision) {\n    return decision.contents && decision.contents[0] && decision.contents[0].body + utils.createTrackPixelHtml(decision.impressionUrl);\n  }\n\n  function getSize(sizes) {\n    const result = [];\n    sizes.forEach(function(size) {\n      const index = sizeMap.indexOf(size[0] + \"x\" + size[1]);\n      if (index >= 0) {\n        result.push(index);\n      }\n    });\n    return result;\n  }\n\n  // Export the `callBids` function, so that Prebid.js can execute\n  // this function when the page asks to send out bid requests.\n  return {\n    callBids: baseAdapter.callBids\n  };\n\n};\n\nServerBidAdapter.createNew = function() {\n  return new ServerBidAdapter();\n};\n\nmodule.exports = ServerBidAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/serverbid.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\nvar utils = require('../utils');\n\nvar SonobiAdapter = function SonobiAdapter(){\n  var keymakerAssoc = {};   //  Remember placement codes for callback mapping\n  var bidReqAssoc = {};     //  Remember bids for bid complete reporting\n\n  function _phone_in(request){\n    var trinity = 'https://apex.go.sonobi.com/trinity.js?key_maker=';\n    var adSlots = request.bids || [];\n    var bidderRequestId = request.bidderRequestId;\n    var ref = (window.frameElement) ? '&ref=' + encodeURI(top.location.host || document.referrer) : '';\n    adloader.loadScript(trinity + JSON.stringify(_keymaker(adSlots)) + '&cv=' + _operator(bidderRequestId) + ref);\n  }\n\n  function _keymaker(adSlots){\n    var keyring = {};\n    utils._each(adSlots, function(bidRequest){\n      if(bidRequest.params){\n        //  Optional\n        var floor = (bidRequest.params.floor) ? bidRequest.params.floor : null;\n        //  Mandatory\n        var slotIdentifier = (bidRequest.params.ad_unit) ? bidRequest.params.ad_unit : (bidRequest.params.placement_id) ? bidRequest.params.placement_id : null;\n        var sizes = (bidRequest.params.sizes) ? bidRequest.params.sizes : bidRequest.sizes || null;\n        sizes = utils.parseSizesInput(sizes).toString();\n        \n        if (utils.isEmpty(sizes)){\n          utils.logError('Sonobi adapter expects sizes for ' + bidRequest.placementCode);\n        }\n\n        var bidId = bidRequest.bidId;\n\n        var args = (sizes) ? ((floor) ? (sizes + '|f=' + floor) : (sizes)) : (floor) ? ('f=' + floor) : '';\n        if (/^[\\/]?[\\d]+[[\\/].+[\\/]?]?$/.test(slotIdentifier)){\n          slotIdentifier = slotIdentifier.charAt(0) === '/' ? slotIdentifier : '/' + slotIdentifier;\n          keyring[slotIdentifier + '|' + bidId] = args;\n          keymakerAssoc[slotIdentifier + '|' + bidId] = bidRequest.placementCode;\n          bidReqAssoc[bidRequest.placementCode] = bidRequest;\n        } else if (/^[0-9a-fA-F]{20}$/.test(slotIdentifier) && slotIdentifier.length === 20){\n          keyring[bidId] = slotIdentifier + '|' + args;\n          keymakerAssoc[bidId] = bidRequest.placementCode;\n          bidReqAssoc[bidRequest.placementCode] = bidRequest;\n        } else  {\n          keymakerAssoc[bidId] = bidRequest.placementCode;\n          bidReqAssoc[bidRequest.placementCode] = bidRequest;\n          _failure(bidRequest.placementCode);\n          utils.logError('The ad unit code or Sonobi Placement id for slot ' + bidRequest.placementCode + ' is invalid');\n        }\n      }\n    });\n    return keyring;\n  }\n\n  function _operator(bidderRequestId){\n    var cb_name = \"sbi_\" + bidderRequestId;\n    window[cb_name] = _trinity;\n    return cb_name;\n  }\n\n  function _trinity(response){\n    var slots = response.slots || {};\n    var sbi_dc = response.sbi_dc || '';\n    utils._each(slots, function(bid, slot_id){\n      var placementCode = keymakerAssoc[slot_id];\n      if (bid.sbi_aid && bid.sbi_mouse && bid.sbi_size){\n        _success(placementCode, sbi_dc, bid);\n      } else {\n        _failure(placementCode);\n      }\n      delete keymakerAssoc[slot_id];\n    });\n  }\n\n  function _seraph(placementCode){\n    var theOne = bidReqAssoc[placementCode];\n    delete bidReqAssoc[placementCode];\n    return theOne;\n  }\n\n  function _success(placementCode, sbi_dc, bid){\n    var goodBid = bidfactory.createBid(1, _seraph(placementCode));\n    if(bid.sbi_dozer){\n      goodBid.dealId = bid.sbi_dozer;\n    }\n    goodBid.bidderCode = 'sonobi';\n    goodBid.ad = _creative(sbi_dc, bid.sbi_aid);\n    goodBid.cpm = Number(bid.sbi_mouse);\n    goodBid.width = Number(bid.sbi_size.split('x')[0]) || 1;\n    goodBid.height = Number(bid.sbi_size.split('x')[1]) || 1;\n    bidmanager.addBidResponse(placementCode, goodBid);\n  }\n\n  function _failure(placementCode){\n    var failBid = bidfactory.createBid(2, _seraph(placementCode));\n    failBid.bidderCode = 'sonobi';\n    bidmanager.addBidResponse(placementCode, failBid);\n  }\n\n  function _creative(sbi_dc, sbi_aid){\n    var src = 'https://' + sbi_dc + 'apex.go.sonobi.com/sbi.js?aid=' + sbi_aid + '&as=null';\n    return '<script type=\"text/javascript\" src=\"' + src + '\"></script>';\n  }\n\n  return {\n    callBids:       _phone_in,\n    formRequest:    _keymaker,\n    parseResponse:  _trinity,\n    success:        _success,\n    failure:        _failure\n  };\n};\n\nmodule.exports = SonobiAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/sonobi.js","var CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\n/**\n * Adapter for requesting bids from Sovrn\n */\nvar SovrnAdapter = function SovrnAdapter() {\n  var sovrnUrl = 'ap.lijit.com/rtb/bid';\n\n  function _callBids(params) {\n    var sovrnBids = params.bids || [];\n\n    _requestBids(sovrnBids);\n  }\n\n  function _requestBids(bidReqs) {\n    // build bid request object\n    var domain = window.location.host;\n    var page = window.location.pathname + location.search + location.hash;\n\n    var sovrnImps = [];\n\n    //build impression array for sovrn\n    utils._each(bidReqs, function (bid) {\n      var tagId = utils.getBidIdParameter('tagid', bid.params);\n      var bidFloor = utils.getBidIdParameter('bidfloor', bid.params);\n      var adW = 0;\n      var adH = 0;\n\n      //sovrn supports only one size per tagid, so we just take the first size if there are more\n      //if we are a 2 item array of 2 numbers, we must be a SingleSize array\n      var bidSizes = Array.isArray(bid.params.sizes) ? bid.params.sizes : bid.sizes;\n      var sizeArrayLength = bidSizes.length;\n      if (sizeArrayLength === 2 && typeof bidSizes[0] === 'number' && typeof bidSizes[1] === 'number') {\n        adW = bidSizes[0];\n        adH = bidSizes[1];\n      } else {\n        adW = bidSizes[0][0];\n        adH = bidSizes[0][1];\n      }\n\n      var imp =\n      {\n        id: bid.bidId,\n        banner: {\n          w: adW,\n          h: adH\n        },\n        tagid: tagId,\n        bidfloor: bidFloor\n      };\n      sovrnImps.push(imp);\n    });\n\n    // build bid request with impressions\n    var sovrnBidReq = {\n      id: utils.getUniqueIdentifierStr(),\n      imp: sovrnImps,\n      site: {\n        domain: domain,\n        page: page\n      }\n    };\n\n    var scriptUrl = '//' + sovrnUrl + '?callback=window.pbjs.sovrnResponse' +\n      '&src=' + CONSTANTS.REPO_AND_VERSION +\n      '&br=' + encodeURIComponent(JSON.stringify(sovrnBidReq));\n    adloader.loadScript(scriptUrl);\n  }\n\n  function addBlankBidResponses(impidsWithBidBack) {\n    var missing = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'sovrn');\n    if (missing) {\n      missing = missing.bids.filter(bid => impidsWithBidBack.indexOf(bid.bidId) < 0);\n    } else {\n      missing = [];\n    }\n\n    missing.forEach(function (bidRequest) {\n      // Add a no-bid response for this bid request.\n      var bid = {};\n      bid = bidfactory.createBid(2, bidRequest);\n      bid.bidderCode = 'sovrn';\n      bidmanager.addBidResponse(bidRequest.placementCode, bid);\n    });\n  }\n\n  //expose the callback to the global object:\n  pbjs.sovrnResponse = function (sovrnResponseObj) {\n    // valid object?\n    if (sovrnResponseObj && sovrnResponseObj.id) {\n      // valid object w/ bid responses?\n      if (sovrnResponseObj.seatbid && sovrnResponseObj.seatbid.length !== 0 && sovrnResponseObj.seatbid[0].bid && sovrnResponseObj.seatbid[0].bid.length !== 0) {\n        var impidsWithBidBack = [];\n        sovrnResponseObj.seatbid[0].bid.forEach(function (sovrnBid) {\n\n          var responseCPM;\n          var placementCode = '';\n          var id = sovrnBid.impid;\n          var bid = {};\n\n          // try to fetch the bid request we sent Sovrn\n          var bidObj = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'sovrn').bids\n          .find(bid => bid.bidId === id);\n\n          if (bidObj) {\n            placementCode = bidObj.placementCode;\n            bidObj.status = CONSTANTS.STATUS.GOOD;\n\n            //place ad response on bidmanager._adResponsesByBidderId\n            responseCPM = parseFloat(sovrnBid.price);\n\n            if (responseCPM !== 0) {\n              sovrnBid.placementCode = placementCode;\n              sovrnBid.size = bidObj.sizes;\n              var responseAd = sovrnBid.adm;\n\n              // build impression url from response\n              var responseNurl = '<img src=\"' + sovrnBid.nurl + '\">';\n\n              //store bid response\n              //bid status is good (indicating 1)\n              bid = bidfactory.createBid(1, bidObj);\n              bid.creative_id = sovrnBid.id;\n              bid.bidderCode = 'sovrn';\n              bid.cpm = responseCPM;\n\n              //set ad content + impression url\n              // sovrn returns <script> block, so use bid.ad, not bid.adurl\n              bid.ad = decodeURIComponent(responseAd + responseNurl);\n\n              // Set width and height from response now\n              bid.width = parseInt(sovrnBid.w);\n              bid.height = parseInt(sovrnBid.h);\n\n              bidmanager.addBidResponse(placementCode, bid);\n              impidsWithBidBack.push(id);\n            }\n          }\n        });\n\n        addBlankBidResponses(impidsWithBidBack);\n      } else {\n        //no response data for all requests\n        addBlankBidResponses([]);\n      }\n    } else {\n      //no response data for all requests\n      addBlankBidResponses([]);\n    }\n\n  }; // sovrnResponse\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = SovrnAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/sovrn.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\nvar SpringServeAdapter;\nSpringServeAdapter = function SpringServeAdapter() {\n\n  function buildSpringServeCall(bid) {\n\n    var spCall = window.location.protocol + '//bidder.springserve.com/display/hbid?';\n\n    //get width and height from bid attribute\n    var size = bid.sizes[0];\n    var width = size[0];\n    var height = size[1];\n\n    spCall += '&w=';\n    spCall += width;\n    spCall += '&h=';\n    spCall += height;\n\n    var params = bid.params;\n\n    //maps param attributes to request parameters\n    var requestAttrMap = {\n      sp: 'supplyPartnerId',\n      imp_id: 'impId'\n    };\n\n    for (var property in requestAttrMap) {\n      if (requestAttrMap.hasOwnProperty && params.hasOwnProperty(requestAttrMap[property])) {\n        spCall += '&';\n        spCall += property;\n        spCall += '=';\n\n        //get property from params and include it in request\n        spCall += params[requestAttrMap[property]];\n      }\n    }\n\n    var domain = window.location.hostname;\n\n    //override domain when testing\n    if (params.hasOwnProperty('test') && params.test === true) {\n      spCall += '&debug=true';\n      domain = 'test.com';\n    }\n\n    spCall += '&domain=';\n    spCall += domain;\n    spCall += '&callback=pbjs.handleSpringServeCB';\n\n    return spCall;\n  }\n\n  function _callBids(params) {\n    var bids = params.bids || [];\n    for (var i = 0; i < bids.length; i++) {\n      var bid = bids[i];\n      //bidmanager.pbCallbackMap[bid.params.impId] = params;\n      adloader.loadScript(buildSpringServeCall(bid));\n    }\n  }\n\n  pbjs.handleSpringServeCB = function (responseObj) {\n    if (responseObj && responseObj.seatbid && responseObj.seatbid.length > 0 &&\n      responseObj.seatbid[0].bid[0] !== undefined) {\n      //look up the request attributs stored in the bidmanager\n      var responseBid = responseObj.seatbid[0].bid[0];\n      //var requestObj = bidmanager.getPlacementIdByCBIdentifer(responseBid.impid);\n      var requestBids = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'springserve');\n      if (requestBids && requestBids.bids.length > 0) {\n        requestBids = requestBids.bids.filter(bid => bid.params && bid.params.impId === responseBid.impid);\n      } else {\n        requestBids = [];\n      }\n      var bid = bidfactory.createBid(1);\n      var placementCode;\n\n      //assign properties from the original request to the bid object\n      for (var i = 0; i < requestBids.length; i++) {\n        var bidRequest = requestBids[i];\n        if (bidRequest.bidder === 'springserve') {\n          placementCode = bidRequest.placementCode;\n          var size = bidRequest.sizes[0];\n          bid.width = size[0];\n          bid.height = size[1];\n        }\n      }\n\n      if (requestBids[0]) {bid.bidderCode = requestBids[0].bidder;}\n\n      if (responseBid.hasOwnProperty('price') && responseBid.hasOwnProperty('adm')) {\n        //assign properties from the response to the bid object\n        bid.cpm = responseBid.price;\n        bid.ad = responseBid.adm;\n      } else {\n        //make object for invalid bid response\n        bid = bidfactory.createBid(2);\n        bid.bidderCode = 'springserve';\n      }\n\n      bidmanager.addBidResponse(placementCode, bid);\n    }\n  };\n\n  // Export the callBids function, so that prebid.js can execute this function\n  // when the page asks to send out bid requests.\n  return {\n    callBids: _callBids,\n    buildSpringServeCall: buildSpringServeCall\n  };\n};\n\nmodule.exports = SpringServeAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/springserve.js","\"use strict\";\nvar bidfactory = require(\"../bidfactory\");\nvar bidmanager = require(\"../bidmanager\");\nvar utils = require('../utils');\nvar adloader_1 = require(\"../adloader\");\nvar ROOT_URL = \"//cdn.thoughtleadr.com/v4/\";\nvar BID_AVAILABLE = 1;\n\nvar ThoughtleadrAdapter = (function () {\n  function ThoughtleadrAdapter() {\n  }\n\n  ThoughtleadrAdapter.prototype.callBids = function (params) {\n    if (!window.tldr || !window.tldr.requestPrebid) {\n      var rootUrl = ROOT_URL;\n      if (window.tldr && window.tldr.config && window.tldr.config.root_url) {\n        rootUrl = window.tldr.config.root_url;\n      }\n      adloader_1.loadScript(rootUrl + \"page.js\", this.handleBids.bind(this, params), true);\n    }\n    else {\n      this.handleBids(params);\n    }\n  };\n\n  ThoughtleadrAdapter.prototype.handleBids = function (params) {\n    var bids = (params.bids || []).filter(function (bid) {\n      return ThoughtleadrAdapter.valid(bid);\n    });\n\n    for (var _i = 0, bids_1 = bids; _i < bids_1.length; _i++) {\n      var bid = bids_1[_i];\n      this.requestPlacement(bid);\n    }\n  };\n\n  ThoughtleadrAdapter.prototype.requestPlacement = function (bid) {\n    var _this = this;\n    var rid = utils.generateUUID(null);\n    var size = ThoughtleadrAdapter.getSizes(bid.sizes);\n\n    window.tldr.requestPrebid(bid.params.placementId, rid).then(function (params) {\n      if (!params || !params.bid) {\n        utils.logError(\"invalid response from tldr.requestPrebid\", undefined, undefined);\n        return;\n      }\n\n      _this.receiver = function (ev) {\n        if (ev.origin === location.origin &&\n          ev.data && ev.data.TLDR_REQUEST && ev.data.TLDR_REQUEST.rid === rid) {\n          ev.source.postMessage({TLDR_RESPONSE: {config: params.config, rid: rid}}, location.origin);\n        }\n        _this.stopListen();\n      };\n      window.addEventListener(\"message\", _this.receiver, false);\n      setTimeout(function () {\n        return _this.stopListen();\n      }, 5000);\n\n      var bidObject;\n      if (params.bid.code === BID_AVAILABLE) {\n        bidObject = bidfactory.createBid(params.bid.code);\n        bidObject.bidderCode = 'thoughtleadr';\n        bidObject.cpm = params.bid.cpm;\n        bidObject.ad = params.bid.ad;\n        bidObject.width = size.width;\n        bidObject.height = size.height;\n      }\n      else {\n        bidObject = bidfactory.createBid(params.bid.code);\n        bidObject.bidderCode = 'thoughtleadr';\n      }\n      bidmanager.addBidResponse(bid.placementCode, bidObject);\n    });\n  };\n\n  ThoughtleadrAdapter.prototype.stopListen = function () {\n    if (this.receiver) {\n      window.removeEventListener(\"message\", this.receiver);\n      this.receiver = undefined;\n    }\n  };\n\n  ThoughtleadrAdapter.valid = function (bid) {\n    return !!(bid && bid.params && typeof bid.params.placementId === \"string\");\n  };\n\n  ThoughtleadrAdapter.getSizes = function (sizes) {\n    var first = sizes[0];\n    if (Array.isArray(first)) {\n      return ThoughtleadrAdapter.getSizes(first);\n    }\n    return {\n      width: sizes[0],\n      height: sizes[1]\n    };\n  };\n  return ThoughtleadrAdapter;\n}());\n\nmodule.exports = ThoughtleadrAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/thoughtleadr.js","var Adapter = require('./adapter.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\n\nvar StickyAdsTVAdapter = function StickyAdsTVAdapter() {\n\n  var STICKYADS_BIDDERCODE = 'stickyadstv';\n  var MUSTANG_URL = \"//cdn.stickyadstv.com/mustang/mustang.min.js\";\n  var INTEXTROLL_URL = \"//cdn.stickyadstv.com/prime-time/intext-roll.min.js\";\n  var SCREENROLL_URL = \"//cdn.stickyadstv.com/prime-time/screen-roll.min.js\";\n  \n  var topMostWindow = getTopMostWindow();\n  topMostWindow.stickyadstv_cache = {};\n\n  function _callBids(params) {\n     \n    var bids = params.bids || [];\n    for (var i = 0; i < bids.length; i++) {\n      var bid = bids[i];\n      // Send out bid request for each bid given its tag IDs and query strings\n\n      if(bid.placementCode && bid.params.zoneId) {\n        sendBidRequest(bid);\n      }\n      else {\n        console.warn(\"StickyAdsTV: Missing mandatory field(s).\");\n      }\n\n    }\n  }\n\n  function sendBidRequest(bid){\n\n    var placementCode = bid.placementCode;\n\n    var integrationType = bid.params.format ? bid.params.format : \"inbanner\"; \n    var urltoLoad = MUSTANG_URL;\n\n    if(integrationType === \"intext-roll\"){\n      urltoLoad = INTEXTROLL_URL;\n    }\n    if(integrationType === \"screen-roll\"){\n      urltoLoad = SCREENROLL_URL;\n    }\n\n    var bidRegistered = false;\n    adloader.loadScript(urltoLoad, function(){\n\n      getBid(bid, function(bidObject){\n\n        if(!bidRegistered){\n          bidRegistered = true;\n          bidmanager.addBidResponse(placementCode, bidObject);\n        }\n        \n      });\n    }, true);\n  }\n\n  function getBid(bid, callback){\n    var zoneId = bid.params.zoneId || bid.params.zone; //accept both\n    var size = getBiggerSize(bid.sizes);\n\n    var vastLoader = new window.com.stickyadstv.vast.VastLoader();\n    bid.vast = topMostWindow.stickyadstv_cache[bid.placementCode] = vastLoader.getVast();\n\n    var vastCallback = {\n      onSuccess : bind(function(){\n        \n        //'this' is the bid request here\n        var bidRequest = this;\n        \n        var adHtml = formatAdHTML(bidRequest,size);\n        var price = extractPrice(bidRequest.vast);\n\n        callback(formatBidObject(bidRequest, true, price, adHtml, size[0], size[1]));\n        \n      },bid),\n      onError : bind(function(){\n        var bidRequest = this;\n        callback(formatBidObject(bidRequest, false));\n      },bid)\n    };\n\n    var config = {\n      zoneId:zoneId,\n      playerSize:size[0]+\"x\"+size[1],\n      vastUrlParams: bid.params.vastUrlParams,\n      componentId: \"prebid-sticky\"+(bid.params.format ? \"-\"+bid.params.format : \"\")\n    };\n\n    if(bid.params.format === \"screen-roll\"){\n      //in screenroll case we never use the original div size.\n      config.playerSize = window.com.stickyadstv.screenroll.getPlayerSize();\n    }\n    \n    vastLoader.load(config, vastCallback);\n  }\n\n  function getBiggerSize(array){\n    var result = [1,1];\n    for(var i = 0; i< array.length; i++){\n      if(array[i][0]*array[i][1] > result[0]*result[1]){\n        result = array[i];\n      }\n    }\n    return result;\n  }\n  \n  var formatInBannerHTML = function(bid,size){\n    var placementCode = bid.placementCode;\n    \n    var divHtml = \"<div id=\\\"stickyadstv_prebid_target\\\"></div>\";\n\n    var script = \"<script type='text/javascript'>\"+\n    //get the top most accessible window\n    \"var topWindow = (function(){var res=window; try{while(top != res){if(res.parent.location.href.length)res=res.parent;}}catch(e){}return res;})();\"+\n    \"var vast =  topWindow.stickyadstv_cache[\\\"\"+placementCode+\"\\\"];\"+\n    \"var config = {\"+\n    \"  preloadedVast:vast,\"+\n    \"  autoPlay:true\"+\n    \"};\"+\n    \"var ad = new topWindow.com.stickyadstv.vpaid.Ad(document.getElementById(\\\"stickyadstv_prebid_target\\\"),config);\"+\n    \"ad.initAd(\"+size[0]+\",\"+size[1]+\",\\\"\\\",0,\\\"\\\",\\\"\\\");\"+\n\n    \"</script>\";\n\n    return divHtml+script;\n  };\n\n  var formatIntextHTML = function(bid){\n    var placementCode = bid.placementCode;\n\n    var config = bid.params;\n\n    //default placement if no placement is set\n    if(!config.hasOwnProperty(\"domId\") && !config.hasOwnProperty(\"auto\") && !config.hasOwnProperty(\"p\") && !config.hasOwnProperty(\"article\")){\n      config.domId = placementCode;\n    }\n\n    var script = \"<script type='text/javascript'>\"+\n    //get the top most accessible window\n    \"var topWindow = (function(){var res=window; try{while(top != res){if(res.parent.location.href.length)res=res.parent;}}catch(e){}return res;})();\"+\n    \"var vast =  topWindow.stickyadstv_cache[\\\"\"+placementCode+\"\\\"];\"+\n    \"var config = {\"+\n    \"  preloadedVast:vast\";\n\n    for(var key in config){\n      //dont' send format parameter\n      //neither zone nor vastUrlParams value as Vast is already loaded\n      if(config.hasOwnProperty(key) && key !== \"format\" && key !== \"zone\" && key !== \"zoneId\" && key !== \"vastUrlParams\"){\n\n        script += \",\"+key+\":\\\"\"+config[key]+\"\\\"\";\n      }\n    }\n    script += \"};\"+\n    \n    \"topWindow.com.stickyadstv.intextroll.start(config);\"+\n\n    \"</script>\";\n\n    return script;\n  };\n\n  var formatScreenRollHTML = function(bid){\n    var placementCode = bid.placementCode;\n\n    var config = bid.params;\n\n    var script = \"<script type='text/javascript'>\"+\n       \n    //get the top most accessible window\n    \"var topWindow = (function(){var res=window; try{while(top != res){if(res.parent.location.href.length)res=res.parent;}}catch(e){}return res;})();\"+\n    \"var vast =  topWindow.stickyadstv_cache[\\\"\"+placementCode+\"\\\"];\"+\n    \"var config = {\"+\n    \"  preloadedVast:vast\";\n\n    for(var key in config){\n      //dont' send format parameter\n      //neither zone nor vastUrlParams values as Vast is already loaded\n      if(config.hasOwnProperty(key) && key !== \"format\" && key !== \"zone\" && key !== \"zoneId\" && key !== \"vastUrlParams\"){\n\n        script += \",\"+key+\":\\\"\"+config[key]+\"\\\"\";\n      }\n    }\n    script += \"};\"+\n    \n    \"topWindow.com.stickyadstv.screenroll.start(config);\"+\n\n    \"</script>\";\n\n    return script;\n  };\n\n  function formatAdHTML(bid, size){\n\n    var integrationType = bid.params.format;\n\n    var html = \"\";\n    if(integrationType === \"intext-roll\"){\n      html = formatIntextHTML(bid);\n    }\n    else if(integrationType === \"screen-roll\"){\n      html = formatScreenRollHTML(bid);\n    }\n    else {\n      html = formatInBannerHTML(bid,size);\n    }\n    \n    return html;\n  }\n  \n\n  function extractPrice(vast){\n    var priceData = vast.getPricing();\n\n    if(!priceData) {\n      console.warn(\"StickyAdsTV: Bid pricing Can't be retreived. You may need to enable pricing on you're zone. Please get in touch with your sticky contact.\");\n    }\n    \n    return priceData;\n  }\n\n  function formatBidObject(bidRequest, valid, priceData, html, width, height){\n    var bidObject;\n    if(valid && priceData) {\n      // valid bid response\n      bidObject = bidfactory.createBid(1, bidRequest);\n      bidObject.bidderCode = bidRequest.bidder;\n      bidObject.cpm = priceData.price;\n      bidObject.currencyCode = priceData.currency;\n      bidObject.ad = html;\n      bidObject.width = width;\n      bidObject.height = height;\n      \n    }\n    else {\n      // invalid bid response\n      bidObject = bidfactory.createBid(2, bidRequest);\n      bidObject.bidderCode = bidRequest.bidder;\n    }\n    return bidObject;\n  }\n\n\n  /**\n  * returns the top most accessible window\n  */\n  function getTopMostWindow(){\n    var res=window; \n\n    try {\n      while(top !== res){\n        if(res.parent.location.href.length)\n          res=res.parent;\n      }\n    }\n    catch(e){}\n\n    return res;\n  }\n  \n  /* Create a function bound to a given object (assigning `this`, and arguments,\n   * optionally). Binding with arguments is also known as `curry`.\n   * Delegates to **ECMAScript 5**'s native `Function.bind` if available.\n   * We check for `func.bind` first, to fail fast when `func` is undefined.\n   *\n   * @param {function} func\n   * @param {optional} context\n   * @param {...any} var_args \n   * @return {function}\n   */\n  var bind = function(func, context) {\n\n    return function() {         \n      return func.apply(context,arguments);\n    };\n  };\n\n\n  return Object.assign(Adapter.createNew(STICKYADS_BIDDERCODE), {\n    callBids: _callBids,\n    formatBidObject: formatBidObject,\n    formatAdHTML: formatAdHTML,\n    getBiggerSize:getBiggerSize,\n    getBid:getBid,\n    getTopMostWindow:getTopMostWindow,\n    createNew: StickyAdsTVAdapter.createNew //enable alias feature (to be used for freewheel-ssp alias)\n  });\n};\n\nStickyAdsTVAdapter.createNew = function() {\n  return new StickyAdsTVAdapter();\n};\n\nmodule.exports = StickyAdsTVAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/stickyadstv.js","var utils = require('../utils.js');\nvar adloader = require('../adloader.js');\nvar bidmanager = require('../bidmanager.js');\nvar bidfactory = require('../bidfactory.js');\n\n/* TripleLift bidder factory function\n*  Use to create a TripleLiftAdapter object\n*/\n\n\nvar TripleLiftAdapter = function TripleLiftAdapter() {\n\n  function _callBids(params) {\n    var tlReq = params.bids;\n    var bidsCount = tlReq.length;\n\n    // set expected bids count for callback execution\n    // bidmanager.setExpectedBidsCount('triplelift',bidsCount);\n\n    for (var i = 0; i < bidsCount; i++) {\n      var bidRequest = tlReq[i];\n      var callbackId = bidRequest.bidId;\n      adloader.loadScript(buildTLCall(bidRequest, callbackId));\n      // store a reference to the bidRequest from the callback id\n      // bidmanager.pbCallbackMap[callbackId] = bidRequest;\n    }\n  }\n\n\n  function buildTLCall(bid, callbackId) {\n    //determine tag params\n    var inventoryCode = utils.getBidIdParameter('inventoryCode', bid.params);\n    var floor = utils.getBidIdParameter('floor', bid.params);\n\n    // build our base tag, based on if we are http or https\n    var tlURI = '//tlx.3lift.com/header/auction?';\n    var tlCall = document.location.protocol + tlURI;\n\n    tlCall = utils.tryAppendQueryString(tlCall, 'callback', 'pbjs.TLCB');\n    tlCall = utils.tryAppendQueryString(tlCall, 'lib', 'prebid');\n    tlCall = utils.tryAppendQueryString(tlCall, 'v', '0.24.0-pre');\n    tlCall = utils.tryAppendQueryString(tlCall, 'callback_id', callbackId);\n    tlCall = utils.tryAppendQueryString(tlCall, 'inv_code', inventoryCode);\n    tlCall = utils.tryAppendQueryString(tlCall, 'floor', floor);\n\n    // indicate whether flash support exists\n    tlCall = utils.tryAppendQueryString(tlCall, 'fe', isFlashEnabled());\n\n    // sizes takes a bit more logic\n    var sizeQueryString = utils.parseSizesInput(bid.sizes);\n    if (sizeQueryString) {\n      tlCall += 'size=' + sizeQueryString + '&';\n    }\n\n    // append referrer\n    var referrer = utils.getTopWindowUrl();\n    tlCall = utils.tryAppendQueryString(tlCall, 'referrer', referrer);\n\n    // remove the trailing \"&\"\n    if (tlCall.lastIndexOf('&') === tlCall.length - 1) {\n      tlCall = tlCall.substring(0, tlCall.length - 1);\n    }\n\n    // @if NODE_ENV='debug'\n    utils.logMessage('tlCall request built: ' + tlCall);\n    // @endif\n\n    // append a timer here to track latency\n    bid.startTime = new Date().getTime();\n\n    return tlCall;\n  }\n\n  function isFlashEnabled() {\n    var hasFlash = 0;\n    try {\n      // check for Flash support in IE\n      var fo = new window.ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n      if (fo) { hasFlash = 1; }\n    } catch (e) {\n      if (navigator.mimeTypes &&\n        navigator.mimeTypes['application/x-shockwave-flash'] !== undefined &&\n        navigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin) {\n        hasFlash = 1;\n      }\n    }\n    return hasFlash;\n  }\n\n  // expose the callback to the global object:\n  pbjs.TLCB = function(tlResponseObj) {\n    if (tlResponseObj && tlResponseObj.callback_id) {\n      var bidObj = utils.getBidRequest(tlResponseObj.callback_id);\n      var placementCode = bidObj && bidObj.placementCode;\n\n      // @if NODE_ENV='debug'\n      if (bidObj) { utils.logMessage('JSONP callback function called for inventory code: ' + bidObj.params.inventoryCode); }\n      // @endif\n\n      var bid = [];\n      if (tlResponseObj && tlResponseObj.cpm && tlResponseObj.cpm !== 0) {\n\n        bid = bidfactory.createBid(1, bidObj);\n        bid.bidderCode = 'triplelift';\n        bid.cpm = tlResponseObj.cpm;\n        bid.ad = tlResponseObj.ad;\n        bid.width = tlResponseObj.width;\n        bid.height = tlResponseObj.height;\n        bid.dealId = tlResponseObj.deal_id;\n        bidmanager.addBidResponse(placementCode, bid);\n\n      } else {\n        // no response data\n        // @if NODE_ENV='debug'\n        if (bidObj) {utils.logMessage('No prebid response from TripleLift for inventory code: ' + bidObj.params.inventoryCode);}\n        // @endif\n        bid = bidfactory.createBid(2, bidObj);\n        bid.bidderCode = 'triplelift';\n        bidmanager.addBidResponse(placementCode, bid);\n      }\n\n    } else {\n      // no response data\n      // @if NODE_ENV='debug'\n      utils.logMessage('No prebid response for placement %%PLACEMENT%%');\n      // @endif\n\n    }\n\n  };\n\n  return {\n    callBids: _callBids\n\n  };\n};\nmodule.exports = TripleLiftAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/triplelift.js","import { getBidRequest } from '../utils.js';\n\nvar CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar adloader = require('../adloader.js');\nvar bidmanager = require('../bidmanager.js');\nvar bidfactory = require('../bidfactory.js');\nvar Adapter = require('./adapter.js');\n\nvar TwengaAdapter;\nTwengaAdapter = function TwengaAdapter() {\n  var baseAdapter = Adapter.createNew('twenga');\n\n  baseAdapter.callBids = function (params) {\n    for (var i = 0; i < params.bids.length; i++) {\n      var bidRequest = params.bids[i];\n      var callbackId = bidRequest.bidId;\n      adloader.loadScript(buildBidCall(bidRequest, callbackId));\n    }\n  };\n\n  function buildBidCall(bid, callbackId) {\n\n    var bidUrl = '//rtb.t.c4tw.net/Bid?';\n    bidUrl = utils.tryAppendQueryString(bidUrl, 's', 'h');\n    bidUrl = utils.tryAppendQueryString(bidUrl, 'callback', 'pbjs.handleTwCB');\n    bidUrl = utils.tryAppendQueryString(bidUrl, 'callback_uid', callbackId);\n    bidUrl = utils.tryAppendQueryString(bidUrl, 'referrer', utils.getTopWindowUrl());\n    if (bid.params) {\n      for (var key in bid.params) {\n        var value = bid.params[key];\n        switch (key) {\n        case 'placementId': key = 'id'; break;\n        case 'siteId': key = 'sid'; break;\n        case 'publisherId': key = 'pid'; break;\n        case 'currency': key = 'cur'; break;\n        case 'bidFloor': key = 'min'; break;\n        case 'country': key = 'gz'; break;\n        }\n        bidUrl = utils.tryAppendQueryString(bidUrl, key, value);\n      }\n    }\n\n    var sizes = utils.parseSizesInput(bid.sizes);\n    if (sizes.length > 0) {\n      bidUrl = utils.tryAppendQueryString(bidUrl, 'size', sizes.join(','));\n    }\n\n    bidUrl += 'ta=1';\n\n    // @if NODE_ENV='debug'\n    utils.logMessage('bid request built: ' + bidUrl);\n\n    // @endif\n\n    //append a timer here to track latency\n    bid.startTime = new Date().getTime();\n\n    return bidUrl;\n  }\n\n  //expose the callback to the global object:\n  pbjs.handleTwCB = function (bidResponseObj) {\n\n    var bidCode;\n\n    if (bidResponseObj && bidResponseObj.callback_uid) {\n\n      var responseCPM;\n      var id = bidResponseObj.callback_uid;\n      var placementCode = '';\n      var bidObj = getBidRequest(id);\n      if (bidObj) {\n\n        bidCode = bidObj.bidder;\n\n        placementCode = bidObj.placementCode;\n\n        bidObj.status = CONSTANTS.STATUS.GOOD;\n      }\n\n      // @if NODE_ENV='debug'\n      utils.logMessage('JSONP callback function called for ad ID: ' + id);\n\n      // @endif\n      var bid = [];\n      if (bidResponseObj.result &&\n          bidResponseObj.result.cpm &&\n          bidResponseObj.result.cpm !== 0 &&\n          bidResponseObj.result.ad) {\n\n        var result = bidResponseObj.result;\n\n        responseCPM = parseInt(result.cpm, 10);\n\n        //CPM response from /Bid is dollar/cent multiplied by 10000\n        //in order to avoid using floats\n        //switch CPM to \"dollar/cent\"\n        responseCPM = responseCPM / 10000;\n\n        var ad = result.ad.replace('%%WP%%', result.cpm);\n\n        //store bid response\n        //bid status is good (indicating 1)\n        bid = bidfactory.createBid(1, bidObj);\n        bid.creative_id = result.creative_id;\n        bid.bidderCode = bidCode;\n        bid.cpm = responseCPM;\n        if (ad && (ad.lastIndexOf('http', 0) === 0 || ad.lastIndexOf('//', 0) === 0))\n          bid.adUrl = ad;\n        else\n          bid.ad = ad;\n        bid.width = result.width;\n        bid.height = result.height;\n\n        bidmanager.addBidResponse(placementCode, bid);\n\n      } else {\n        //no response data\n        // @if NODE_ENV='debug'\n        utils.logMessage('No prebid response from Twenga for placement code ' + placementCode);\n\n        // @endif\n        //indicate that there is no bid for this placement\n        bid = bidfactory.createBid(2, bidObj);\n        bid.bidderCode = bidCode;\n        bidmanager.addBidResponse(placementCode, bid);\n      }\n\n    } else {\n      //no response data\n      // @if NODE_ENV='debug'\n      utils.logMessage('No prebid response for placement %%PLACEMENT%%');\n\n      // @endif\n    }\n  };\n\n  return {\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode,\n    createNew: TwengaAdapter.createNew,\n    buildBidCall: buildBidCall\n  };\n};\n\nTwengaAdapter.createNew = function () {\n  return new TwengaAdapter();\n};\n\nmodule.exports = TwengaAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/twenga.js","/**\n * @overview Yieldbot sponsored Prebid.js adapter.\n * @author elljoh\n */\nvar adloader = require('../adloader');\nvar bidfactory = require('../bidfactory');\nvar bidmanager = require('../bidmanager');\nvar utils = require('../utils');\n\n/**\n * Adapter for requesting bids from Yieldbot.\n *\n * @returns {Object} Object containing implementation for invocation in {@link module:adaptermanger.callBids}\n * @class\n */\nvar YieldbotAdapter = function YieldbotAdapter() {\n\n  window.ybotq = window.ybotq || [];\n\n  var ybotlib = {\n    BID_STATUS: {\n      PENDING: 0,\n      AVAILABLE: 1,\n      EMPTY: 2\n    },\n    definedSlots: [],\n    pageLevelOption: false,\n    /**\n     * Builds the Yieldbot creative tag.\n     *\n     * @param {String} slot - The slot name to bid for\n     * @param {String} size - The dimenstions of the slot\n     * @private\n     */\n    buildCreative: function (slot, size) {\n      return '<script type=\"text/javascript\" src=\"//cdn.yldbt.com/js/yieldbot.intent.js\"></script>' +\n        '<script type=\"text/javascript\">var ybotq = ybotq || [];' +\n        'ybotq.push(function () {yieldbot.renderAd(\\'' + slot + ':' + size + '\\');});</script>';\n    },\n    /**\n     * Bid response builder.\n     *\n     * @param {Object} slotCriteria  - Yieldbot bid criteria\n     * @private\n     */\n    buildBid: function (slotCriteria) {\n      var bid = {};\n\n      if (slotCriteria && slotCriteria.ybot_ad && slotCriteria.ybot_ad !== 'n') {\n\n        bid = bidfactory.createBid(ybotlib.BID_STATUS.AVAILABLE);\n\n        bid.cpm = parseInt(slotCriteria.ybot_cpm) / 100.0 || 0; // Yieldbot CPM bids are in cents\n\n        var szArr = slotCriteria.ybot_size ? slotCriteria.ybot_size.split('x') : [0, 0];\n        var slot = slotCriteria.ybot_slot || '';\n        var sizeStr = slotCriteria.ybot_size || ''; // Creative template needs the dimensions string\n\n        bid.width = szArr[0] || 0;\n        bid.height = szArr[1] || 0;\n\n        bid.ad = ybotlib.buildCreative(slot, sizeStr);\n\n        // Add Yieldbot parameters to allow publisher bidderSettings.yieldbot specific targeting\n        for (var k in slotCriteria) {\n          bid[k] = slotCriteria[k];\n        }\n\n      } else {\n        bid = bidfactory.createBid(ybotlib.BID_STATUS.EMPTY);\n      }\n\n      bid.bidderCode = 'yieldbot';\n      return bid;\n    },\n    /**\n     * Yieldbot implementation of {@link module:adaptermanger.callBids}\n     * @param {Object} params - Adapter bid configuration object\n     * @private\n     */\n    callBids: function (params) {\n\n      var bids = params.bids || [];\n      var ybotq = window.ybotq || [];\n\n      ybotlib.pageLevelOption = false;\n\n      ybotq.push(function () {\n        var yieldbot = window.yieldbot;\n\n        ybotlib.definedSlots = [];\n        utils._each(bids, function (v) {\n          var bid = v;\n          var psn = bid.params && bid.params.psn || 'ERROR_DEFINE_YB_PSN';\n          var slot = bid.params && bid.params.slot || 'ERROR_DEFINE_YB_SLOT';\n\n          yieldbot.pub(psn);\n          yieldbot.defineSlot(slot, { sizes: bid.sizes || [] });\n          ybotlib.definedSlots.push(bid.bidId);\n        });\n        yieldbot.enableAsync();\n        if (yieldbot._initialized !== true) {\n          yieldbot.go();\n        } else {\n          yieldbot.nextPageview();\n        }\n      });\n      ybotq.push(function () {\n        ybotlib.handleUpdateState();\n      });\n      adloader.loadScript('//cdn.yldbt.com/js/yieldbot.intent.js', null, true);\n    },\n    /**\n     * Yieldbot bid request callback handler.\n     *\n     * @see {@link YieldbotAdapter~_callBids}\n     * @private\n     */\n    handleUpdateState: function () {\n      var yieldbot = window.yieldbot;\n      utils._each(ybotlib.definedSlots, function (v) {\n        var ybRequest;\n        var adapterConfig;\n\n        ybRequest = pbjs._bidsRequested\n                      .find(bidderRequest => bidderRequest.bidderCode === 'yieldbot');\n\n        adapterConfig = ybRequest && ybRequest.bids ? ybRequest.bids.find(bid => bid.bidId === v) : null;\n\n        if (adapterConfig && adapterConfig.params && adapterConfig.params.slot) {\n          var placementCode = adapterConfig.placementCode || 'ERROR_YB_NO_PLACEMENT';\n          var criteria = yieldbot.getSlotCriteria(adapterConfig.params.slot);\n          var bid = ybotlib.buildBid(criteria);\n\n          bidmanager.addBidResponse(placementCode, bid);\n        }\n      });\n    }\n  };\n  return {\n    callBids: ybotlib.callBids\n  };\n};\n\nmodule.exports = YieldbotAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/yieldbot.js","var CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\nvar defaultPlacementForBadBid = null;\n\n/**\n * Adapter for requesting bids from NginAd\n */\nvar NginAdAdapter = function NginAdAdapter() {\n\n  var rtbServerDomain = 'placeholder.for.nginad.server.com';\n\n  function _callBids(params) {\n    var nginadBids = params.bids || [];\n\n    // De-dupe by tagid then issue single bid request for all bids\n    _requestBids(_getUniqueTagids(nginadBids));\n  }\n\n  // filter bids to de-dupe them?\n  function _getUniqueTagids(bids) {\n    var key;\n    var map = {};\n    var PubZoneIds = [];\n\n    for (key in bids) {\n      map[utils.getBidIdParameter('pzoneid', bids[key].params)] = bids[key];\n    }\n\n    for (key in map) {\n      if (map.hasOwnProperty(key)) {\n        PubZoneIds.push(map[key]);\n      }\n    }\n\n    return PubZoneIds;\n  }\n\n  function getWidthAndHeight(bid) {\n\n    var adW = null;\n    var adH = null;\n\n    var sizeArrayLength = bid.sizes.length;\n    if (sizeArrayLength === 2 && typeof bid.sizes[0] === 'number' && typeof bid.sizes[1] === 'number') {\n      adW = bid.sizes[0];\n      adH = bid.sizes[1];\n    } else {\n      adW = bid.sizes[0][0];\n      adH = bid.sizes[0][1];\n    }\n\n    return [adW, adH];\n  }\n\n  function _requestBids(bidReqs) {\n    // build bid request object\n    var domain = window.location.host;\n    var page = window.location.pathname + location.search + location.hash;\n\n    var nginadImps = [];\n\n    //assign the first adUnit (placement) for bad bids;\n    defaultPlacementForBadBid = bidReqs[0].placementCode;\n\n\n    //build impression array for nginad\n    utils._each(bidReqs, function(bid) {\n      var tagId = utils.getBidIdParameter('pzoneid', bid.params);\n      var bidFloor = utils.getBidIdParameter('bidfloor', bid.params);\n\n      var whArr = getWidthAndHeight(bid);\n\n      var imp = {\n        id: bid.bidId,\n        banner: {\n          w: whArr[0],\n          h: whArr[1]\n        },\n        tagid: tagId,\n        bidfloor: bidFloor\n      };\n\n      nginadImps.push(imp);\n      //bidmanager.pbCallbackMap[imp.id] = bid;\n\n      rtbServerDomain = bid.params.nginadDomain;\n\n    });\n\n    // build bid request with impressions\n    var nginadBidReq = {\n      id: utils.getUniqueIdentifierStr(),\n      imp: nginadImps,\n      site: {\n        domain: domain,\n        page: page\n      }\n    };\n\n    var scriptUrl = window.location.protocol + '//' + rtbServerDomain + '/bid/rtb?callback=window.pbjs.nginadResponse' +\n      '&br=' + encodeURIComponent(JSON.stringify(nginadBidReq));\n\n    adloader.loadScript(scriptUrl);\n  }\n\n  function handleErrorResponse(bidReqs, defaultPlacementForBadBid) {\n    //no response data\n    if (defaultPlacementForBadBid === null) {\n      // no id with which to create an dummy bid\n      return;\n    }\n\n    var bid = bidfactory.createBid(2);\n    bid.bidderCode = 'nginad';\n    bidmanager.addBidResponse(defaultPlacementForBadBid, bid);\n  }\n\n  //expose the callback to the global object:\n  pbjs.nginadResponse = function(nginadResponseObj) {\n    var bid = {};\n    var key;\n\n    // valid object?\n    if (!nginadResponseObj || !nginadResponseObj.id) {\n      return handleErrorResponse(nginadResponseObj, defaultPlacementForBadBid);\n    }\n\n    if (!nginadResponseObj.seatbid || nginadResponseObj.seatbid.length === 0 || !nginadResponseObj.seatbid[0].bid || nginadResponseObj.seatbid[0].bid.length === 0) {\n      return handleErrorResponse(nginadResponseObj, defaultPlacementForBadBid);\n    }\n\n    for (key in nginadResponseObj.seatbid[0].bid) {\n\n      var nginadBid = nginadResponseObj.seatbid[0].bid[key];\n\n      var responseCPM;\n      var placementCode = '';\n      var id = nginadBid.impid;\n\n      // try to fetch the bid request we sent NginAd\n      /*jshint -W083 */\n      var bidObj = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'nginad').bids\n        .find(bid => bid.bidId === id);\n      if (!bidObj) {\n        return handleErrorResponse(nginadBid, defaultPlacementForBadBid);\n      }\n\n      placementCode = bidObj.placementCode;\n      bidObj.status = CONSTANTS.STATUS.GOOD;\n\n      //place ad response on bidmanager._adResponsesByBidderId\n      responseCPM = parseFloat(nginadBid.price);\n\n      if (responseCPM === 0) {\n        handleErrorResponse(nginadBid, id);\n      }\n\n      nginadBid.placementCode = placementCode;\n      nginadBid.size = bidObj.sizes;\n      var responseAd = nginadBid.adm;\n\n      //store bid response\n      //bid status is good (indicating 1)\n      bid = bidfactory.createBid(1);\n      bid.creative_id = nginadBid.Id;\n      bid.bidderCode = 'nginad';\n      bid.cpm = responseCPM;\n\n      //The bid is a mock bid, the true bidding process happens after the publisher tag is called\n      bid.ad = decodeURIComponent(responseAd);\n\n      var whArr = getWidthAndHeight(bidObj);\n      bid.width = whArr[0];\n      bid.height = whArr[1];\n\n      bidmanager.addBidResponse(placementCode, bid);\n\n    }\n\n  }; // nginadResponse\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = NginAdAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/nginad.js","var CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\n/**\n * Adapter for requesting bids from Brightcom\n */\nvar BrightcomAdapter = function BrightcomAdapter() {\n\n  // Set Brightcom Bidder URL\n  var brightcomUrl = 'hb.iselephant.com/auc/ortb';\n\n  // Define the bidder code\n  var brightcomBidderCode = 'brightcom';\n\n  // Define the callback function\n  var brightcomCallbackFunction = 'window.pbjs=window.pbjs||window.parent.pbjs||window.top.pbjs;window.pbjs.brightcomResponse';\n\n  // Manage the requested and received ad units' codes, to know which are invalid (didn't return)\n  var reqAdUnitsCode = [],\n      resAdUnitsCode = [];\n\n  function _callBids(params) {\n\n    var bidRequests = params.bids || [];\n\n    // Get page data\n    var siteDomain = window.location.host;\n    var sitePage = window.location.href;\n\n    // Prepare impressions object\n    var brightcomImps = [];\n\n    // Prepare a variable for publisher id\n    var pubId = '';\n\n    // Go through the requests and build array of impressions\n    utils._each(bidRequests, function(bid) {\n\n      // Get impression details\n      var tagId = utils.getBidIdParameter('tagId', bid.params);\n      var ref = utils.getBidIdParameter('ref', bid.params);\n      var adWidth=0;\n      var adHeight=0;\n\n      // If no publisher id is set, use the current\n      if (pubId === '') {\n        // Get the current publisher id (if it doesn't exist, it'll return '')\n        pubId = utils.getBidIdParameter('pubId', bid.params);\n      }\n\n      // Brightcom supports only 1 size per impression\n      // Check if the array contains 1 size or array of sizes\n      if (bid.sizes.length === 2 && typeof bid.sizes[0] === 'number' && typeof bid.sizes[1] === 'number') {\n        // The array contains 1 size (the items are the values)\n        adWidth = bid.sizes[0];\n        adHeight = bid.sizes[1];\n      } else {\n        // The array contains array of sizes, use the first size\n        adWidth = bid.sizes[0][0];\n        adHeight = bid.sizes[0][1];\n      }\n\n      // Build the impression\n      var imp = {\n        id: utils.getUniqueIdentifierStr(),\n        banner: {\n          w: adWidth,\n          h: adHeight\n        },\n        tagid: tagId\n      };\n\n      // If ref exists, create it (in the \"ext\" object)\n      if (ref !== '') {\n        imp.ext = {\n          refoverride: ref\n        };\n      }\n\n      // Add current impression to collection\n      brightcomImps.push(imp);\n      // Add mapping to current bid via impression id\n      //bidmanager.pbCallbackMap[imp.id] = bid;\n\n      // Add current ad unit's code to tracking\n      reqAdUnitsCode.push(bid.placementCode);\n\n    });\n\n    // Build the bid request\n    var brightcomBidReq = {\n      id: utils.getUniqueIdentifierStr(),\n      imp: brightcomImps,\n      site:{\n        publisher: {\n          id: pubId\n        },\n        domain: siteDomain,\n        page: sitePage\n      }\n    };\n\n    // Add timeout data, if available\n    var PREBID_TIMEOUT = PREBID_TIMEOUT || 0;\n    var curTimeout = PREBID_TIMEOUT;\n    if (curTimeout > 0) {\n      brightcomBidReq.tmax = curTimeout;\n    }\n\n    // Define the bid request call URL\n    var bidRequestCallUrl = 'https://' + brightcomUrl +\n        '?callback=' + encodeURIComponent(brightcomCallbackFunction) +\n        '&request=' + encodeURIComponent(JSON.stringify(brightcomBidReq));\n\n    // Add the call to get the bid\n    adloader.loadScript(bidRequestCallUrl);\n  }\n\n  //expose the callback to the global object:\n  pbjs.brightcomResponse = function(brightcomResponseObj) {\n\n    var bid = {};\n\n    // Make sure response is valid\n    if (\n        (brightcomResponseObj) && (brightcomResponseObj.id) &&\n        (brightcomResponseObj.seatbid) && (brightcomResponseObj.seatbid.length !== 0) &&\n        (brightcomResponseObj.seatbid[0].bid) && (brightcomResponseObj.seatbid[0].bid.length !== 0)\n    ) {\n\n      // Go through the received bids\n      brightcomResponseObj.seatbid[0].bid.forEach( function(curBid) {\n\n        // Get the bid request data\n        var bidRequest = pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === 'brightcom').bids[0]; // this assumes a single request only\n\n        // Make sure the bid exists\n        if (bidRequest) {\n\n          var placementCode = bidRequest.placementCode;\n          bidRequest.status = CONSTANTS.STATUS.GOOD;\n\n          curBid.placementCode = placementCode;\n          curBid.size = bidRequest.sizes;\n\n          // Get the creative\n          var responseCreative = curBid.adm;\n          // Build the NURL element\n          var responseNurl = '<img src=\"' + curBid.nurl + '\" width=\"1\" height=\"1\" style=\"display:none\" />';\n          // Build the ad to display:\n          var responseAd = decodeURIComponent(responseCreative + responseNurl);\n\n          // Create a valid bid\n          bid = bidfactory.createBid(1);\n\n          // Set the bid data\n          bid.creative_id = curBid.Id;\n          bid.bidderCode = brightcomBidderCode;\n          bid.cpm = parseFloat(curBid.price);\n\n          // Brightcom tag is in <script> block, so use bid.ad, not bid.adurl\n          bid.ad = responseAd;\n\n          // Since Brightcom currently supports only 1 size, if multiple sizes are provided - take the first\n          var adWidth, adHeight;\n          if ((bidRequest.sizes.length === 2) && (typeof bidRequest.sizes[0] === 'number') && (typeof bidRequest.sizes[1] === 'number')) {\n            // Only one size is provided\n            adWidth = bidRequest.sizes[0];\n            adHeight = bidRequest.sizes[1];\n          } else {\n            // And array of sizes is provided. Take the first.\n            adWidth = bidRequest.sizes[0][0];\n            adHeight = bidRequest.sizes[0][1];\n          }\n\n          // Set the ad's width and height\n          bid.width = adWidth;\n          bid.height = adHeight;\n\n          // Add the bid\n          bidmanager.addBidResponse(placementCode, bid);\n\n          // Add current ad unit's code to tracking\n          resAdUnitsCode.push(placementCode);\n\n        }\n      });\n\n    }\n\n    // Define all unreceived ad unit codes as invalid (if Brightcom don't want to bid on an impression, it won't include it in the response)\n    for (var i = 0; i < reqAdUnitsCode.length; i++) {\n      var adUnitCode = reqAdUnitsCode[i];\n      // Check if current ad unit code was NOT received\n      if (resAdUnitsCode.indexOf(adUnitCode) === -1) {\n        // Current ad unit wasn't returned. Define it as invalid.\n        bid = bidfactory.createBid(2);\n        bid.bidderCode = brightcomBidderCode;\n        bidmanager.addBidResponse(adUnitCode, bid);\n      }\n    }\n\n  };\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = BrightcomAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/brightcom.js","var bidfactory = require('../bidfactory.js'),\n    bidmanager = require('../bidmanager.js'),\n    utils = require('../utils.js'),\n    adloader = require('../adloader');\n\nvar WideOrbitAdapter = function WideOrbitAdapter() {\n  var pageImpression = 'JSAdservingMP.ashx?pc={pc}&pbId={pbId}&clk=&exm=&jsv=1.0&tsv=1.0&cts={cts}&arp=0&fl=0&vitp=&vit=&jscb=window.pbjs.handleWideOrbitCallback&url={referrer}&fp=&oid=&exr=&mraid=&apid=&apbndl=&mpp=0&uid=&cb={cb}&hb=1',\n      pageRepeatCommonParam = '&gid{o}={gid}&pp{o}=&clk{o}=&rpos{o}={rpos}&ecpm{o}={ecpm}&ntv{o}=&ntl{o}=&adsid{o}=',\n      pageRepeatParamId = '&pId{o}={pId}&rank{o}={rank}',\n      pageRepeatParamNamed = '&wsName{o}={wsName}&wName{o}={wName}&rank{o}={rank}&bfDim{o}={width}x{height}&subp{o}={subp}',\n      base = (window.location.protocol) + '//p{pbId}.atemda.com/',\n      bids,\n      adapterName = 'wideorbit';\n\n  function _fixParamNames(param) {\n    if (!param) {\n      return;\n    }\n\n    var properties = ['site', 'page', 'width', 'height', 'rank', 'subPublisher', 'ecpm', 'atf', 'pId', 'pbId', 'referrer'],\n        prop;\n\n    utils._each(properties, function (correctName) {\n      for (prop in param) {\n        if (param.hasOwnProperty(prop) && prop.toLowerCase() === correctName.toLowerCase()) {\n          param[correctName] = param[prop];\n          break;\n        }\n      }\n    });\n  }\n\n  function _setParam(str, param, value) {\n    var pattern = new RegExp('{' + param + '}', 'g');\n\n    if (value === true) {\n      value = 1;\n    }\n    if (value === false) {\n      value = 0;\n    }\n    return str.replace(pattern, value);\n  }\n\n  function _setParams(str, keyValuePairs) {\n    utils._each(keyValuePairs, function (keyValuePair) {\n      str = _setParam(str, keyValuePair[0], keyValuePair[1]);\n    });\n    return str;\n  }\n\n  function _setCommonParams(pos, params) {\n    return _setParams(pageRepeatCommonParam, [\n      ['o', pos],\n      ['gid', encodeURIComponent(params.tagId)],\n      ['rpos', params.atf ? 1001 : 0],\n      ['ecpm', params.ecpm || '']\n    ]);\n  }\n\n  function _getRankParam(rank, pos) {\n    return rank || pos;\n  }\n\n  function _setupIdPlacementParameters(pos, params) {\n    return _setParams(pageRepeatParamId, [\n      ['o', pos],\n      ['pId', params.pId],\n      ['rank', _getRankParam(params.rank, pos)]\n    ]);\n  }\n\n  function _setupNamedPlacementParameters(pos, params) {\n    return _setParams(pageRepeatParamNamed, [\n      ['o', pos],\n      ['wsName', encodeURIComponent(decodeURIComponent(params.site))],\n      ['wName', encodeURIComponent(decodeURIComponent(params.page))],\n      ['width', params.width],\n      ['height', params.height],\n      ['subp', params.subPublisher ? encodeURIComponent(decodeURIComponent(params.subPublisher)) : ''],\n      ['rank', _getRankParam(params.rank, pos)]\n    ]);\n  }\n\n  function _setupAdCall(publisherId, placementCount, placementsComponent, referrer) {\n    return _setParams(base + pageImpression, [\n      ['pbId', publisherId],\n      ['pc', placementCount],\n      ['cts', new Date().getTime()],\n      ['cb', Math.floor(Math.random() * 100000000)],\n      ['referrer', encodeURIComponent(referrer || '')]\n    ]) + placementsComponent;\n  }\n\n  function _setupPlacementParameters(pos, params) {\n    var commonParams = _setCommonParams(pos, params);\n\n    if (params.pId) {\n      return _setupIdPlacementParameters(pos, params) + commonParams;\n    }\n\n    return _setupNamedPlacementParameters(pos, params) + commonParams;\n  }\n\n  function _callBids(params) {\n    var publisherId,\n      bidUrl = '',\n      i, referrer;\n\n    bids = params.bids || [];\n\n    for (i = 0; i < bids.length; i++) {\n      var requestParams = bids[i].params;\n\n      requestParams.tagId = bids[i].placementCode;\n\n      _fixParamNames(requestParams);\n\n      publisherId = requestParams.pbId;\n      referrer = referrer || requestParams.referrer;\n      bidUrl += _setupPlacementParameters(i, requestParams);\n    }\n\n    bidUrl = _setupAdCall(publisherId, bids.length, bidUrl, referrer);\n\n    utils.logMessage('Calling WO: ' + bidUrl);\n\n    adloader.loadScript(bidUrl);\n  }\n\n  function _processUserMatchings(userMatchings) {\n    var headElem = document.getElementsByTagName('head')[0],\n        createdElem;\n\n    utils._each(userMatchings, function (userMatching) {\n      createdElem = undefined;\n      switch (userMatching.Type) {\n        case 'redirect':\n          createdElem = document.createElement('img');\n          break;\n        case 'iframe':\n          createdElem = utils.createInvisibleIframe();\n          break;\n        case 'js':\n          createdElem = document.createElement('script');\n          createdElem.type = 'text/javascript';\n          createdElem.async = true;\n          break;\n      }\n      if (createdElem) {\n        createdElem.src = decodeURIComponent(userMatching.Url);\n        headElem.insertBefore(createdElem, headElem.firstChild);\n      }\n    });\n  }\n\n  function _getBidResponse(id, placements) {\n    var i;\n\n    for (i = 0; i < placements.length; i++) {\n      if (placements[i].ExtPlacementId === id) {\n        return placements[i];\n      }\n    }\n  }\n\n  function _isUrl(scr) {\n    return scr.slice(0, 6) === \"http:/\" || scr.slice(0, 7) === \"https:/\" || scr.slice(0, 2) === \"//\";\n  }\n\n  function _buildAdCode(placement) {\n    var adCode = placement.Source, pixelTag;\n\n    utils._each(placement.TrackingCodes, function (trackingCode) {\n      if (_isUrl(trackingCode)) {\n        pixelTag = '<img src=\"' + trackingCode + '\" width=\"0\" height=\"0\" style=\"position:absolute\"></img>';\n      } else {\n        pixelTag = trackingCode;\n      }\n      adCode = pixelTag + adCode;\n    });\n\n    return adCode;\n  }\n\n  window.pbjs = window.pbjs || {};\n  window.pbjs.handleWideOrbitCallback = function (response) {\n    var bidResponse,\n      bidObject;\n\n    utils.logMessage('WO response. Placements: ' + response.Placements.length);\n\n    _processUserMatchings(response.UserMatchings);\n\n    utils._each(bids, function (bid) {\n      bidResponse = _getBidResponse(bid.placementCode, response.Placements);\n\n      if (bidResponse && bidResponse.Type === 'DirectHTML') {\n        bidObject = bidfactory.createBid(1);\n        bidObject.cpm = bidResponse.Bid;\n        bidObject.ad = _buildAdCode(bidResponse);\n        bidObject.width = bidResponse.Width;\n        bidObject.height = bidResponse.Height;\n      } else {\n        bidObject = bidfactory.createBid(2);\n      }\n\n      bidObject.bidderCode = adapterName;\n      bidmanager.addBidResponse(bid.placementCode, bidObject);\n    });\n  };\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = WideOrbitAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/wideorbit.js","var bidfactory = require('src/bidfactory.js');\nvar bidmanager = require('src/bidmanager.js');\nvar adloader = require('src/adloader.js');\nvar utils = require('src/utils.js');\n\n\nvar JCMAdapter = function JCMAdapter() {\n\n  window.pbjs = window.pbjs || {};\n  window.pbjs.processJCMResponse = function(JCMResponse) {\n    if (JCMResponse) {\n      var JCMRespObj = JSON.parse(JCMResponse);\n      if (JCMRespObj) {\n        var bids = JCMRespObj.bids;\n        for (var i = 0; i < bids.length; i++) {\n          var bid = bids[i];\n          var bidObject;\n          if (bid.cpm > 0) {\n            bidObject = bidfactory.createBid(1);\n            bidObject.bidderCode = 'jcm';\n            bidObject.cpm = bid.cpm;\n            bidObject.ad = decodeURIComponent(bid.ad.replace(/\\+/g, '%20'));\n            bidObject.width = bid.width;\n            bidObject.height = bid.height;\n            bidmanager.addBidResponse(utils.getBidRequest(bid.callbackId).placementCode, bidObject);\n          }\n          else {\n            bidObject = bidfactory.createBid(2);\n            bidObject.bidderCode = 'jcm';\n            bidmanager.addBidResponse(utils.getBidRequest(bid.callbackId).placementCode, bidObject);\n          }\n        }\n      }\n    }\n  };\n\n  function _callBids(params) {\n\n    var BidRequest = {\n      bids: []\n    };\n\n    for (var i = 0; i < params.bids.length; i++) {\n\n      var adSizes = \"\";\n      var bid = params.bids[i];\n      for (var x = 0; x < bid.sizes.length; x++) {\n        adSizes += utils.parseGPTSingleSizeArray(bid.sizes[x]);\n        if (x !== (bid.sizes.length - 1)) {\n          adSizes += ',';\n        }\n      }\n\n\n      BidRequest.bids.push({\n        \"callbackId\"   : bid.bidId,\n        \"siteId\"       : bid.params.siteId,\n        \"adSizes\"\t   : adSizes\n      });\n    }\n\n    var JSONStr = JSON.stringify(BidRequest);\n    var reqURL = document.location.protocol+\"//media.adfrontiers.com/pq?t=hb&bids=\" + encodeURIComponent(JSONStr);\n    adloader.loadScript(reqURL);\n  }\n\n  return {\n    callBids: _callBids\n  };\n\n};\n\nmodule.exports = JCMAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/jcm.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\nvar utils = require('../utils.js');\n\nvar UnderdogMediaAdapter = function UnderdogMediaAdapter() {\n\n  const UDM_ADAPTER_VERSION = '1.0.0';\n  var getJsStaticUrl = window.location.protocol + '//udmserve.net/udm/img.fetch?tid=1;dt=9;callback=pbjs.handleUnderdogMediaCB;';\n  var bidParams = {};\n\n  function _callBids(params) {\n    bidParams = params;\n    var sizes = [];\n    var siteId = 0;\n\n    bidParams.bids.forEach(bidParam => {\n      sizes = utils.flatten(sizes, utils.parseSizesInput(bidParam.sizes));\n      siteId = bidParam.params.siteId;\n    });\n    adloader.loadScript(getJsStaticUrl + \"sid=\" + siteId + \";sizes=\" + sizes.join(\",\"), null, false);\n  }\n\n  function _callback(response) {\n\n    var mids = response.mids;\n    bidParams.bids.forEach(bidParam => {\n\n      var filled = false;\n      mids.forEach(mid => {\n\n        if (mid.useCount > 0) {\n          return;\n        }\n        if (!mid.useCount) {\n          mid.useCount = 0;\n        }\n        var size_not_found = true;\n        utils.parseSizesInput(bidParam.sizes).forEach(size => {\n          if (size === mid.width + 'x' + mid.height) {\n            size_not_found = false;\n          }\n        });\n        if (size_not_found) {\n          return;\n        }\n\n        var bid = bidfactory.createBid(1, bidParam);\n        bid.bidderCode = bidParam.bidder;\n        bid.width = mid.width;\n        bid.height = mid.height;\n\n        bid.cpm = parseFloat(mid.cpm);\n        if (bid.cpm <= 0) {\n          return;\n        }\n        mid.useCount++;\n        bid.ad = mid.ad_code_html;\n        bid.ad = _makeNotification(bid, mid, bidParam) + bid.ad;\n        if (!(bid.ad || bid.adUrl)) {\n          return;\n        }\n        bidmanager.addBidResponse(bidParam.placementCode, bid);\n        filled = true;\n      });\n      if (!filled) {\n        var nobid = bidfactory.createBid(2, bidParam);\n        nobid.bidderCode = bidParam.bidder;\n        bidmanager.addBidResponse(bidParam.placementCode, nobid);\n      }\n    });\n  }\n\n  pbjs.handleUnderdogMediaCB = _callback;\n\n  function _makeNotification(bid, mid, bidParam) {\n\n    var url = mid.notification_url;\n\n    url += UDM_ADAPTER_VERSION;\n    url += \";cb=\" + Math.random();\n    url += \";qqq=\" + (1 / bid.cpm);\n    url += \";hbt=\" + pbjs.bidderTimeout;\n    url += ';style=adapter';\n    url += ';vis=' + encodeURIComponent(document.visibilityState);\n\n    url += ';traffic_info=' + encodeURIComponent(JSON.stringify(_getUrlVars()));\n    if (bidParam.params.subId) {\n      url += ';subid=' + encodeURIComponent(bidParam.params.subId);\n    }\n    return \"<script async src=\\\"\" + url + \"\\\"></script>\";\n  }\n\n  function _getUrlVars() {\n    var vars = {};\n    var hash;\n    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');\n    for (var i = 0; i < hashes.length; i++) {\n      hash = hashes[i].split('=');\n      if (!hash[0].match(/^utm/)) {\n        continue;\n      }\n      vars[hash[0]] = hash[1].substr(0, 150);\n    }\n    return vars;\n  }\n\n\n  return {\n    callBids: _callBids\n  };\n\n};\n\nmodule.exports = UnderdogMediaAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/underdogmedia.js","var CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\nvar defaultPlacementForBadBid = null;\nvar bidderName = 'memeglobal';\n/**\n * Adapter for requesting bids from Meme Global Media Group\n * OpenRTB compatible\n */\nvar MemeGlobalAdapter = function MemeGlobalAdapter() {\n  var bidder = 'stinger.memeglobal.com/api/v1/services/prebid';\n\n  function _callBids(params) {\n    var bids = params.bids;\n\n    if (!bids) return;\n\n    // assign the first adUnit (placement) for bad bids;\n    defaultPlacementForBadBid = bids[0].placementCode;\n\n    for (var i = 0; i < bids.length; i++) {\n      _requestBid(bids[i]);\n    }\n  }\n\n  function _requestBid(bidReq) {\n    // build bid request object\n    var domain = window.location.host;\n    var page = window.location.host + window.location.pathname + location.search + location.hash;\n\n    var tagId = utils.getBidIdParameter('tagid', bidReq.params);\n    var bidFloor = Number(utils.getBidIdParameter('bidfloor', bidReq.params));\n    var adW = 0;\n    var adH = 0;\n\n    var bidSizes = Array.isArray(bidReq.params.sizes) ? bidReq.params.sizes : bidReq.sizes;\n    var sizeArrayLength = bidSizes.length;\n    if (sizeArrayLength === 2 && typeof bidSizes[0] === 'number' && typeof bidSizes[1] === 'number') {\n      adW = bidSizes[0];\n      adH = bidSizes[1];\n    } else {\n      adW = bidSizes[0][0];\n      adH = bidSizes[0][1];\n    }\n\n    // build bid request with impressions\n    var bidRequest = {\n      id: utils.getUniqueIdentifierStr(),\n      imp: [{\n        id: bidReq.bidId,\n        banner: {\n          w: adW,\n          h: adH\n        },\n        tagid: bidReq.placementCode,\n        bidfloor: bidFloor\n      }],\n      site: {\n        domain: domain,\n        page: page,\n        publisher: {\n          id: tagId\n        }\n      }\n    };\n\n    var scriptUrl = '//' + bidder + '?callback=window.pbjs.mgres' +\n      '&src=' + CONSTANTS.REPO_AND_VERSION +\n      '&br=' + encodeURIComponent(JSON.stringify(bidRequest));\n    adloader.loadScript(scriptUrl);\n  }\n\n  function getBidSetForBidder() {\n    return pbjs._bidsRequested.find(bidSet => bidSet.bidderCode === bidderName);\n  }\n\n  // expose the callback to the global object:\n  pbjs.mgres = function (bidResp) {\n\n    // valid object?\n    if ((!bidResp || !bidResp.id) ||\n      (!bidResp.seatbid || bidResp.seatbid.length === 0 || !bidResp.seatbid[0].bid || bidResp.seatbid[0].bid.length === 0)) {\n      return ;\n    }\n\n    bidResp.seatbid[0].bid.forEach(function (bidderBid) {\n      var responseCPM;\n      var placementCode = '';\n\n      var bidSet = getBidSetForBidder();\n      var bidRequested = bidSet.bids.find(b => b.bidId === bidderBid.impid);\n      if (bidRequested) {\n        var bidResponse = bidfactory.createBid(1);\n        placementCode = bidRequested.placementCode;\n        bidRequested.status = CONSTANTS.STATUS.GOOD;\n        responseCPM = parseFloat(bidderBid.price);\n        if (responseCPM === 0) {\n          var bid = bidfactory.createBid(2);\n          bid.bidderCode = bidderName;\n          bidmanager.addBidResponse(placementCode, bid);\n          return;\n        }\n        bidResponse.placementCode = placementCode;\n        bidResponse.size = bidRequested.sizes;\n        var responseAd = bidderBid.adm;\n        var responseNurl = '<img src=\"' + bidderBid.nurl + '\" height=\"0px\" width=\"0px\" style=\"display: none;\">';\n        bidResponse.creative_id = bidderBid.id;\n        bidResponse.bidderCode = bidderName;\n        bidResponse.cpm = responseCPM;\n        bidResponse.ad = decodeURIComponent(responseAd + responseNurl);\n        bidResponse.width = parseInt(bidderBid.w);\n        bidResponse.height = parseInt(bidderBid.h);\n        bidmanager.addBidResponse(placementCode, bidResponse);\n      }\n    });\n  };\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = MemeGlobalAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/memeglobal.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\nvar CriteoAdapter = function CriteoAdapter() {\n\n  var _publisherTagUrl = window.location.protocol + '//static.criteo.net/js/ld/publishertag.js';\n  var _bidderCode = 'criteo';\n  var _profileId = 125;\n\n  function _callBids(params) {\n    if (!window.criteo_pubtag || window.criteo_pubtag instanceof Array) {\n      // publisherTag not loaded yet\n\n      _pushBidRequestEvent(params);\n      adloader.loadScript(\n        _publisherTagUrl,\n        function () {},\n        true\n      );\n    }\n    else {\n      // publisherTag already loaded\n      _pushBidRequestEvent(params);\n    }\n  }\n\n  // send bid request to criteo direct bidder handler\n  function _pushBidRequestEvent(params) {\n\n    // if we want to be fully asynchronous, we must first check window.criteo_pubtag in case publishertag.js is not loaded yet.\n    window.Criteo = window.Criteo || {};\n    window.Criteo.events = window.Criteo.events || [];\n\n    // generate the bidding event\n    var biddingEventFunc = function () {\n\n      var bids = params.bids || [];\n\n      var slots = [];\n\n      var isAudit = false;\n\n      // build slots before sending one multi-slots bid request\n      for (var i = 0; i < bids.length; i++) {\n        var bid = bids[i];\n        slots.push(\n          new Criteo.PubTag.DirectBidding.DirectBiddingSlot(\n            bid.placementCode,\n            bid.params.zoneId,\n            undefined,\n            bid.transactionId\n          )\n        );\n\n        isAudit |= bid.params.audit !== undefined;\n      }\n\n      var biddingEvent = new Criteo.PubTag.DirectBidding.DirectBiddingEvent(\n        _profileId,\n        new Criteo.PubTag.DirectBidding.DirectBiddingUrlBuilder(isAudit),\n        slots,\n        _callbackSuccess(slots),\n        _callbackError(slots),\n        _callbackError(slots) // timeout handled as error\n      );\n\n      // process the event as soon as possible\n      window.criteo_pubtag.push(biddingEvent);\n    };\n\n    window.Criteo.events.push(biddingEventFunc);\n\n  }\n\n  function parseBidResponse(bidsResponse) {\n    try {\n      return JSON.parse(bidsResponse);\n    }\n    catch (error) {\n      return {};\n    }\n  }\n\n  function isNoBidResponse(jsonbidsResponse) {\n    return jsonbidsResponse.slots === undefined;\n  }\n\n  function _callbackSuccess(slots) {\n    return function (bidsResponse) {\n      var jsonbidsResponse = parseBidResponse(bidsResponse);\n\n      if (isNoBidResponse(jsonbidsResponse))\n        return _callbackError(slots)();\n\n      for (var i = 0; i < slots.length; i++) {\n        var bidResponse = null;\n\n        // look for the matching bid response\n        for (var j = 0; j < jsonbidsResponse.slots.length; j++) {\n          if (jsonbidsResponse.slots[j] && jsonbidsResponse.slots[j].impid === slots[i].impId) {\n            bidResponse = jsonbidsResponse.slots.splice(j, 1)[0];\n            break;\n          }\n        }\n\n        // register the bid response\n        var bidObject;\n        if (bidResponse) {\n          bidObject = bidfactory.createBid(1);\n          bidObject.bidderCode = _bidderCode;\n          bidObject.cpm = bidResponse.cpm;\n          bidObject.ad = bidResponse.creative;\n          bidObject.width = bidResponse.width;\n          bidObject.height = bidResponse.height;\n        }\n        else {\n          bidObject = _invalidBidResponse();\n        }\n        bidmanager.addBidResponse(slots[i].impId, bidObject);\n      }\n    };\n  }\n\n  function _callbackError(slots) {\n    return function () {\n      for (var i = 0; i < slots.length; i++) {\n        bidmanager.addBidResponse(slots[i].impId, _invalidBidResponse());\n      }\n    };\n  }\n\n  function _invalidBidResponse() {\n    var bidObject = bidfactory.createBid(2);\n    bidObject.bidderCode = _bidderCode;\n    return bidObject;\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = CriteoAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/criteo.js","var utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\nvar CentroAdapter = function CentroAdapter() {\n  var baseUrl = '//t.brand-server.com/hb',\n      devUrl = '//staging.brand-server.com/hb',\n      bidderCode = 'centro',\n      handlerPrefix = 'adCentroHandler_',\n\n      LOG_ERROR_MESS = {\n        noUnit: 'Bid has no unit',\n        noAdTag: 'Bid has missmatch format.',\n        noBid: 'Response has no bid.',\n        anotherCode: 'Bid has another bidderCode - ',\n        undefBid: 'Bid is undefined',\n        unitNum: 'Requested unit is '\n      };\n\n  function _makeHandler(handlerName, unit, placementCode) {\n    return function(response){\n      try {\n        delete window[handlerName];\n      } catch(err) {//catching for old IE\n        window[handlerName] = undefined;\n      }\n      _responseProcessing(response, unit, placementCode);\n    };\n  }\n\n  function _sendBidRequest(bid) {\n    var placementCode = bid.placementCode,\n        size = bid.sizes && bid.sizes[0];\n\n    bid = bid.params;\n    if (!bid.unit) {\n      //throw exception, or call utils.logError\n      utils.logError(LOG_ERROR_MESS.noUnit, bidderCode);\n      return;\n    }\n    var query = ['s=' + bid.unit, 'adapter=prebid'];//,'url=www.abc15.com','sz=320x50'];\n    var isDev = bid.unit.toString() === '28136';\n\n    query.push('url=' + encodeURIComponent(bid.page_url || location.href));\n    //check size format\n    if (\n      size instanceof Array &&\n      size.length===2 &&\n      typeof size[0] === 'number' &&\n      typeof size[1] === 'number'\n    ) {\n      query.push('sz=' + size.join('x'));\n    }\n    //make handler name for JSONP request\n    var handlerName = handlerPrefix + bid.unit + size.join('x') + encodeURIComponent(placementCode);\n    query.push('callback=' + encodeURIComponent('window[\"' + handlerName + '\"]'));\n\n    //maybe is needed add some random parameter to disable cache\n    //query.push('r='+Math.round(Math.random() * 1e5));\n\n    window[handlerName] = _makeHandler(handlerName, bid.unit, placementCode);\n\n    adloader.loadScript((document.location.protocol === 'https:'? 'https:' : 'http:') + (isDev? devUrl : baseUrl) + '?' + query.join('&'));\n  }\n\n  /*\n   \"sectionID\": 7302,\n   \"height\": 250,\n   \"width\": 300,\n   \"value\": 3.2,\n   \"adTag\":''\n   */\n  function _responseProcessing(resp, unit, placementCode) {\n    var bidObject;\n    var bid = resp && resp.bid || resp;\n\n    if (bid && bid.adTag && bid.sectionID && bid.sectionID.toString() === unit.toString()) {\n      bidObject = bidfactory.createBid(1);\n      bidObject.cpm = bid.value;\n      bidObject.ad = bid.adTag;\n      bidObject.width = bid.width;\n      bidObject.height = bid.height;\n    } else {\n      //throw exception, or call utils.logError with resp.statusMessage\n      utils.logError(LOG_ERROR_MESS.unitNum + unit + '. ' + (bid? bid.statusMessage || LOG_ERROR_MESS.noAdTag : LOG_ERROR_MESS.noBid), bidderCode);\n      bidObject = bidfactory.createBid(2);\n    }\n    bidObject.bidderCode = bidderCode;\n    bidmanager.addBidResponse(placementCode, bidObject);\n  }\n\n  /*\n   {\n   bidderCode: \"centro\",\n   bids: [\n   {\n   unit:  '3242432',\n   page_url: \"http://\",\n   size: [300, 250]\n   */\n  function _callBids(params) {\n    var bid, bids = params.bids || [];\n    for (var i = 0; i < bids.length; i++) {\n      bid = bids[i];\n      if (bid && bid.bidder === bidderCode) {\n        _sendBidRequest(bid);\n      }\n    }\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\n\nmodule.exports = CentroAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/centro.js","import {getBidRequest} from '../utils.js';\n\nconst CONSTANTS = require('../constants.json');\nconst utils = require('../utils.js');\nconst adloader = require('../adloader.js');\nconst bidmanager = require('../bidmanager.js');\nconst bidfactory = require('../bidfactory.js');\n\nconst XhbAdapter = function XhbAdapter() {\n\n  const _defaultBidderSettings = {\n    alwaysUseBid: true,\n    adserverTargeting: [\n      {\n        key: 'hb_xhb_deal',\n        val: function (bidResponse) {\n          return bidResponse.dealId;\n        }\n      },\n      {\n        key: 'hb_xhb_adid',\n        val: function (bidResponse) {\n          return bidResponse.adId;\n        }\n      }\n    ]\n  };\n  bidmanager.registerDefaultBidderSetting('xhb', _defaultBidderSettings);\n\n  function buildJPTCall(bid, callbackId) {\n    //determine tag params\n    const placementId = utils.getBidIdParameter('placementId', bid.params);\n    const inventoryCode = utils.getBidIdParameter('invCode', bid.params);\n    let referrer = utils.getBidIdParameter('referrer', bid.params);\n    const altReferrer = utils.getBidIdParameter('alt_referrer', bid.params);\n\n    //Always use https\n    let jptCall = 'https://ib.adnxs.com/jpt?';\n\n    jptCall = utils.tryAppendQueryString(jptCall, 'callback', 'pbjs.handleXhbCB');\n    jptCall = utils.tryAppendQueryString(jptCall, 'callback_uid', callbackId);\n    jptCall = utils.tryAppendQueryString(jptCall, 'id', placementId);\n    jptCall = utils.tryAppendQueryString(jptCall, 'code', inventoryCode);\n\n    //sizes takes a bit more logic\n    let sizeQueryString = '';\n    let parsedSizes = utils.parseSizesInput(bid.sizes);\n\n    //combine string into proper querystring for impbus\n    let parsedSizesLength = parsedSizes.length;\n    if (parsedSizesLength > 0) {\n      //first value should be \"size\"\n      sizeQueryString = 'size=' + parsedSizes[0];\n      if (parsedSizesLength > 1) {\n        //any subsequent values should be \"promo_sizes\"\n        sizeQueryString += '&promo_sizes=';\n        for (let j = 1; j < parsedSizesLength; j++) {\n          sizeQueryString += parsedSizes[j] += ',';\n        }\n        //remove trailing comma\n        if (sizeQueryString && sizeQueryString.charAt(sizeQueryString.length - 1) === ',') {\n          sizeQueryString = sizeQueryString.slice(0, sizeQueryString.length - 1);\n        }\n      }\n    }\n\n    if (sizeQueryString) {\n      jptCall += sizeQueryString + '&';\n    }\n\n    //append custom attributes:\n    let paramsCopy = Object.assign({}, bid.params);\n\n    //delete attributes already used\n    delete paramsCopy.placementId;\n    delete paramsCopy.invCode;\n    delete paramsCopy.query;\n    delete paramsCopy.referrer;\n    delete paramsCopy.alt_referrer;\n\n    //get the reminder\n    let queryParams = utils.parseQueryStringParameters(paramsCopy);\n\n    //append\n    if (queryParams) {\n      jptCall += queryParams;\n    }\n\n    //append referrer\n    if (referrer === '') {\n      referrer = utils.getTopWindowUrl();\n    }\n\n    jptCall = utils.tryAppendQueryString(jptCall, 'referrer', referrer);\n    jptCall = utils.tryAppendQueryString(jptCall, 'alt_referrer', altReferrer);\n\n    //remove the trailing \"&\"\n    if (jptCall.lastIndexOf('&') === jptCall.length - 1) {\n      jptCall = jptCall.substring(0, jptCall.length - 1);\n    }\n\n    return jptCall;\n  }\n\n  //expose the callback to the global object:\n  pbjs.handleXhbCB = function (jptResponseObj) {\n      let bidCode;\n\n      if (jptResponseObj && jptResponseObj.callback_uid) {\n\n        let responseCPM;\n        let id = jptResponseObj.callback_uid;\n        let placementCode = '';\n        let bidObj = getBidRequest(id);\n        if (bidObj) {\n          bidCode = bidObj.bidder;\n          placementCode = bidObj.placementCode;\n          //set the status\n          bidObj.status = CONSTANTS.STATUS.GOOD;\n        }\n\n        let bid = [];\n        if (jptResponseObj.result && jptResponseObj.result.ad && jptResponseObj.result.ad !== '') {\n          responseCPM = 0.00;\n\n          //store bid response\n          //bid status is good (indicating 1)\n          let adId = jptResponseObj.result.creative_id;\n          bid = bidfactory.createBid(CONSTANTS.STATUS.GOOD, bidObj);\n          bid.creative_id = adId;\n          bid.bidderCode = bidCode;\n          bid.cpm = responseCPM;\n          bid.adUrl = jptResponseObj.result.ad;\n          bid.width = jptResponseObj.result.width;\n          bid.height = jptResponseObj.result.height;\n          bid.dealId = '99999999';\n\n          bidmanager.addBidResponse(placementCode, bid);\n\n        } else {\n          //no response data\n          //indicate that there is no bid for this placement\n          bid = bidfactory.createBid(2);\n          bid.bidderCode = bidCode;\n          bidmanager.addBidResponse(placementCode, bid);\n        }\n      }\n    };\n\n  function _callBids(params) {\n    let bids = params.bids || [];\n    for (let i = 0; i < bids.length; i++) {\n      let bid = bids[i];\n      let callbackId = bid.bidId;\n      adloader.loadScript(buildJPTCall(bid, callbackId));\n    }\n  }\n\n  // Export the callBids function, so that prebid.js can execute\n  // this function when the page asks to send out bid requests.\n  return {\n      callBids: _callBids\n    };\n};\n\nmodule.exports = XhbAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/xhb.js","var utils = require('../utils.js');\nvar bidmanager = require('../bidmanager.js');\nvar bidfactory = require('../bidfactory.js');\nvar ajax = require('../ajax.js').ajax;\n\nconst STR_BIDDER_CODE = \"sharethrough\";\nconst STR_VERSION = \"1.2.0\";\n\nvar SharethroughAdapter = function SharethroughAdapter() {\n\n  const str = {};\n  str.STR_BTLR_HOST = document.location.protocol + \"//btlr.sharethrough.com\";\n  str.STR_BEACON_HOST = document.location.protocol + \"//b.sharethrough.com/butler?\";\n  str.placementCodeSet = {};\n  str.ajax = ajax;\n\n  function _callBids(params) {\n    const bids = params.bids;\n\n    // cycle through bids\n    for (let i = 0; i < bids.length; i += 1) {\n      const bidRequest = bids[i];\n      str.placementCodeSet[bidRequest.placementCode] = bidRequest;\n      const scriptUrl = _buildSharethroughCall(bidRequest);\n      str.ajax(scriptUrl, _createCallback(bidRequest), undefined, {withCredentials: true});\n    }\n  }\n\n  function _createCallback(bidRequest) {\n    return (bidResponse) => {\n      _strcallback(bidRequest, bidResponse);\n    };\n  }\n\n  function _buildSharethroughCall(bid) {\n    const pkey = utils.getBidIdParameter('pkey', bid.params);\n\n    let host = str.STR_BTLR_HOST;\n\n    let url = host + \"/header-bid/v1?\";\n    url = utils.tryAppendQueryString(url, 'bidId', bid.bidId);\n    url = utils.tryAppendQueryString(url, 'placement_key', pkey);\n    url = appendEnvFields(url);\n\n    return url;\n  }\n\n  function _strcallback(bidObj, bidResponse) {\n    try {\n      bidResponse = JSON.parse(bidResponse);\n      const bidId = bidResponse.bidId;\n      const bid = bidfactory.createBid(1, bidObj);\n      bid.bidderCode = STR_BIDDER_CODE;\n      bid.cpm = bidResponse.creatives[0].cpm;\n      const size = bidObj.sizes[0];\n      bid.width = size[0];\n      bid.height = size[1];\n      bid.adserverRequestId = bidResponse.adserverRequestId;\n      str.placementCodeSet[bidObj.placementCode].adserverRequestId = bidResponse.adserverRequestId;\n\n      bid.pkey = utils.getBidIdParameter('pkey', bidObj.params);\n\n      const windowLocation = `str_response_${bidId}`;\n      const bidJsonString = JSON.stringify(bidResponse);\n      bid.ad = `<div data-str-native-key=\"${bid.pkey}\" data-stx-response-name='${windowLocation}'>\n                </div>\n                <script>var ${windowLocation} = ${bidJsonString}</script>\n                <script src=\"//native.sharethrough.com/assets/sfp-set-targeting.js\"></script>\n                <script type='text/javascript'>\n                (function() {\n                    var sfp_js = document.createElement('script');\n                    sfp_js.src = \"//native.sharethrough.com/assets/sfp.js\";\n                    sfp_js.type = 'text/javascript';\n                    sfp_js.charset = 'utf-8';\n                    try {\n                        window.top.document.getElementsByTagName('body')[0].appendChild(sfp_js);\n                    } catch (e) {\n                      console.log(e);\n                    }\n                })();\n                </script>`;\n      bidmanager.addBidResponse(bidObj.placementCode, bid);\n    } catch (e) {\n      _handleInvalidBid(bidObj);\n    }\n  }\n\n  function _handleInvalidBid(bidObj) {\n    const bid = bidfactory.createBid(2, bidObj);\n    bidmanager.addBidResponse(bidObj.placementCode, bid);\n  }\n\n  function appendEnvFields(url) {\n    url = utils.tryAppendQueryString(url, 'hbVersion', '0.24.0-pre');\n    url = utils.tryAppendQueryString(url, 'strVersion', STR_VERSION);\n    url = utils.tryAppendQueryString(url, 'hbSource', 'prebid');\n\n    return url;\n  }\n\n  return {\n    callBids: _callBids,\n    str : str,\n  };\n};\n\nmodule.exports = SharethroughAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/sharethrough.js","var CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\n\nvar RoxotAdapter = function RoxotAdapter() {\n  var roxotUrl = \"r.rxthdr.com\";\n\n  pbjs.roxotResponseHandler = roxotResponseHandler;\n\n  return {\n    callBids: _callBids\n  };\n\n  function _callBids(bidReqs) {\n    utils.logInfo('callBids roxot adapter invoking');\n\n    var domain = window.location.host;\n    var page = window.location.pathname + location.search + location.hash;\n\n    var roxotBidReqs = {\n      id: utils.getUniqueIdentifierStr(),\n      bids: bidReqs,\n      site: {\n        domain: domain,\n        page: page\n      }\n    };\n\n    var scriptUrl = '//' + roxotUrl + '?callback=pbjs.roxotResponseHandler' +\n      '&src=' + CONSTANTS.REPO_AND_VERSION +\n      '&br=' + encodeURIComponent(JSON.stringify(roxotBidReqs));\n\n    adloader.loadScript(scriptUrl);\n  }\n\n  function roxotResponseHandler(roxotResponseObject) {\n    utils.logInfo('roxotResponseHandler invoking');\n    var placements = [];\n\n    if (isResponseInvalid()) {\n      return fillPlacementEmptyBid();\n    }\n\n    roxotResponseObject.bids.forEach(pushRoxotBid);\n    var allBidResponse = fillPlacementEmptyBid(placements);\n    utils.logInfo('roxotResponse handler finish');\n\n    return allBidResponse;\n\n    function isResponseInvalid() {\n      return !roxotResponseObject || !roxotResponseObject.bids || !Array.isArray(roxotResponseObject.bids) || roxotResponseObject.bids.length <= 0;\n    }\n\n    function pushRoxotBid(roxotBid) {\n      var placementCode = '';\n\n      var bidReq = pbjs\n          ._bidsRequested.find(bidSet => bidSet.bidderCode === 'roxot')\n          .bids.find(bid => bid.bidId === roxotBid.bidId);\n\n      if (!bidReq) {\n        return pushErrorBid(placementCode);\n      }\n\n      bidReq.status = CONSTANTS.STATUS.GOOD;\n\n      placementCode = bidReq.placementCode;\n      placements.push(placementCode);\n\n      var cpm = roxotBid.cpm;\n      var responseNurl = '<img src=\"' + roxotBid.nurl + '\">';\n\n      if (!cpm) {\n        return pushErrorBid(placementCode);\n      }\n\n      var bid = bidfactory.createBid(1, bidReq);\n\n      bid.creative_id = roxotBid.id;\n      bid.bidderCode = 'roxot';\n      bid.cpm = cpm;\n      bid.ad = decodeURIComponent(roxotBid.adm + responseNurl);\n      bid.width = parseInt(roxotBid.w);\n      bid.height = parseInt(roxotBid.h);\n\n      bidmanager.addBidResponse(placementCode, bid);\n    }\n\n    function fillPlacementEmptyBid(places) {\n      pbjs\n        ._bidsRequested.find(bidSet => bidSet.bidderCode === 'roxot')\n        .bids.forEach(fillIfNotFilled);\n\n      function fillIfNotFilled(bid) {\n        if (utils.contains(places, bid.placementCode)) {\n          return null;\n        }\n\n        pushErrorBid(bid);\n      }\n    }\n\n    function pushErrorBid(bidRequest) {\n      var bid = bidfactory.createBid(2, bidRequest);\n      bid.bidderCode = 'roxot';\n      bidmanager.addBidResponse(bidRequest.placementCode, bid);\n    }\n  }\n};\n\nmodule.exports = RoxotAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/roxot.js","var CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader.js');\n\nvar VertozAdapter = function VertozAdapter() {\n  \n  const BASE_URI='//banner.vrtzads.com/vzhbidder/bid?';\n  const BIDDER_NAME='vertoz';\n  const QUERY_PARAM_KEY='q';\n\n  function _callBids(params) {\n    var bids = params.bids || [];\n\n    for (var i = 0; i < bids.length; i++) {\n      var bid = bids[i]; \n      let slotBidId = utils.getValue(bid,'bidId');\n      let cb = Math.round(new Date().getTime() / 1000);\n      let vzEndPoint = BASE_URI;\n      let reqParams = bid.params || {};\n      let placementId = utils.getValue(reqParams,'placementId');\n     \t\n      if(utils.isEmptyStr(placementId)){\n        utils.logError('missing params:',BIDDER_NAME,'Enter valid vzPlacementId');\n        return;\n      }\n\n      let reqSrc = utils.getTopWindowLocation().href;\n      var vzReq = {\n        _vzPlacementId:placementId,\n        _rqsrc:reqSrc,\n        _cb:cb,\n        _slotBidId:slotBidId\n      };\n      let queryParamValue=JSON.stringify(vzReq);\n      vzEndPoint = utils.tryAppendQueryString(vzEndPoint, QUERY_PARAM_KEY, queryParamValue);\n      adloader.loadScript(vzEndPoint);\n    }\n\n  }\n\n  pbjs.vzResponse = function (vertozResponse) {\n    var bidRespObj = vertozResponse;\n    var bidObject;\n    var reqBidObj=utils.getBidRequest(bidRespObj.slotBidId);\n    \n    if (bidRespObj.cpm) {\n      bidObject = bidfactory.createBid(CONSTANTS.STATUS.GOOD,reqBidObj);\n      bidObject.cpm = Number(bidRespObj.cpm);\n      bidObject.ad = bidRespObj.ad + utils.createTrackPixelHtml(decodeURIComponent(bidRespObj.nurl));\n      bidObject.width = bidRespObj.adWidth;\n      bidObject.height = bidRespObj.adHeight;\n    }else {\n      let respStatusText=bidRespObj.statusText;\n      bidObject = bidfactory.createBid(CONSTANTS.STATUS.NO_BID,reqBidObj);\n      utils.logMessage(respStatusText);\n    }   \t\n\n    var adSpaceId = reqBidObj.placementCode;\n    bidObject.bidderCode = BIDDER_NAME;\n    bidmanager.addBidResponse(adSpaceId, bidObject);\n  };\n  return { callBids: _callBids };\n\n};\n\nmodule.exports = VertozAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/vertoz.js","\nimport { getBidRequest } from '../utils.js';\n\nconst utils = require('../utils.js');\nconst adloader = require('../adloader.js');\nconst bidmanager = require('../bidmanager.js');\nconst bidfactory = require('../bidfactory.js');\nconst WS_ADAPTER_VERSION = '1.0.2';\n\nfunction WidespaceAdapter() {\n  let useSSL = 'https:' === document.location.protocol,\n      baseURL = (useSSL ? 'https:' : 'http:') + '//engine.widespace.com/map/engine/hb/dynamic?',\n      callbackName = 'pbjs.widespaceHandleCB';\n\n  function _callBids(params) {\n    let bids = params && params.bids || [];\n\n    for (var i = 0; i < bids.length; i++) {\n      const bid = bids[i],\n            callbackUid = bid.bidId,\n            sid = bid.params.sid,\n            currency =  bid.params.cur || bid.params.currency;\n\n      //Handle Sizes string\n      let sizeQueryString = '';\n      let parsedSizes = utils.parseSizesInput(bid.sizes);\n\n      sizeQueryString = parsedSizes.reduce((prev, curr) => {\n        return prev ? `${prev},${curr}` : curr;\n      }, sizeQueryString);\n\n      let requestURL = baseURL;\n      requestURL = utils.tryAppendQueryString(requestURL, 'hb.ver', WS_ADAPTER_VERSION);\n\n      const params = {\n        'hb': '1',\n        'hb.name': 'prebidjs',\n        'hb.callback': callbackName,\n        'hb.callbackUid': callbackUid,\n        'hb.sizes': sizeQueryString,\n        'hb.currency': currency,\n        'sid': sid\n      };\n\n      requestURL += '#';\n\n      var paramKeys = Object.keys(params);\n\n      for (var k = 0; k < paramKeys.length; k++) {\n        var key = paramKeys[k];\n        requestURL += key + '=' + params[key] + '&';\n      }\n\n      // Expose the callback\n      pbjs.widespaceHandleCB = window[callbackName] = handleCallback;\n\n      adloader.loadScript(requestURL);\n    }\n  }\n\n  //Handle our callback\n  var handleCallback = function handleCallback(bidsArray) {\n    if (!bidsArray) { return; }\n\n    var bidObject,\n        bidCode = 'widespace';\n\n    for (var i = 0, l = bidsArray.length; i < l; i++) {\n      var bid = bidsArray[i],\n          placementCode = '',\n          validSizes = [];\n\n      bid.sizes = {height: bid.height, width: bid.width};\n\n      var inBid = getBidRequest(bid.callbackUid);\n\n      if (inBid) {\n        bidCode = inBid.bidder;\n        placementCode = inBid.placementCode;\n        validSizes = inBid.sizes;\n      }\n\n      if (bid && bid.callbackUid && bid.status !=='noad' && verifySize(bid.sizes, validSizes)) {\n        bidObject = bidfactory.createBid(1);\n        bidObject.bidderCode = bidCode;\n        bidObject.cpm = bid.cpm;\n        bidObject.cur = bid.currency;\n        bidObject.creative_id = bid.adId;\n        bidObject.ad = bid.code;\n        bidObject.width = bid.width;\n        bidObject.height = bid.height;\n        bidmanager.addBidResponse(placementCode, bidObject);\n      } else {\n        bidObject = bidfactory.createBid(2);\n        bidObject.bidderCode = bidCode;\n        bidmanager.addBidResponse(placementCode, bidObject);\n      }\n    }\n\n    function verifySize(bid, validSizes) {\n      for (var j = 0, k = validSizes.length; j < k; j++) {\n        if (bid.width === validSizes[j][0] &&\n          bid.height === validSizes[j][1]) {\n          return true;\n        }\n      }\n      return false;\n    }\n  };\n\n  return {\n    callBids: _callBids\n  };\n}\n\nmodule.exports = WidespaceAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/widespace.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar Ajax = require('../ajax');\nvar utils = require('../utils.js');\n\n/**\n * Adapter for requesting bids from Admixer.\n *\n * @returns {{callBids: _callBids,responseCallback: _responseCallback}}\n */\nvar AdmixerAdapter = function AdmixerAdapter() {\n  var invUrl = '//inv-nets.admixer.net/prebid.aspx';\n\n  function _callBids(data) {\n    var bids = data.bids || [];\n    for (var i = 0, ln = bids.length; i < ln; i++) {\n      var bid = bids[i];\n      var params = {\n        'sizes': utils.parseSizesInput(bid.sizes).join('-'),\n        'zone': bid.params && bid.params.zone,\n        'callback_uid': bid.placementCode\n      };\n      if (params.zone) {\n        _requestBid(invUrl, params);\n      }\n      else {\n        var bidObject = bidfactory.createBid(2);\n        bidObject.bidderCode = 'admixer';\n        bidmanager.addBidResponse(params.callback_uid, bidObject);\n      }\n    }\n  }\n\n  function _requestBid(url, params) {\n    Ajax.ajax(url, _responseCallback, params, {method: 'GET', withCredentials: true});\n  }\n\n  function _responseCallback(adUnit) {\n    try {\n      adUnit = JSON.parse(adUnit);\n    } catch (_error) {\n      adUnit = {result: {cpm: 0}};\n      utils.logError(_error);\n    }\n    var adUnitCode = adUnit.callback_uid;\n    var bid = adUnit.result;\n    var bidObject;\n    if (bid.cpm > 0) {\n      bidObject = bidfactory.createBid(1);\n      bidObject.bidderCode = 'admixer';\n      bidObject.cpm = bid.cpm;\n      bidObject.ad = bid.ad;\n      bidObject.width = bid.width;\n      bidObject.height = bid.height;\n    } else {\n      bidObject = bidfactory.createBid(2);\n      bidObject.bidderCode = 'admixer';\n    }\n    bidmanager.addBidResponse(adUnitCode, bidObject);\n  }\n\n  return {\n    callBids: _callBids,\n    responseCallback: _responseCallback\n  };\n};\n\nmodule.exports = AdmixerAdapter;\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/admixer.js","var CONSTANTS = require('../constants.json');\nvar bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('src/adloader.js');\nvar Ajax = require('../ajax');\nvar utils = require('../utils.js');\n\n/**\n * Adapter for requesting bids from Atomx.\n *\n * @returns {{callBids: _callBids, responseCallback: _responseCallback}}\n */\nvar AtomxAdapter = function AtomxAdapter() {\n  function _callBids(data) {\n    if (!window.atomx_prebid) {\n      adloader.loadScript(window.location.protocol + '//s.ato.mx/b.js', function() { _bid(data); }, true);\n    } else {\n      _bid(data);\n    }\n  }\n\n  function _bid(data) {\n    var url = window.atomx_prebid();\n    var bids = data.bids || [];\n    for (var i = 0, ln = bids.length; i < ln; i++) {\n      var bid = bids[i];\n      if (bid.params && bid.params.id) {\n        Ajax.ajax(url, _responseCallback.bind(this, bid), {\n          id: bid.params.id,\n          size: utils.parseSizesInput(bid.sizes)[0],\n          prebid: bid.placementCode\n        }, {method: 'GET'});\n      } else {\n        var bidObject = bidfactory.createBid(CONSTANTS.STATUS.NO_BID, bid);\n        bidObject.bidderCode = 'atomx';\n        bidmanager.addBidResponse(bid.placementCode, bidObject);\n      }\n    }\n  }\n\n  function _responseCallback(bid, data) {\n    var bidObject;\n    try {\n      data = JSON.parse(data);\n\n      if (data.cpm && data.cpm > 0) {\n        bidObject = bidfactory.createBid(CONSTANTS.STATUS.GOOD, bid);\n        bidObject.bidderCode = 'atomx';\n        bidObject.cpm = data.cpm * 1000;\n        if (data.adm) {\n          bidObject.ad = data.adm;\n        } else {\n          bidObject.adUrl = data.url;\n        }\n        bidObject.width = data.width;\n        bidObject.height = data.height;\n        bidmanager.addBidResponse(bid.placementCode, bidObject);\n        return;\n      }\n    } catch (_error) {\n      utils.logError(_error);\n    }\n\n    bidObject = bidfactory.createBid(CONSTANTS.STATUS.NO_BID, bid);\n    bidObject.bidderCode = 'atomx';\n    bidmanager.addBidResponse(bid.placementCode, bidObject);\n  }\n\n  return {\n    callBids: _callBids,\n    responseCallback: _responseCallback\n  };\n};\n\nmodule.exports = AtomxAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/atomx.js","//v0.0.1\n\nconst bidfactory = require('../bidfactory.js');\nconst bidmanager = require('../bidmanager.js');\nconst adloader = require('../adloader');\nconst utils = require('../utils.js');\n\nconst TapSenseAdapter = function TapSenseAdapter() {\n  const version = \"0.0.1\";\n  const creativeSizes = [\n    \"320x50\"\n  ];\n  const validParams = [\n    \"ufid\",\n    \"refer\",\n    \"ad_unit_id\", //required\n    \"device_id\",\n    \"lat\",\n    \"long\",\n    \"user\", //required\n    \"price_floor\",\n    \"test\"\n  ];\n  const SCRIPT_URL = \"https://ads04.tapsense.com/ads/headerad\";\n  let bids;\n  pbjs.tapsense = {};\n  function _callBids(params) {\n    bids = params.bids || [];\n    for (let i = 0; i < bids.length; i++) {\n      let bid = bids[i];\n      let isValidSize = false;\n      if (!bid.sizes || !bid.params.user || !bid.params.ad_unit_id) {\n        return;\n      }\n      let parsedSizes = utils.parseSizesInput(bid.sizes);\n      for (let k = 0; k < parsedSizes.length; k++) {\n        if (creativeSizes.indexOf(parsedSizes[k]) > -1) {\n          isValidSize = true;\n          break;\n        }\n      }\n      if (isValidSize) {\n        let queryString = `?price=true&jsonp=1&callback=pbjs.tapsense.callback_with_price_${bid.bidId}&version=${version}&`;\n        pbjs.tapsense[`callback_with_price_${bid.bidId}`] = generateCallback(bid.bidId);\n        let keys = Object.keys(bid.params);\n        for (let j = 0; j < keys.length; j++) {\n          if (validParams.indexOf(keys[j]) < 0) continue;\n          queryString += encodeURIComponent(keys[j]) + \"=\" + encodeURIComponent(bid.params[keys[j]]) + \"&\";\n        }\n        _requestBids(SCRIPT_URL + queryString);\n      }\n    }\n  }\n\n  function generateCallback(bidId){\n    return function tapsenseCallback(response, price) {\n      let bidObj;\n      if (response && price) {\n        let bidReq = utils.getBidRequest(bidId);\n        if (response.status.value === \"ok\" && response.count_ad_units > 0) {\n          bidObj = bidfactory.createBid(1, bidObj);\n          bidObj.cpm = price;\n          bidObj.width = response.width;\n          bidObj.height = response.height;\n          bidObj.ad = response.ad_units[0].html;\n        } else {\n          bidObj = bidfactory.createBid(2, bidObj);\n        }\n        bidObj.bidderCode = bidReq.bidder;\n        bidmanager.addBidResponse(bidReq.placementCode, bidObj);\n\n      } else {\n        utils.logMessage('No prebid response');\n      }\n    };\n  }\n\n  function _requestBids(scriptURL) {\n    adloader.loadScript(scriptURL);\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = TapSenseAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/tapsense.js","import { getBidRequest } from '../utils.js';\n\nvar CONSTANTS = require('../constants.json');\nvar utils = require('../utils.js');\nvar adloader = require('../adloader.js');\nvar bidmanager = require('../bidmanager.js');\nvar bidfactory = require('../bidfactory.js');\nvar Adapter = require('./adapter.js');\n\nconst BID_REQUEST_BASE_URL = \"https://in-appadvertising.com/api/bidRequest?\";\nconst USER_SYNC_URL =  \"https://in-appadvertising.com/api/userSync.js\";\n\nvar TrionAdapter;\nTrionAdapter = function TrionAdapter() {\n  var baseAdapter = Adapter.createNew('trion');\n  var userTag = null;\n\n  baseAdapter.callBids = function (params) {\n    var bids = params.bids || [];\n\n    if(!bids.length){\n      return;\n    }\n\n    if (!window.TRION_INT) {\n      adloader.loadScript(USER_SYNC_URL, function () {\n        userTag = window.TRION_INT || {};\n        userTag.pubId = utils.getBidIdParameter('pubId', bids[0].params);\n        userTag.sectionId = utils.getBidIdParameter('sectionId', bids[0].params);\n        if(!userTag.to){\n          getBids(bids);\n        }\n        else{\n          setTimeout(function () {\n            getBids(bids);\n          }, userTag.to);\n        }\n      }, true);\n    } else {\n      userTag = window.TRION_INT;\n      getBids(bids);\n    }\n  };\n\n  function getBids(bids){\n    if(!userTag.int_t) {\n      userTag.int_t = window.TR_INT_T || -1;\n    }\n\n    for (var i = 0; i < bids.length; i++) {\n      var bidRequest = bids[i];\n      var bidId = bidRequest.bidId;\n      adloader.loadScript(buildTrionUrl(bidRequest, bidId));\n    }\n  }\n\n  function buildTrionUrl(bid, bidId) {\n    var pubId = utils.getBidIdParameter('pubId', bid.params);\n    var sectionId = utils.getBidIdParameter('sectionId', bid.params);\n    var re = utils.getBidIdParameter('re', bid.params);\n    var url = window.location.href;\n    var sizes = utils.parseSizesInput(bid.sizes).join(',');\n\n    var trionUrl = BID_REQUEST_BASE_URL;\n\n    trionUrl = utils.tryAppendQueryString(trionUrl, 'callback', 'pbjs.handleTrionCB');\n    trionUrl = utils.tryAppendQueryString(trionUrl, 'bidId', bidId);\n    trionUrl = utils.tryAppendQueryString(trionUrl, 'pubId', pubId);\n    trionUrl = utils.tryAppendQueryString(trionUrl, 'sectionId', sectionId);\n    trionUrl = utils.tryAppendQueryString(trionUrl, 're', re);\n    if (url) {\n      trionUrl += 'url=' + url + '&';\n    }\n    if (sizes) {\n      trionUrl += 'sizes=' + sizes + '&';\n    }\n    if(userTag) {\n      trionUrl += 'tag=' + encodeURIComponent(JSON.stringify(userTag)) + '&';\n    }\n\n    //remove the trailing \"&\"\n    if (trionUrl.lastIndexOf('&') === trionUrl.length - 1) {\n      trionUrl = trionUrl.substring(0, trionUrl.length - 1);\n    }\n\n    return trionUrl;\n  }\n\n  //expose the callback to the global object:\n  pbjs.handleTrionCB = function (trionResponseObj) {\n    var bid;\n    var bidObj = {};\n    var placementCode = '';\n\n    if (trionResponseObj && trionResponseObj.bidId) {\n      var bidCode;\n      var bidId = trionResponseObj.bidId;\n      var result = trionResponseObj && trionResponseObj.result;\n\n      bidObj = getBidRequest(bidId);\n      if (bidObj) {\n        bidCode = bidObj.bidder;\n        placementCode = bidObj.placementCode;\n      }\n\n      if (result && result.cpm && result.placeBid && result.ad) {\n        var cpm = parseInt(result.cpm, 10) / 100;\n        bid = bidfactory.createBid(CONSTANTS.STATUS.GOOD, bidObj);\n        bid.bidderCode = bidCode;\n        bid.cpm = cpm;\n        bid.ad = result.ad;\n        bid.width = result.width;\n        bid.height = result.height;\n      }\n    }\n    if(!bid) {\n      bid = bidfactory.createBid(CONSTANTS.STATUS.NO_BID, bidObj);\n    }\n    bidmanager.addBidResponse(placementCode, bid);\n  };\n\n  return {\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode,\n    createNew: TrionAdapter.createNew,\n    buildTrionUrl: buildTrionUrl\n  };\n};\n\nTrionAdapter.createNew = function () {\n  return new TrionAdapter();\n};\n\nmodule.exports = TrionAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/trion.js","import Adapter from 'src/adapters/adapter';\nimport bidfactory from 'src/bidfactory';\nimport bidmanager from 'src/bidmanager';\nimport * as utils from 'src/utils';\nimport { ajax } from 'src/ajax';\nimport { STATUS } from 'src/constants';\nimport { queueSync, persist } from 'src/cookie.js';\n\nconst TYPE = 's2s';\nconst cookiePersistMessage = `Your browser may be blocking 3rd party cookies. By clicking on this page you allow Prebid Server and other advertising partners to place cookies to help us advertise. You can opt out of their cookies <a href=\"https://www.appnexus.com/en/company/platform-privacy-policy#choices\" target=\"_blank\">here</a>.`;\nconst cookiePersistUrl = '//ib.adnxs.com/seg?add=1&redir=';\n/**\n * Bidder adapter for Prebid Server\n */\nfunction PrebidServer() {\n\n  let baseAdapter = Adapter.createNew('prebidServer');\n  let config;\n\n  baseAdapter.setConfig = function(s2sconfig) {\n    config = s2sconfig;\n  };\n\n  /* Prebid executes this function when the page asks to send out bid requests */\n  baseAdapter.callBids = function(bidRequest) {\n\n    let requestJson = {\n      account_id : config.accountId,\n      tid : bidRequest.tid,\n      max_bids: config.maxBids,\n      timeout_millis : config.timeout,\n      url: utils.getTopWindowUrl(),\n      prebid_version : '0.24.0-pre',\n      ad_units : bidRequest.ad_units.filter(hasSizes)\n    };\n\n    const payload = JSON.stringify(requestJson);\n    ajax(config.endpoint, handleResponse, payload, {\n      contentType: 'text/plain',\n      withCredentials : true\n    });\n  };\n\n  // at this point ad units should have a size array either directly or mapped so filter for that\n  function hasSizes(unit) {\n    return unit.sizes && unit.sizes.length;\n  }\n\n  /* Notify Prebid of bid responses so bids can get in the auction */\n  function handleResponse(response) {\n    let result;\n    try {\n      result = JSON.parse(response);\n\n      if(result.status === 'OK') {\n        if(result.bidder_status) {\n          result.bidder_status.forEach(bidder => {\n            if(bidder.no_bid) {\n              // store a \"No Bid\" bid response\n\n              let bidObject = bidfactory.createBid(STATUS.NO_BID, {\n                bidId: bidder.bid_id\n              });\n              bidObject.adUnitCode = bidder.ad_unit;\n              bidObject.bidderCode = bidder.bidder;\n              bidmanager.addBidResponse(bidObject.adUnitCode, bidObject);\n            }\n            if(bidder.no_cookie) {\n              // if no cookie is present then no bids were made, we don't store a bid response\n              queueSync({bidder: bidder.bidder, url : bidder.usersync.url, type : bidder.usersync.type});\n            }\n          });\n        }\n        if(result.bids) {\n          result.bids.forEach(bidObj => {\n            let bidRequest = utils.getBidRequest(bidObj.bid_id);\n            let cpm = bidObj.price;\n            let status;\n            if (cpm !== 0) {\n              status = STATUS.GOOD;\n            } else {\n              status = STATUS.NO_BID;\n            }\n\n            let bidObject = bidfactory.createBid(status, bidRequest);\n            bidObject.creative_id = bidObj.creative_id;\n            bidObject.bidderCode = bidObj.bidder;\n            bidObject.cpm = cpm;\n            bidObject.ad = bidObj.adm;\n            bidObject.width = bidObj.width;\n            bidObject.height = bidObj.height;\n\n            bidmanager.addBidResponse(bidObj.code, bidObject);\n          });\n        }\n      }\n      else if (result.status === 'no_cookie') {\n        //cookie sync\n        persist(cookiePersistUrl, cookiePersistMessage);\n      }\n    } catch (error) {\n      utils.logError(error);\n    }\n\n    if (!result || result.status && result.status.includes('Error')) {\n      utils.logError('error parsing response: ', result.status);\n    }\n  }\n\n  return {\n    setConfig : baseAdapter.setConfig,\n    createNew: PrebidServer.createNew,\n    callBids: baseAdapter.callBids,\n    setBidderCode: baseAdapter.setBidderCode,\n    type : TYPE\n  };\n\n}\n\nPrebidServer.createNew = function() {\n  return new PrebidServer();\n};\n\nmodule.exports = PrebidServer;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/prebidServer.js","const cookie = exports;\nimport * as utils from 'utils';\n\nconst queue = [];\n\nfunction fireSyncs() {\n  queue.forEach(obj => {\n    utils.logMessage(`Invoking cookie sync for bidder: ${obj.bidder}`);\n    if(obj.type === 'iframe') {\n      utils.insertCookieSyncIframe(obj.url, false);\n    } else {\n      utils.insertPixel(obj.url);\n    }\n  });\n  //empty queue.\n  queue.length = 0;\n}\n\n/**\n * Add this bidder to the queue for sync\n * @param  {String} bidder bidder code\n * @param  {String} url    optional URL for invoking cookie sync if provided.\n */\ncookie.queueSync = function ({bidder, url, type}) {\n  queue.push({bidder, url, type});\n};\n\n/**\n * Fire cookie sync URLs previously queued\n * @param  {number} timeout time in ms to delay in sending\n */\ncookie.syncCookies = function(timeout) {\n  if(timeout) {\n    setTimeout(fireSyncs, timeout);\n  }\n  else {\n    fireSyncs();\n  }\n};\n\ncookie.persist = function(url, msgHtml) {\n  if(!utils.isSafariBrowser()){\n    return;\n  }\n  linkOverride(url);\n  displayFooter(msgHtml);\n};\n\nfunction linkOverride(url) {\n   for (var i = 0; i < document.links.length; i++){\n     var link = document.links[i];\n     link.href = url + encodeURIComponent(link.href);\n   }\n }\n\nfunction displayFooter(msgHtml) {\n  // https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie#Example_3_Do_something_only_once\n  if (document.cookie.replace(/(?:(?:^|.*;\\s*)pbsCookiePersistFooter\\s*\\=\\s*([^;]*).*$)|^.*$/, '$1') !== 'true') {\n    document.body.appendChild(createFooter(msgHtml));\n    document.cookie = 'pbsCookiePersistFooter=true; expires=Fri, 31 Dec 9999 23:59:59 GMT';\n  }\n}\n\nfunction createFooter(msgHtml) {\n  const footer = document.createElement('div');\n  footer.style.background = '#D3D3D3';\n  footer.style.color = '#555';\n  footer.style.boxShadow = '0 -1px 2px rgba(0, 0, 0, 0.2)';\n  footer.style.fontFamily = 'sans-serif';\n  footer.style.lineHeight = '1.5';\n  footer.style.position = 'fixed';\n  footer.style.bottom = '0';\n  footer.style.left = '0';\n  footer.style.right = '0';\n  footer.style.width = '100%';\n  footer.style.padding = '1em 0';\n  footer.style.zindex = '1000';\n\n  const footerText = document.createElement('p');\n  footerText.style.margin = '0 2em';\n  footerText.innerHTML = msgHtml;\n  footer.appendChild(footerText);\n\n  return footer;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/cookie.js","var bidfactory = require('../bidfactory.js');\nvar bidmanager = require('../bidmanager.js');\nvar adloader = require('../adloader');\nvar utils = require('../utils');\nconst ADSUPPLY_CODE = 'adsupply';\n\nvar AdSupplyAdapter = function AdSupplyAdapter() {\n  function _validateParams(params) {\n    if (!params || !params.siteId || !params.zoneId || !params.endpointUrl || !params.clientId) {\n      return false;\n    }\n\n    if (typeof params.zoneId !== 'number' || params.zoneId <= 0) {\n      return false;\n    }\n\n    return true;\n  }\n\n  function _getRequestUrl(bid) {\n    var referrerUrl = encodeURIComponent(window.document.referrer);\n    var rand = encodeURIComponent(Math.floor(Math.random() * 100000 + 1));\n    var time = encodeURIComponent(new Date().getTimezoneOffset());\n    return '//' + bid.params.endpointUrl + '/banner.engine?id=' + bid.params.siteId + '&z=' + bid.params.zoneId + '&rand=' + rand + '&ver=async' + '&time=' + time + '&referrerurl=' + referrerUrl + '&abr=false' + '&hbt=1&cid=' + encodeURIComponent(bid.params.clientId);\n  }\n\n  pbjs.adSupplyResponseHandler = function (bidId) {\n    if (!bidId) return;\n\n    var bidRequest = utils.getBidRequest(bidId);\n\n    if (!bidRequest || !bidRequest.params) return;\n\n    var clientId = bidRequest.params.clientId;\n    var zoneProp = 'b' + bidRequest.params.zoneId;\n\n    if (!window[clientId] || !window[clientId][zoneProp]) return;\n\n    var media = window[clientId][zoneProp].Media;\n\n    if (!media) return;\n\n    if (!media.Url || !media.Ecpm || typeof media.Ecpm !== 'number' || media.Ecpm <= 0) {\n      var noFillbject = bidfactory.createBid(2, bidRequest);\n      noFillbject.bidderCode = ADSUPPLY_CODE;\n      bidmanager.addBidResponse(bidRequest.placementCode, noFillbject);\n    } else {\n      var bidObject = bidfactory.createBid(1, bidRequest);\n      bidObject.bidderCode = ADSUPPLY_CODE;\n      bidObject.cpm = media.Ecpm;\n      bidObject.ad = '<iframe style=\"z-index: 5000001; margin: 0px; padding: 0px; border: none; width: ' + media.Width + 'px; height: ' + media.Height + 'px; \" src=\"//' + bidRequest.params.endpointUrl + media.Url + '\"></iframe>';\n      bidObject.width = media.Width;\n      bidObject.height = media.Height;\n      bidmanager.addBidResponse(bidRequest.placementCode, bidObject);\n    }\n  };\n\n  function _makeCallBackHandler(bidId) {\n    return function () {\n      pbjs.adSupplyResponseHandler(bidId);\n    };\n  }\n\n  function _callBids(params) {\n    var bids = params.bids || [];\n    for (var i = 0; i < bids.length; i++) {\n      var bid = bids[i];\n      if (!_validateParams(bid.params)) continue;\n\n      var clientId = bid.params.clientId;\n      var zoneProp = 'b' + bid.params.zoneId;\n      window[clientId] = window[clientId] || {};\n      window.window[clientId][zoneProp] = window.window[clientId][zoneProp] || {};\n      window.window[clientId][zoneProp].Media = {};\n\n      var requestUrl = _getRequestUrl(bid);\n      adloader.loadScript(requestUrl, _makeCallBackHandler(bid.bidId));\n    }\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nmodule.exports = AdSupplyAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/adapters/adsupply.js","/** @module polyfill\nMisc polyfills\n*/\n/*jshint -W121 */\nrequire('core-js/fn/array/find');\nrequire('core-js/fn/array/includes');\nrequire('core-js/fn/object/assign');\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger\nNumber.isInteger = Number.isInteger || function(value) {\n  return typeof value === 'number' &&\n    isFinite(value) &&\n    Math.floor(value) === value;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/polyfill.js","require('../../modules/es6.array.find');\nmodule.exports = require('../../modules/_core').Array.find;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/fn/array/find.js\n// module id = 88\n// module chunks = 0","'use strict';\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = require('./_export')\n  , $find   = require('./_array-methods')(5)\n  , KEY     = 'find'\n  , forced  = true;\n// Shouldn't skip holes\nif(KEY in [])Array(1)[KEY](function(){ forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn/*, that = undefined */){\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/es6.array.find.js\n// module id = 89\n// module chunks = 0","var global    = require('./_global')\n  , core      = require('./_core')\n  , hide      = require('./_hide')\n  , redefine  = require('./_redefine')\n  , ctx       = require('./_ctx')\n  , PROTOTYPE = 'prototype';\n\nvar $export = function(type, name, source){\n  var IS_FORCED = type & $export.F\n    , IS_GLOBAL = type & $export.G\n    , IS_STATIC = type & $export.S\n    , IS_PROTO  = type & $export.P\n    , IS_BIND   = type & $export.B\n    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE]\n    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})\n    , expProto  = exports[PROTOTYPE] || (exports[PROTOTYPE] = {})\n    , key, own, out, exp;\n  if(IS_GLOBAL)source = name;\n  for(key in source){\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    // export native or passed\n    out = (own ? target : source)[key];\n    // bind timers to global for call from export context\n    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // extend global\n    if(target)redefine(target, key, out, type & $export.U);\n    // export\n    if(exports[key] != out)hide(exports, key, exp);\n    if(IS_PROTO && expProto[key] != out)expProto[key] = out;\n  }\n};\nglobal.core = core;\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library` \nmodule.exports = $export;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_export.js\n// module id = 90\n// module chunks = 0","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\nif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_global.js\n// module id = 91\n// module chunks = 0","var core = module.exports = {version: '2.4.0'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_core.js\n// module id = 92\n// module chunks = 0","var dP         = require('./_object-dp')\n  , createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function(object, key, value){\n  return dP.f(object, key, createDesc(1, value));\n} : function(object, key, value){\n  object[key] = value;\n  return object;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_hide.js\n// module id = 93\n// module chunks = 0","var anObject       = require('./_an-object')\n  , IE8_DOM_DEFINE = require('./_ie8-dom-define')\n  , toPrimitive    = require('./_to-primitive')\n  , dP             = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes){\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if(IE8_DOM_DEFINE)try {\n    return dP(O, P, Attributes);\n  } catch(e){ /* empty */ }\n  if('get' in Attributes || 'set' in Attributes)throw TypeError('Accessors not supported!');\n  if('value' in Attributes)O[P] = Attributes.value;\n  return O;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_object-dp.js\n// module id = 94\n// module chunks = 0","var isObject = require('./_is-object');\nmodule.exports = function(it){\n  if(!isObject(it))throw TypeError(it + ' is not an object!');\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_an-object.js\n// module id = 95\n// module chunks = 0","module.exports = function(it){\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_is-object.js\n// module id = 96\n// module chunks = 0","module.exports = !require('./_descriptors') && !require('./_fails')(function(){\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_ie8-dom-define.js\n// module id = 97\n// module chunks = 0","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function(){\n  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_descriptors.js\n// module id = 98\n// module chunks = 0","module.exports = function(exec){\n  try {\n    return !!exec();\n  } catch(e){\n    return true;\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_fails.js\n// module id = 99\n// module chunks = 0","var isObject = require('./_is-object')\n  , document = require('./_global').document\n  // in old IE typeof document.createElement is 'object'\n  , is = isObject(document) && isObject(document.createElement);\nmodule.exports = function(it){\n  return is ? document.createElement(it) : {};\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_dom-create.js\n// module id = 100\n// module chunks = 0","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function(it, S){\n  if(!isObject(it))return it;\n  var fn, val;\n  if(S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_to-primitive.js\n// module id = 101\n// module chunks = 0","module.exports = function(bitmap, value){\n  return {\n    enumerable  : !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable    : !(bitmap & 4),\n    value       : value\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_property-desc.js\n// module id = 102\n// module chunks = 0","var global    = require('./_global')\n  , hide      = require('./_hide')\n  , has       = require('./_has')\n  , SRC       = require('./_uid')('src')\n  , TO_STRING = 'toString'\n  , $toString = Function[TO_STRING]\n  , TPL       = ('' + $toString).split(TO_STRING);\n\nrequire('./_core').inspectSource = function(it){\n  return $toString.call(it);\n};\n\n(module.exports = function(O, key, val, safe){\n  var isFunction = typeof val == 'function';\n  if(isFunction)has(val, 'name') || hide(val, 'name', key);\n  if(O[key] === val)return;\n  if(isFunction)has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n  if(O === global){\n    O[key] = val;\n  } else {\n    if(!safe){\n      delete O[key];\n      hide(O, key, val);\n    } else {\n      if(O[key])O[key] = val;\n      else hide(O, key, val);\n    }\n  }\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, TO_STRING, function toString(){\n  return typeof this == 'function' && this[SRC] || $toString.call(this);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_redefine.js\n// module id = 103\n// module chunks = 0","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function(it, key){\n  return hasOwnProperty.call(it, key);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_has.js\n// module id = 104\n// module chunks = 0","var id = 0\n  , px = Math.random();\nmodule.exports = function(key){\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_uid.js\n// module id = 105\n// module chunks = 0","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function(fn, that, length){\n  aFunction(fn);\n  if(that === undefined)return fn;\n  switch(length){\n    case 1: return function(a){\n      return fn.call(that, a);\n    };\n    case 2: return function(a, b){\n      return fn.call(that, a, b);\n    };\n    case 3: return function(a, b, c){\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function(/* ...args */){\n    return fn.apply(that, arguments);\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_ctx.js\n// module id = 106\n// module chunks = 0","module.exports = function(it){\n  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_a-function.js\n// module id = 107\n// module chunks = 0","// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx      = require('./_ctx')\n  , IObject  = require('./_iobject')\n  , toObject = require('./_to-object')\n  , toLength = require('./_to-length')\n  , asc      = require('./_array-species-create');\nmodule.exports = function(TYPE, $create){\n  var IS_MAP        = TYPE == 1\n    , IS_FILTER     = TYPE == 2\n    , IS_SOME       = TYPE == 3\n    , IS_EVERY      = TYPE == 4\n    , IS_FIND_INDEX = TYPE == 6\n    , NO_HOLES      = TYPE == 5 || IS_FIND_INDEX\n    , create        = $create || asc;\n  return function($this, callbackfn, that){\n    var O      = toObject($this)\n      , self   = IObject(O)\n      , f      = ctx(callbackfn, that, 3)\n      , length = toLength(self.length)\n      , index  = 0\n      , result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined\n      , val, res;\n    for(;length > index; index++)if(NO_HOLES || index in self){\n      val = self[index];\n      res = f(val, index, O);\n      if(TYPE){\n        if(IS_MAP)result[index] = res;            // map\n        else if(res)switch(TYPE){\n          case 3: return true;                    // some\n          case 5: return val;                     // find\n          case 6: return index;                   // findIndex\n          case 2: result.push(val);               // filter\n        } else if(IS_EVERY)return false;          // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_array-methods.js\n// module id = 108\n// module chunks = 0","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function(it){\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_iobject.js\n// module id = 109\n// module chunks = 0","var toString = {}.toString;\n\nmodule.exports = function(it){\n  return toString.call(it).slice(8, -1);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_cof.js\n// module id = 110\n// module chunks = 0","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function(it){\n  return Object(defined(it));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_to-object.js\n// module id = 111\n// module chunks = 0","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function(it){\n  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_defined.js\n// module id = 112\n// module chunks = 0","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer')\n  , min       = Math.min;\nmodule.exports = function(it){\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_to-length.js\n// module id = 113\n// module chunks = 0","// 7.1.4 ToInteger\nvar ceil  = Math.ceil\n  , floor = Math.floor;\nmodule.exports = function(it){\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_to-integer.js\n// module id = 114\n// module chunks = 0","// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = require('./_array-species-constructor');\n\nmodule.exports = function(original, length){\n  return new (speciesConstructor(original))(length);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_array-species-create.js\n// module id = 115\n// module chunks = 0","var isObject = require('./_is-object')\n  , isArray  = require('./_is-array')\n  , SPECIES  = require('./_wks')('species');\n\nmodule.exports = function(original){\n  var C;\n  if(isArray(original)){\n    C = original.constructor;\n    // cross-realm fallback\n    if(typeof C == 'function' && (C === Array || isArray(C.prototype)))C = undefined;\n    if(isObject(C)){\n      C = C[SPECIES];\n      if(C === null)C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_array-species-constructor.js\n// module id = 116\n// module chunks = 0","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg){\n  return cof(arg) == 'Array';\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_is-array.js\n// module id = 117\n// module chunks = 0","var store      = require('./_shared')('wks')\n  , uid        = require('./_uid')\n  , Symbol     = require('./_global').Symbol\n  , USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function(name){\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_wks.js\n// module id = 118\n// module chunks = 0","var global = require('./_global')\n  , SHARED = '__core-js_shared__'\n  , store  = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function(key){\n  return store[key] || (store[key] = {});\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_shared.js\n// module id = 119\n// module chunks = 0","// 22.1.3.31 Array.prototype[@@unscopables]\nvar UNSCOPABLES = require('./_wks')('unscopables')\n  , ArrayProto  = Array.prototype;\nif(ArrayProto[UNSCOPABLES] == undefined)require('./_hide')(ArrayProto, UNSCOPABLES, {});\nmodule.exports = function(key){\n  ArrayProto[UNSCOPABLES][key] = true;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_add-to-unscopables.js\n// module id = 120\n// module chunks = 0","require('../../modules/es7.array.includes');\nmodule.exports = require('../../modules/_core').Array.includes;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/fn/array/includes.js\n// module id = 121\n// module chunks = 0","'use strict';\n// https://github.com/tc39/Array.prototype.includes\nvar $export   = require('./_export')\n  , $includes = require('./_array-includes')(true);\n\n$export($export.P, 'Array', {\n  includes: function includes(el /*, fromIndex = 0 */){\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\nrequire('./_add-to-unscopables')('includes');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/es7.array.includes.js\n// module id = 122\n// module chunks = 0","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject')\n  , toLength  = require('./_to-length')\n  , toIndex   = require('./_to-index');\nmodule.exports = function(IS_INCLUDES){\n  return function($this, el, fromIndex){\n    var O      = toIObject($this)\n      , length = toLength(O.length)\n      , index  = toIndex(fromIndex, length)\n      , value;\n    // Array#includes uses SameValueZero equality algorithm\n    if(IS_INCLUDES && el != el)while(length > index){\n      value = O[index++];\n      if(value != value)return true;\n    // Array#toIndex ignores holes, Array#includes - not\n    } else for(;length > index; index++)if(IS_INCLUDES || index in O){\n      if(O[index] === el)return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_array-includes.js\n// module id = 123\n// module chunks = 0","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject')\n  , defined = require('./_defined');\nmodule.exports = function(it){\n  return IObject(defined(it));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_to-iobject.js\n// module id = 124\n// module chunks = 0","var toInteger = require('./_to-integer')\n  , max       = Math.max\n  , min       = Math.min;\nmodule.exports = function(index, length){\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_to-index.js\n// module id = 125\n// module chunks = 0","require('../../modules/es6.object.assign');\nmodule.exports = require('../../modules/_core').Object.assign;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/fn/object/assign.js\n// module id = 126\n// module chunks = 0","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', {assign: require('./_object-assign')});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/es6.object.assign.js\n// module id = 127\n// module chunks = 0","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar getKeys  = require('./_object-keys')\n  , gOPS     = require('./_object-gops')\n  , pIE      = require('./_object-pie')\n  , toObject = require('./_to-object')\n  , IObject  = require('./_iobject')\n  , $assign  = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function(){\n  var A = {}\n    , B = {}\n    , S = Symbol()\n    , K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function(k){ B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source){ // eslint-disable-line no-unused-vars\n  var T     = toObject(target)\n    , aLen  = arguments.length\n    , index = 1\n    , getSymbols = gOPS.f\n    , isEnum     = pIE.f;\n  while(aLen > index){\n    var S      = IObject(arguments[index++])\n      , keys   = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S)\n      , length = keys.length\n      , j      = 0\n      , key;\n    while(length > j)if(isEnum.call(S, key = keys[j++]))T[key] = S[key];\n  } return T;\n} : $assign;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_object-assign.js\n// module id = 128\n// module chunks = 0","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys       = require('./_object-keys-internal')\n  , enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O){\n  return $keys(O, enumBugKeys);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_object-keys.js\n// module id = 129\n// module chunks = 0","var has          = require('./_has')\n  , toIObject    = require('./_to-iobject')\n  , arrayIndexOf = require('./_array-includes')(false)\n  , IE_PROTO     = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function(object, names){\n  var O      = toIObject(object)\n    , i      = 0\n    , result = []\n    , key;\n  for(key in O)if(key != IE_PROTO)has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while(names.length > i)if(has(O, key = names[i++])){\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_object-keys-internal.js\n// module id = 130\n// module chunks = 0","var shared = require('./_shared')('keys')\n  , uid    = require('./_uid');\nmodule.exports = function(key){\n  return shared[key] || (shared[key] = uid(key));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_shared-key.js\n// module id = 131\n// module chunks = 0","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_enum-bug-keys.js\n// module id = 132\n// module chunks = 0","exports.f = Object.getOwnPropertySymbols;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_object-gops.js\n// module id = 133\n// module chunks = 0","exports.f = {}.propertyIsEnumerable;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/modules/_object-pie.js\n// module id = 134\n// module chunks = 0","/* Secure Creatives\n  Provides support for rendering creatives into cross domain iframes such as SafeFrame to prevent\n   access to a publisher page from creative payloads.\n */\n\nimport events from './events';\nimport { EVENTS } from './constants';\n\nconst BID_WON = EVENTS.BID_WON;\n\n\nexport function listenMessagesFromCreative() {\n  addEventListener('message', receiveMessage, false);\n}\n\nfunction receiveMessage(ev) {\n  var key = ev.message ? 'message' : 'data';\n  var data = {};\n  try {\n    data = JSON.parse(ev[key]);\n  } catch (e) {\n    return;\n  }\n\n  if (data.adId) {\n    const adObject = pbjs._bidsReceived.find(function (bid) {\n      return bid.adId === data.adId;\n    });\n\n    if (data.message === 'Prebid Request') {\n      sendAdToCreative(adObject, data.adServerDomain, ev.source);\n      events.emit(BID_WON, adObject);\n    }\n  }\n}\n\nfunction sendAdToCreative(adObject, remoteDomain, source) {\n  const { adId, ad, adUrl, width, height } = adObject;\n\n  if (adId) {\n    resizeRemoteCreative(adObject);\n    source.postMessage(JSON.stringify({\n      message: 'Prebid Response',\n      ad,\n      adUrl,\n      adId,\n      width,\n      height\n    }), remoteDomain);\n  }\n}\n\nfunction resizeRemoteCreative({ adUnitCode, width, height }) {\n  const iframe = document.getElementById(window.googletag.pubads()\n    .getSlots().find(slot => {\n      return slot.getAdUnitPath() === adUnitCode ||\n        slot.getSlotElementId() === adUnitCode;\n    }).getSlotElementId()).querySelector('iframe');\n\n  iframe.width = '' + width;\n  iframe.height = '' + height;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/secure-creatives.js","import {formatQS} from './url';\nimport {getWinningBids} from './targeting';\n\n//Adserver parent class\nconst AdServer = function(attr) {\n  this.name = attr.adserver;\n  this.code = attr.code;\n  this.getWinningBidByCode = function() {\n    return getWinningBids(this.code)[0];\n  };\n};\n\n//DFP ad server\nexports.dfpAdserver = function (options, urlComponents) {\n  var adserver = new AdServer(options);\n  adserver.urlComponents = urlComponents;\n\n  var dfpReqParams = {\n    'env' : 'vp',\n    'gdfp_req' : '1',\n    'impl' : 's',\n    'unviewed_position_start' : '1'\n  };\n\n  var dfpParamsWithVariableValue = ['output', 'iu', 'sz', 'url', 'correlator', 'description_url', 'hl'];\n\n  var getCustomParams = function(targeting) {\n    return encodeURIComponent(formatQS(targeting));\n  };\n\n  adserver.appendQueryParams = function() {\n    var bid = adserver.getWinningBidByCode();\n    if (bid) {\n      this.urlComponents.search.description_url = encodeURIComponent(bid.descriptionUrl);\n      this.urlComponents.search.cust_params = getCustomParams(bid.adserverTargeting);\n      this.urlComponents.search.correlator = Date.now();\n    }\n  };\n\n  adserver.verifyAdserverTag = function() {\n    for(var key in dfpReqParams) {\n      if(!this.urlComponents.search.hasOwnProperty(key) || this.urlComponents.search[key] !== dfpReqParams[key]) {\n        return false;\n      }\n    }\n    for(var i in dfpParamsWithVariableValue) {\n      if(!this.urlComponents.search.hasOwnProperty(dfpParamsWithVariableValue[i])) {\n        return false;\n      }\n    }\n    return true;\n  };\n\n  return adserver;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/adserver.js","import { uniques, isGptPubadsDefined, getHighestCpm, adUnitsFilter } from './utils';\nconst bidmanager = require('./bidmanager.js');\nconst utils = require('./utils.js');\nvar CONSTANTS = require('./constants.json');\n\nvar targeting = exports;\nvar pbTargetingKeys = [];\n\ntargeting.resetPresetTargeting = function() {\n  if (isGptPubadsDefined()) {\n    window.googletag.pubads().getSlots().forEach(slot => {\n      pbTargetingKeys.forEach(function(key){\n        // reset only registered adunits\n        pbjs.adUnits.find(function(unit) {\n          if (unit.code === slot.getAdUnitPath() ||\n              unit.code === slot.getSlotElementId()) {\n            slot.setTargeting(key, null);\n          }\n        });\n      });\n    });\n  }\n};\n\ntargeting.getAllTargeting = function(adUnitCode) {\n  const adUnitCodes = adUnitCode && adUnitCode.length ? [adUnitCode] : pbjs._adUnitCodes;\n\n  // Get targeting for the winning bid. Add targeting for any bids that have\n  // `alwaysUseBid=true`. If sending all bids is enabled, add targeting for losing bids.\n  var targeting = getWinningBidTargeting(adUnitCodes)\n      .concat(getAlwaysUseBidTargeting(adUnitCodes))\n      .concat(pbjs._sendAllBids ? getBidLandscapeTargeting(adUnitCodes) : []);\n\n  //store a reference of the targeting keys\n  targeting.map(adUnitCode => {\n    Object.keys(adUnitCode).map(key => {\n      adUnitCode[key].map(targetKey => {\n        if (pbTargetingKeys.indexOf(Object.keys(targetKey)[0]) === -1) {\n          pbTargetingKeys = Object.keys(targetKey).concat(pbTargetingKeys);\n        }\n      });\n    });\n  });\n  return targeting;\n};\n\ntargeting.setTargeting = function(targetingConfig) {\n  window.googletag.pubads().getSlots().forEach(slot => {\n    targetingConfig.filter(targeting => Object.keys(targeting)[0] === slot.getAdUnitPath() ||\n      Object.keys(targeting)[0] === slot.getSlotElementId())\n      .forEach(targeting => targeting[Object.keys(targeting)[0]]\n        .forEach(key => {\n          key[Object.keys(key)[0]]\n            .map((value) => {\n              utils.logMessage(`Attempting to set key value for slot: ${slot.getSlotElementId()} key: ${Object.keys(key)[0]} value: ${value}`);\n              return value;\n            })\n            .forEach(value => {\n              slot.setTargeting(Object.keys(key)[0], value);\n            });\n        }));\n  });\n};\n\ntargeting.getWinningBids = function(adUnitCode) {\n  // use the given adUnitCode as a filter if present or all adUnitCodes if not\n  const adUnitCodes = adUnitCode ? [adUnitCode] : pbjs._adUnitCodes;\n\n  return pbjs._bidsReceived\n    .filter(bid => adUnitCodes.includes(bid.adUnitCode))\n    .filter(bid => bid.cpm > 0)\n    .map(bid => bid.adUnitCode)\n    .filter(uniques)\n    .map(adUnitCode => pbjs._bidsReceived\n      .filter(bid => bid.adUnitCode === adUnitCode ? bid : null)\n      .reduce(getHighestCpm,\n        {\n          adUnitCode: adUnitCode,\n          cpm: 0,\n          adserverTargeting: {},\n          timeToRespond: 0\n        }));\n};\n\ntargeting.setTargetingForAst = function() {\n  let targeting = pbjs.getAdserverTargeting();\n  Object.keys(targeting).forEach(targetId =>\n    Object.keys(targeting[targetId]).forEach(key => {\n      utils.logMessage(`Attempting to set targeting for targetId: ${targetId} key: ${key} value: ${targeting[targetId][key]}`);\n      //setKeywords supports string and array as value\n      if(utils.isStr(targeting[targetId][key]) || utils.isArray(targeting[targetId][key])) {\n        let keywordsObj = {};\n        let input = 'hb_adid';\n        let nKey = (key.substring(0, input.length) === input) ? key.toUpperCase() : key;\n        keywordsObj[nKey] = targeting[targetId][key];\n        window.apntag.setKeywords(targetId,keywordsObj);\n      }\n    })\n  );\n};\n\nfunction getWinningBidTargeting() {\n  let winners = targeting.getWinningBids();\n  let standardKeys = getStandardKeys();\n\n  winners = winners.map(winner => {\n    return {\n      [winner.adUnitCode]: Object.keys(winner.adserverTargeting)\n        .filter(key =>\n          typeof winner.sendStandardTargeting === \"undefined\" ||\n          winner.sendStandardTargeting ||\n          standardKeys.indexOf(key) === -1)\n        .map(key => ({ [key.substring(0, 20)]: [winner.adserverTargeting[key]] }))\n    };\n  });\n\n  return winners;\n}\n\nfunction getStandardKeys() {\n  return bidmanager.getStandardBidderAdServerTargeting()        // in case using a custom standard key set\n                   .map(targeting => targeting.key)\n                   .concat(CONSTANTS.TARGETING_KEYS).filter(uniques);     // standard keys defined in the library.\n}\n\n/**\n * Get custom targeting keys for bids that have `alwaysUseBid=true`.\n */\nfunction getAlwaysUseBidTargeting(adUnitCodes) {\n  let standardKeys = getStandardKeys();\n  return pbjs._bidsReceived\n    .filter(adUnitsFilter.bind(this, adUnitCodes))\n    .map(bid => {\n      if (bid.alwaysUseBid) {\n        return {\n          [bid.adUnitCode]: Object.keys(bid.adserverTargeting).map(key => {\n            // Get only the non-standard keys of the losing bids, since we\n            // don't want to override the standard keys of the winning bid.\n            if (standardKeys.indexOf(key) > -1) {\n              return;\n            }\n\n            return { [key.substring(0, 20)]: [bid.adserverTargeting[key]] };\n\n          }).filter(key => key) // remove empty elements\n        };\n      }\n    })\n    .filter(bid => bid); // removes empty elements in array;\n}\n\nfunction getBidLandscapeTargeting(adUnitCodes) {\n  const standardKeys = CONSTANTS.TARGETING_KEYS;\n\n  return pbjs._bidsReceived\n    .filter(adUnitsFilter.bind(this, adUnitCodes))\n    .map(bid => {\n      if (bid.adserverTargeting) {\n        return {\n          [bid.adUnitCode]: getTargetingMap(bid, standardKeys.filter(\n            key => typeof bid.adserverTargeting[key] !== 'undefined') // mainly for possibly\n            // unset hb_deal\n          )\n        };\n      }\n    }).filter(bid => bid); // removes empty elements in array\n}\n\nfunction getTargetingMap(bid, keys) {\n  return keys.map(key => {\n    return {\n      [`${key}_${bid.bidderCode}`.substring(0, 20)]: [bid.adserverTargeting[key]]\n    };\n  });\n}\n\ntargeting.isApntagDefined = function() {\n  if (window.apntag && utils.isFn(window.apntag.setKeywords)) {\n    return true;\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/targeting.js"],"sourceRoot":""}