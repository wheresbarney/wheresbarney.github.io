<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <title>Fiddle</title>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script charset="utf-8" src="https://cdn.jsdelivr.net/ace/1.2.4/min/ace.js" type="text/javascript"></script>

  <style media="screen" type="text/css">
    #editor {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
    }

    html, body {
        height: 100%;
        margin: 0;
    }
    .container-fluid {
      height: 100%;
    }
    .editor-col, .editor-row, .output-col, #output {
      height: 100%;
    }

    .btn {
      width: 40px;
      height: 40px;
    }

    .output-col {
      display: flex;
      flex-flow: column;
    }

    .toolbar {
      margin-bottom: 15px;
    }

    #output {
      flex: 1;
      overflow: auto;
      box-shadow: 0px 0px 5px 1px rgba(0,0,0,0.75);
    }
  </style>
</head>
<body>
  <div class="container-fluid">
    <div class="row editor-row">
      <div class="col-xs-8 editor-col">
        <div id="editor"></div>
      </div>
      <div class="col-xs-4 output-col">
        <div class="btn-toolbar toolbar" role="toolbar">
          <div class="btn-group" role="group">
            <button id="save" type="button" class="btn btn-primary">
              <span class="glyphicon glyphicon-floppy-disk"></span>
            </button>
            <button id="reload" type="button" class="btn btn-primary">
              <span class="glyphicon glyphicon-refresh"></span>
            </button>
          </div>
          <div class="btn-group" role="group">
            <button id="expand-left" type="button" class="btn btn-primary">
              <span class="glyphicon glyphicon-menu-left"></span>
            </button>
            <button id="expand-right" type="button" class="btn btn-primary">
              <span class="glyphicon glyphicon-menu-right"></span>
            </button>
          </div>
        </div>
        <div id="output"></div>
      </div>
    </div>
  </div>
  <script>
    var editor = ace.edit("editor");
    editor.setValue(localStorage.getItem('saved-code') || '', -1);
    editor.setTheme("ace/theme/iplastic");
    editor.getSession().setMode("ace/mode/html");
    editor.getSession().setUseWrapMode(true);
    editor.getSession().setTabSize(4);

    var save = function () {
      localStorage.setItem('saved-code', editor.getValue());
      window.setTimeout(save, 5000);
    };

    var reload = function () {
      var output = document.getElementById('output');
      while(output.hasChildNodes()) {
         output.removeChild(output.lastChild);
      }

      var iframe = document.createElement('iframe');
      iframe.style.border = 'none';
      iframe.style.height = '100%';
      output.appendChild(iframe);

      iframe.contentWindow.document.open();
      iframe.contentWindow.document.write(editor.getValue());
      iframe.contentWindow.document.close();
    };

    var leftSize = 8;
    var resize = function () {
      document.querySelector('.editor-col').className = 'editor-col col-xs-' + leftSize;
      document.querySelector('.output-col').className = 'output-col col-xs-' + (12 - leftSize);
    };

    var expandLeft = function () {
      if (leftSize > 1) {
        leftSize--;
        resize();
      }
    };

    var expandRight = function () {
      if (leftSize < 11) {
        leftSize++;
        resize();
      }
    };

    document.getElementById('save').onclick = save;
    document.getElementById('reload').onclick = reload;
    document.getElementById('expand-left').onclick = expandLeft;
    document.getElementById('expand-right').onclick = expandRight;

    window.setTimeout(save, 5000);
    window.setTimeout(reload);
  </script>
</body>
</html>