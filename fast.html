<html>
<head>
</head>
<body>
<div>
<style>
     #native_ad_id {
        /*display: none;*/
        font-size: 14px;
        height: 450px;
        line-height: 16px;
        position: relative;
        width: 600px;
      }
      .thirdPartyMediaClass {
        height: 300px;
        width: 400px;
      }
      .thirdPartyTitleClass {
        font-weight: 600;
        font-size: 16px;
        margin: 8px 0 4px 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .thirdPartyBodyClass {
        display: -webkit-box;
        height: 32px;
        -webkit-line-clamp: 2;
        overflow: hidden;
      }
      .thirdPartyCallToActionClass {
        color: #326891;
        font-family: sans-serif;
        font-weight: 600;
        margin-top: 8px;
      }
    </style>

    <script>
      function getTime() {
        return Date.now();
      }

      var now = getTime();

      var data = {
        placementid: '97972641212_10153177743496213',
        format: 'native',
        testmode: false,
        nativeadid: 'native_ad_id',
      }
      var onAdLoaded = function(placementId) {
        document.getElementById('native_ad_id').parentNode.style.display = 'block';
        console.log('Audience Network Ad Loaded');
      };
      var onAdError = function(errorCode, errorMessage, placementId) {
        console.log('Audience Network Ad Error: ' + errorCode);
      };
      ///////////////////////////////////////////////////////
      var rootElement = document.currentScript.parentElement;
      window.ADNW = window.ADNW || {};
      rootElement.dataset.placementid = data.placementid;
      // create iframe
      var getReferrer = function(w) {
        try {
          return w.document.referrer;
        } catch (e) {}
        return '';
      }
      var extractDomain = function(url) {
        var index = url.indexOf('/', url.indexOf('://') + 3);
        if (index === -1) {
          return url;
        }
        return url.substring(0, index);
      };
      var urls = [window.location.href];
      if (window !== window.parent) {
        this._ancestorUrls = [];
        var prevWindow;
        var currentWindow = window;
        while (currentWindow !== prevWindow) {
          var url;
          try {
            url = currentWindow.location.href;
          } catch (e) {}
          urls.push(url || getReferrer(prevWindow));
          prevWindow = currentWindow;
          currentWindow = currentWindow.parent;
        }
      }
      var origins = window.location.ancestorOrigins;
      if (origins) {
        if  (origins.length > 0) {
          data.topdomain = origins[origins.length - 1];
        } else {
          data.topdomain = extractDomain(urls[urls.length - 1]);
        }
      }
      data.topurl = urls[urls.length - 1];
      data.channel = extractDomain(urls[0]);
      data.screenwidth = screen.width;
      data.screenheight = screen.height;
      data.pixelratio = window.devicePixelRatio;
      var obj = window.ADNW[data.placementid] = {};
      obj.iframe = document.createElement('iframe');
      var iframeSrc = 'https://www.tonypan.sb.facebook.com/audiencenetwork/fast/?sdk=5.1.web';
      for (var key in data) {
        iframeSrc += '&' + key + '=' + encodeURIComponent(data[key]);
      }
      obj.iframe.src = iframeSrc;
      obj.placementId = data.placementid;
      obj.displayFormat = data.format;
      obj.onAdLoaded = onAdLoaded;
      obj.onAdError = onAdError;
      obj.tagJsInitTime = now;

      // listen for events
      obj.events = [];
      window.addEventListener('message', function(event) {
        console.log('TAG - received message: ' + event.data.name);
        event.data.receivedTimestamp = getTime();
        if (obj.sdkEventHandler) {
          obj.sdkEventHandler(event.data);
        } else {
          obj.events.push(event.data);
        }
      }, false);
      rootElement.appendChild(obj.iframe);
      obj.tagJsIframeAppendedTime = getTime();
    </script>
<!--    <script id='sdkjs' async type="text/javascript" src="https://www.tonypan.sb.facebook.com/assets.php/en_US/fbadnw.js"></script>-->
    <script id='sdkjs' async type="text/javascript" src="https://connect.facebook.net/en_US/fbadnw.js"></script>
    <script>
      chrome.devtools.network.onRequestFinished.addListener(
        function(request) {
          debugger;
        }
      );
    </script>

    <div id="native_ad_id">
      <a class="fbAdLink">
        <div class="fbAdMedia thirdPartyMediaClass"></div>
        <div class="fbAdTitle thirdPartyTitleClass"></div>
        <div class="fbAdBody thirdPartyBodyClass"></div>
        <div class="fbAdCallToAction thirdPartyCallToActionClass"></div>
      </a>
    </div>

</div>

  </body>
</html>